<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Emotion and empathy measures</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">Emotion and empathy measures</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#emotion-matching-task">Emotion matching task</a></li>
        <li><a href="#emotion--and-empathy-related-measures-and-erp">Emotion- and empathy related measures and ERP</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Del. matched-to-sample task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load and prepare data sets -->
<div id="emotion-matching-task" class="section level1">
<h1>Emotion matching task</h1>
<p>We employed an emotion matching task (EMT; adapted from Watling &amp; Damaskinou, 2018) to assess childrenâ€™s emotion knowledge. Children saw two faces with the same identity but different facial expression. Both faces were presented at the same time. While the faces were on screen, the children heard an audio lay-over of one of the emotion words (happy, angry or neutral). The children had to indicate with a button press which face matched the audio lay-over. We measured reaction times and accuracy.</p>
<p>We excluded:</p>
<ul>
<li>Reaction times &lt; 250 ms or &gt; 7s</li>
<li>Values &lt;/&gt; 2.5 of the median absolute deviation (MAD) based on the individual participant</li>
<li>Incorrect answers</li>
</ul>
<p>We calculated general linear mixed models (GLMM) for accuracy rates and linear mixed models (LMM) for reaction times. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all (general) linear mixed model analyses to control for cognitive abilities of the children as well as potential differences in age.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
<p>We expected the highest accuracy rates for happy faces (tested with <code>GLMM</code>) and fastest reaction times for pairings where happy faces were involved (tested with <code>LMM</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p><br></p>
<div id="descriptives" class="section level4">
<h4><strong>Descriptives</strong></h4>
<p><br></p>
<!-- Plot EMT accuracy & reaction time -->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># Select RT inspected criteria</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>EMT_Acc_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a><span class="co"># Select correct trials</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a>EMT_Acc_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT_Acc_Plot, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="co"># Create factor, define neutral as baseline</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>EMT_Acc_Plot<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_Acc_Plot<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co"># Get accuracy for novel and repeated condition</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>acc_all =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID <span class="op">+</span><span class="st"> </span>emotion, EMT_Acc_Plot))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="co"># Recode to accuracy in percent</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a>acc_all<span class="op">$</span>Freq =<span class="st"> </span>(acc_all<span class="op">$</span>Freq<span class="op">/</span><span class="dv">24</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="co"># Set ID as factor</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>acc_all<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(acc_all<span class="op">$</span>ID)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="co"># Calculate descriptives on accuracy</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a>stats_acc_all =<span class="st"> </span><span class="kw">summarySEwithin</span>(acc_all, <span class="dt">measurevar =</span> <span class="st">&quot;Freq&quot;</span>, <span class="dt">withinvars =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>    <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a><span class="co"># Plot accuracy</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a>EMT_Acc_bar =<span class="st"> </span><span class="kw">ggplot</span>(stats_acc_all, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> emotion)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>, </span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>        <span class="dt">width =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Freq <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> Freq <span class="op">+</span><span class="st"> </span>se), <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>    <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>theme_SN</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a><span class="co"># Only examine clean data</span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a>EMT_RT_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a><span class="co"># Select correct responses</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a>EMT_RT_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT_RT_Plot, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a><span class="co"># Create factor, define neutral as baseline</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>EMT_RT_Plot<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_RT_Plot<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, </span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a>    <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="co"># Get accuracy for novel and repeated condition</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a>RT_all =<span class="st"> </span><span class="kw">aggregate</span>(EMT_RT_Plot<span class="op">$</span>RT_in_ms, <span class="kw">list</span>(<span class="dt">ID =</span> EMT_RT_Plot<span class="op">$</span>ID, <span class="dt">emotion =</span> EMT_RT_Plot<span class="op">$</span>emotion), </span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a>    mean)</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a><span class="co"># Set ID as factor</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a>RT_all<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(RT_all<span class="op">$</span>ID)</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a><span class="co"># Calculate descriptives on RT</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a>stats_RT_all =<span class="st"> </span><span class="kw">summarySEwithin</span>(RT_all, <span class="dt">measurevar =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">withinvars =</span> <span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>), </span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a>    <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a><span class="co"># Plot RTs</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a>EMT_RT_bar =<span class="st"> </span><span class="kw">ggplot</span>(stats_RT_all, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> x, <span class="dt">fill =</span> emotion)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), </span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a>    <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>, <span class="dt">width =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> x <span class="op">-</span><span class="st"> </span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a><span class="st">    </span>se, <span class="dt">ymax =</span> x <span class="op">+</span><span class="st"> </span>se), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;RT [ms]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">3500</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, </span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a>    <span class="dv">4000</span>, <span class="dv">1000</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>theme_SN</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a><span class="co"># Raincloud plot EMT RT</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a><span class="co"># # Only examine clean data EMT_RT_Plot = subset(EMT,Exclude_smaller_250ms ==</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a><span class="co"># FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE) # Select correct</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a><span class="co"># responses EMT_RT_Plot = subset(EMT_RT_Plot, Answer == 1) # Create factor,</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a><span class="co"># define neutral as baseline EMT_RT_Plot$emotion = factor(EMT_RT_Plot$emotion,</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a><span class="co"># levels=c(&#39;neutral&#39;,&#39;happy&#39;,&#39;angry&#39;)) # Calculate summary lb = function(x)</span></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a><span class="co"># mean(x) - sd(x) ub = function(x) mean(x) + sd(x) sumld = ddply(EMT_RT_Plot , ~</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a><span class="co"># emotion, summarise, mean = mean(RT_in_ms), median = median(RT_in_ms), lower =</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a><span class="co"># lb(RT_in_ms), upper = ub(RT_in_ms)) # Plot rainclouds EMT_RT_rain = ggplot(data</span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a><span class="co"># = EMT_RT_Plot, aes(y = RT_in_ms, x = emotion, fill = emotion)) +</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a><span class="co"># geom_flat_violin(position = position_nudge(x = .12, y = 0), alpha = 1,</span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a><span class="co"># color=&#39;black&#39;) + geom_point(aes(y = RT_in_ms, color = emotion), shape = 19,</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a><span class="co"># position = position_jitter(width = .1), size = .7, alpha = 1) + geom_point(data</span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a><span class="co"># = sumld, aes(x = emotion, y = mean), position = position_nudge(x = .2), size =</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a><span class="co"># 2.5) + geom_errorbar(data = sumld, aes(ymin = lower, ymax = upper, y = mean),</span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a><span class="co"># position = position_nudge(x = .2, y = 0), width = 0)+</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a><span class="co"># scale_y_continuous(name=&#39;Reaction time [ms]&#39;, breaks=seq(0,6500,2000),</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a><span class="co"># limits=c(0,6500))+ xlab(&#39;&#39;)+ expand_limits(x = 2.00) + guides(fill = FALSE) +</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a><span class="co"># guides(color = FALSE) + coord_flip() + # flip or not?</span></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a><span class="co"># scale_fill_manual(values=emotion_col) + scale_color_manual(values=emotion_col)+</span></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true"></a><span class="co"># theme_bw() + theme_SN+ theme(panel.grid.major.y = element_blank())</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true"></a><span class="co"># Combine plots</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true"></a><span class="kw">combine_plots</span>(EMT_Acc_bar, EMT_RT_bar, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_acc_RT_plot-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><br></p>
<hr />
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills"><strong>Model specification</strong></h4>
<!-- GLMM / LMM assumption checks -->
<div id="glmm-random-effect-structure" class="section level5">
<h5>GLMM: Random effect structure</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># RT cleaning criteria</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>EMT_Acc =<span class="st"> </span><span class="kw">subset</span>(EMT, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co"># Factor random effects</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>EMT_Acc<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EMT_Acc<span class="op">$</span>ID)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>EMT_Acc<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EMT_Acc<span class="op">$</span>Stim_Type)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="co"># Create factor, define neutral as baseline</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>EMT_Acc<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_Acc<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="kw">contrasts</span>(EMT_Acc<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a>mm_mod_EMT_Acc =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion, EMT_Acc)</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a>EMT_Acc[, (<span class="kw">ncol</span>(EMT_Acc) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EMT_Acc) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_mod_EMT_Acc</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a><span class="kw">names</span>(EMT_Acc)[(<span class="kw">ncol</span>(EMT_Acc) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EMT_Acc)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a><span class="co"># Construct model</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>mod_EMT_Acc.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Answer <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a><span class="st">    </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_Acc, </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_Acc.glmm1))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_Acc.glmm1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a><span class="co"># Likelihood ratio testing</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a>mod_EMT_Acc.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Answer <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_Acc, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a><span class="kw">anova</span>(mod_EMT_Acc.glmm1, mod_EMT_Acc.glmm2)</span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a>mod_EMT_Acc.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Answer <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a><span class="st">    </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_Acc, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a><span class="co"># Calculate ANOVAs</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a><span class="kw">anova</span>(mod_EMT_Acc.glmm1, mod_EMT_Acc.glmm3)</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a>mod_EMT_Acc.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Answer <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_Acc, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span></code></pre></div>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Hap_Neu</code>, <code>Ang_Neu</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ID) + ,     (1 + Hap_Neu + Ang_Neu || Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-overdispersion" class="section level5">
<h5>GLMM: Overdispersion</h5>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Assumption check: Appropriate estimation of variance</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">overdisp_fun</span>(mod_EMT_Acc.glmm4)</span></code></pre></div>
<pre><code>  chisq   ratio     rdf       p 
1036.50    0.72 1448.00    1.00 </code></pre>
<hr />
</div>
<div id="lmm-random-effect-structure" class="section level5">
<h5>LMM: Random effect structure</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Correct responses</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>EMT_RT =<span class="st"> </span><span class="kw">subset</span>(EMT, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a><span class="co"># RT cleaning criteria</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a>EMT_RT =<span class="st"> </span><span class="kw">subset</span>(EMT_RT, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a><span class="co"># Factor random effects</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a>EMT_RT<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EMT_RT<span class="op">$</span>ID)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>EMT_RT<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EMT_RT<span class="op">$</span>Stim_Type)</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a><span class="co"># Create factor, define neutral as baseline</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a>EMT_RT<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_RT<span class="op">$</span>emotion, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a><span class="kw">contrasts</span>(EMT_RT<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a>mm_c =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>emotion, EMT_RT)</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a>EMT_RT[, (<span class="kw">ncol</span>(EMT_RT) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EMT_RT) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_c</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a><span class="kw">names</span>(EMT_RT)[(<span class="kw">ncol</span>(EMT_RT) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EMT_RT)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>mod_EMT_RT.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_RT, </span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_RT.lmer1))</span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true"></a></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_RT.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true"></a></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true"></a></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true"></a><span class="co"># Improved model</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true"></a>mod_EMT_RT.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_RT, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true"></a></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_RT.lmer2))</span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_RT.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true"></a></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true"></a><span class="co">## Likelihood ratio testing</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true"></a>mod_EMT_RT.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_RT, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true"></a></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true"></a><span class="kw">anova</span>(mod_EMT_RT.lmer2, mod_EMT_RT.lmer3)</span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true"></a></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true"></a><span class="co"># Stim_Type</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true"></a>mod_EMT_RT.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_RT, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true"></a><span class="kw">anova</span>(mod_EMT_RT.lmer2, mod_EMT_RT.lmer4)</span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true"></a></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true"></a></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true"></a>mod_EMT_RT.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EMT_RT, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + ,     (1 | ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm-normality-of-residuals" class="section level5">
<h5>LMM: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a>mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RT_in_ms <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data =</span> EMT_RT)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a>res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true"></a>qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true"></a>norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a><span class="co"># Check which transformation of DV is suitable</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="co"># Calculate box-cox plot</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>mod_RT_targ =<span class="st"> </span><span class="kw">lm</span>(RT_in_ms <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data =</span> EMT_RT)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a><span class="kw">boxcox</span>(mod_RT_targ)</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (with log transform)</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data =</span> EMT_RT)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a>res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log, <span class="dt">main =</span> <span class="st">&quot;QQplot after transformation&quot;</span>)</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main =</span> <span class="st">&quot;Density plot after transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm-homoscedasticity" class="section level5">
<h5>LMM: Homoscedasticity</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_EMT_RT.lmer5), <span class="kw">residuals</span>(mod_EMT_RT.lmer5))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print GLMM / LMM results -->
<p>With regard to accuracy, we did not find a significant effect for happy vs.Â neutral faces or angry vs.Â neutral faces. Children were significantly faster for happy compared to neutral faces, but not for angry compared to neutral faces. None of the covariates reached significance.</p>
<div align="center">


<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>, <span class="st">&quot;Happy vs Neutral&quot;</span>, <span class="st">&quot;Angry vs Neutral&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working memory&quot;</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a><span class="co"># Show results</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_EMT_Acc.glmm4, mod_EMT_RT.lmer5, <span class="dt">pred.labels =</span> labels, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a>    <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a>    <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Accuracy&quot;</span>, <span class="st">&quot;Reaction time&quot;</span>), </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>    <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Accuracy
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Reaction time
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
7.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
125.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.421
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.039</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.151
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.061
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.155
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.130
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.636
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.171
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.12
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.02 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7.06 <sub>Stim_Type.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.89 <sub>Stim_Type.2</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.71 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.45
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.027 / 0.428
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.054 / 0.483
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="emotion--and-empathy-related-measures-and-erp" class="section level1">
<h1>Emotion- and empathy related measures and ERP</h1>
<p>We performed correlational analyses using Pearson's correlations (corrected for multiple comparisons using the false discovery rate) to associate behavior and brain variables. We calculated difference scores between P1/P3 amplitudes to angry vs.Â neutral facial expressions. Subsequently, we performed correlational analysis with the empathy (EM) and emotion knowledge (EK) composite scores of the EMK 3-6.</p>
<!-- Display correlation plots -->
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co">## Separate data set for neutral and angry and calculate participant&#39;s P1/P3 mean</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="co"># angry</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a>ERPs_ang =<span class="st"> </span><span class="kw">subset</span>(ERPs, Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>ERPs_mean =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">tapply</span>(ERPs_ang<span class="op">$</span>mean_ROI_P1, ERPs_ang<span class="op">$</span>ID, mean))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a><span class="kw">names</span>(ERPs_mean)[<span class="dv">1</span>] =<span class="st"> &quot;P1_ang&quot;</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P3_ang =<span class="st"> </span><span class="kw">tapply</span>(ERPs_ang<span class="op">$</span>mean_ROI_P3, ERPs_ang<span class="op">$</span>ID, mean)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a><span class="co"># neutral</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>ERPs_neu =<span class="st"> </span><span class="kw">subset</span>(ERPs, Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P1_neu =<span class="st"> </span><span class="kw">tapply</span>(ERPs_neu<span class="op">$</span>mean_ROI_P1, ERPs_neu<span class="op">$</span>ID, mean)</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P3_neu =<span class="st"> </span><span class="kw">tapply</span>(ERPs_neu<span class="op">$</span>mean_ROI_P3, ERPs_neu<span class="op">$</span>ID, mean)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a><span class="co"># happy</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a>ERPs_hap =<span class="st"> </span><span class="kw">subset</span>(ERPs, Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P1_hap =<span class="st"> </span><span class="kw">tapply</span>(ERPs_hap<span class="op">$</span>mean_ROI_P1, ERPs_hap<span class="op">$</span>ID, mean)</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P3_hap =<span class="st"> </span><span class="kw">tapply</span>(ERPs_hap<span class="op">$</span>mean_ROI_P3, ERPs_hap<span class="op">$</span>ID, mean)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a><span class="co"># Calculate difference score for angry-neutral</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P1_Diff_Ang_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P1_ang <span class="op">-</span><span class="st"> </span>ERPs_mean<span class="op">$</span>P1_neu</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P3_Diff_Ang_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P3_ang <span class="op">-</span><span class="st"> </span>ERPs_mean<span class="op">$</span>P3_neu</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P1_Diff_Hap_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P1_hap <span class="op">-</span><span class="st"> </span>ERPs_mean<span class="op">$</span>P1_neu</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>P3_Diff_Hap_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P3_hap <span class="op">-</span><span class="st"> </span>ERPs_mean<span class="op">$</span>P3_neu</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a><span class="co"># Remove rows of de-selected participants</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a>ERPs_mean =<span class="st"> </span>ERPs_mean[<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>), ]</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a><span class="co"># Order questionnaire data by ID</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a>qn_data =<span class="st"> </span>qn_data[<span class="kw">order</span>(qn_data<span class="op">$</span>ID), ]</span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a></span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a><span class="co"># Integrate questionnare data</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EK_P =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EK_P</span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EM_P =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EM_P</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EK_Ch =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EK_Ch</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EM_Ch =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EM_Ch</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a><span class="co"># Compute composite scores for parental/children measures of EMK</span></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EK =<span class="st"> </span><span class="kw">scale</span>(ERPs_mean<span class="op">$</span>EMK_EK_P) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(ERPs_mean<span class="op">$</span>EMK_EK_Ch)</span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>ERPs_mean<span class="op">$</span>EMK_EM =<span class="st"> </span><span class="kw">scale</span>(ERPs_mean<span class="op">$</span>EMK_EM_P) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(ERPs_mean<span class="op">$</span>EMK_EM_Ch)</span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a><span class="co"># Select variables</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a>ERPs_corr =<span class="st"> </span><span class="kw">subset</span>(ERPs_mean, <span class="dt">select =</span> <span class="kw">c</span>(P1_Diff_Ang_Neu, P3_Diff_Ang_Neu, EMK_EM, </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a>    EMK_EK))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a><span class="co">## Plot correlations</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a><span class="co"># Empathy and P1 difference</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true"></a>EMK_ERP_scat1 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean, <span class="kw">aes</span>(<span class="dt">x =</span> EMK_EM, <span class="dt">y =</span> P1_Diff_Ang_Neu)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;gray0&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray0&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;EMK 3-6 (EM)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P1 angry vs. neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true"></a></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true"></a><span class="co"># Empathy and P3 difference</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true"></a>EMK_ERP_scat2 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean, <span class="kw">aes</span>(<span class="dt">x =</span> EMK_EM, <span class="dt">y =</span> P3_Diff_Ang_Neu)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;gray27&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray27&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;EMK 3-6 (EM)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P3 angry vs. neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true"></a><span class="co"># EK and P1 difference</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true"></a>EMK_ERP_scat3 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean, <span class="kw">aes</span>(<span class="dt">x =</span> EMK_EK, <span class="dt">y =</span> P1_Diff_Ang_Neu)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;gray35&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray35&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;EMK 3-6 (EK)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P1 angry vs. neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true"></a></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true"></a><span class="co"># EK and P3 difference</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true"></a>EMK_ERP_scat4 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean, <span class="kw">aes</span>(<span class="dt">x =</span> EMK_EK, <span class="dt">y =</span> P3_Diff_Ang_Neu)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, </span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;gray52&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray52&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true"></a>    <span class="dt">size =</span> <span class="dv">1</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;EMK 3-6 (EK)&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P3 angry vs. neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true"></a></span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true"></a><span class="co"># Combine plots (Explanation: draw_plot(plot, for position: x = 0, y = 0, width =</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true"></a><span class="co"># 1, height = 1))</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true"></a><span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(EMK_ERP_scat1, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(EMK_ERP_scat2, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(EMK_ERP_scat3, <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true"></a>    <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(EMK_ERP_scat4, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMK_ERP_scat_plots-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>We found a significant correlation between the empathy score and the difference between P1 amplitudes to angry vs.Â neutral facial expressions, but not for the P3 difference score. None of the correlations between emotion knowledge with P1 or P3 difference scores yielded significant results.</p>
<p><br></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Print table</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>ERP_corr_table_EM<span class="op">$</span>ci <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlations between composite EMK 3-6 empathy score with P1 and P3 difference scores to angry vs. neutral faces.&quot;</span>)</span></code></pre></div>
<table>
<caption>Correlations between composite EMK 3-6 empathy score with P1 and P3 difference scores to angry vs.Â neutral faces.</caption>
<colgroup>
<col width="41%" />
<col width="15%" />
<col width="12%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Â </th>
<th align="center">lower CI</th>
<th align="center">r</th>
<th align="center">upper CI</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>EMK 3-6 EM x P1 angry vs. neutral</strong></td>
<td align="center">0.0291</td>
<td align="center">0.3795</td>
<td align="center">0.6469</td>
<td align="center">0.03522</td>
</tr>
<tr class="even">
<td align="center"><strong>EMK 3-6 EM x P3 angry vs. neutral</strong></td>
<td align="center">-0.1965</td>
<td align="center">0.1697</td>
<td align="center">0.4943</td>
<td align="center">0.3615</td>
</tr>
<tr class="odd">
<td align="center"><strong>P1 angry vs.Â neutral x P3 angry vs.Â neutral</strong></td>
<td align="center">0.2174</td>
<td align="center">0.5308</td>
<td align="center">0.745</td>
<td align="center">0.002124</td>
</tr>
</tbody>
</table>
<p><em>Note:</em> Correlation coefficients were computed with Pearsonâ€™s correlation. EM: Composite score for empathy of the Inventory to survey of emotional competences for three to six-year-olds; CI = confidence interval; * p &lt; .05; ** p &lt; .01; *** p &lt; .001.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co"># Print table</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>ERP_corr_table_EK<span class="op">$</span>ci <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pander</span>(<span class="dt">caption =</span> <span class="st">&quot;Correlations between composite EMK 3-6 emotion knowledge score with P1 and P3 difference scores to angry vs. neutral faces.&quot;</span>)</span></code></pre></div>
<table>
<caption>Correlations between composite EMK 3-6 emotion knowledge score with P1 and P3 difference scores to angry vs.Â neutral faces.</caption>
<colgroup>
<col width="41%" />
<col width="15%" />
<col width="13%" />
<col width="15%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Â </th>
<th align="center">lower CI</th>
<th align="center">r</th>
<th align="center">upper CI</th>
<th align="center">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><strong>EMK 3-6 EK x P1 angry vs. neutral</strong></td>
<td align="center">-0.1327</td>
<td align="center">0.2326</td>
<td align="center">0.5423</td>
<td align="center">0.208</td>
</tr>
<tr class="even">
<td align="center"><strong>EMK 3-6 EK x P3 angry vs. neutral</strong></td>
<td align="center">-0.4889</td>
<td align="center">-0.1628</td>
<td align="center">0.2033</td>
<td align="center">0.3816</td>
</tr>
<tr class="odd">
<td align="center"><strong>P1 angry vs.Â neutral x P3 angry vs.Â neutral</strong></td>
<td align="center">0.2174</td>
<td align="center">0.5308</td>
<td align="center">0.745</td>
<td align="center">0.002124</td>
</tr>
</tbody>
</table>
<p><em>Note:</em> Correlation coefficients were computed with Pearsonâ€™s correlation. EK: Composite score for emotion knowledge of the Inventory to survey of emotional competences for three to six-year-olds; CI = confidence interval; * p &lt; .05; ** p &lt; .01; *** p &lt; .001.</p>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] table1_1.2         pander_0.6.3       knitr_1.29         gridGraphics_0.5-0
 [5] corrplot_0.84      apaTables_2.0.5    gvlma_1.0.0.3      eegUtils_0.5.0    
 [9] akima_0.6-2.1      forcats_0.5.0      stringr_1.4.0      purrr_0.3.4       
[13] readr_1.3.1        tidyr_1.1.1        tibble_3.0.3       tidyverse_1.3.0   
[17] sjlabelled_1.1.6   sjmisc_2.8.5       sjPlot_2.8.4       Rmisc_1.5         
[21] plyr_1.8.6         reshape2_1.4.4     psych_2.0.7        MASS_7.3-51.6     
[25] lmerTest_3.1-2     lme4_1.1-23        Matrix_1.2-18      Hmisc_4.4-1       
[29] Formula_1.2-3      survival_3.1-12    lattice_0.20-41    ggstatsplot_0.5.0 
[33] ez_4.4-0           EnvStats_2.3.1     eeptools_1.2.4     ggplot2_3.3.2     
[37] dplyr_1.0.1        cowplot_1.0.0      summarytools_0.9.6 miceadds_3.10-28  
[41] mice_3.11.0        rmdformats_0.3.7   XLConnect_1.0.1    kableExtra_1.1.0  

loaded via a namespace (and not attached):
 [1] vcd_1.4-7            ps_1.3.4             lmtest_0.9-37       
 [4] crayon_1.3.4         V8_3.2.0             PMCMRplus_1.4.4     
 [7] nlme_3.1-148         backports_1.1.8      metafor_2.4-0       
[10] reprex_0.3.0         ggcorrplot_0.1.3     rlang_0.4.7         
[13] readxl_1.3.1         performance_0.4.8    nloptr_1.2.2.2      
[16] callr_3.4.3          glue_1.4.1           loo_2.3.1           
[19] rstan_2.21.2         parallel_4.0.2       processx_3.4.3      
[22] shinydashboard_0.7.1 tcltk_4.0.2          haven_2.3.1         
[25] tidyselect_1.1.0     rio_0.5.16           zoo_1.8-8           
[28] SuppDists_1.1-9.5    mc2d_0.1-18          xtable_1.8-4        
[31] MatrixModels_0.4-1   magrittr_1.5         evaluate_0.14       
[34] cli_2.0.2            rstudioapi_0.11      miniUI_0.1.1.1      
[37] sp_1.4-2             rpart_4.1-15         shiny_1.5.0         
[40] xfun_0.16            parameters_0.8.2     groupedstats_1.0.1  
[43] inline_0.3.15        pkgbuild_1.1.0       cluster_2.1.0       
[46] bridgesampling_1.0-0 WRS2_1.1-0           expm_0.999-5        
[49] Brobdingnag_1.2-6    ggrepel_0.8.2        listenv_0.8.0       
[52] png_0.1-7            reshape_0.8.8        future_1.18.0       
[55] zeallot_0.1.0        withr_2.2.0          rcompanion_2.3.25   
[58] cellranger_1.1.0     pracma_2.2.9         coda_0.19-3         
[61] pillar_1.4.6         RcppParallel_5.0.2   Rmpfr_0.8-1         
[64] multcomp_1.4-13      fs_1.5.0             paletteer_1.2.0     
[67] vctrs_0.3.2          ellipsis_0.3.1       generics_0.0.2      
[70] nortest_1.0-4        tools_4.0.2          foreign_0.8-80      
[73] munsell_0.5.0        emmeans_1.5.0        fastmap_1.0.1       
 [ reached getOption(&quot;max.print&quot;) -- omitted 130 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
