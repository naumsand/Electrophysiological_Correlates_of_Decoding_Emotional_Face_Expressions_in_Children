<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Emotion and empathy measures</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #ffffff; color: #1f1c1b; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #ffffff; color: #a0a0a0; border-right: 1px solid #a0a0a0; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #1f1c1b; background-color: #ffffff; }
code > span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code > span.dt { color: #0057ae; } /* DataType */
code > span.dv { color: #b08000; } /* DecVal */
code > span.bn { color: #b08000; } /* BaseN */
code > span.fl { color: #b08000; } /* Float */
code > span.cn { color: #aa5500; } /* Constant */
code > span.ch { color: #924c9d; } /* Char */
code > span.sc { color: #3daee9; } /* SpecialChar */
code > span.st { color: #bf0303; } /* String */
code > span.vs { color: #bf0303; } /* VerbatimString */
code > span.ss { color: #ff5500; } /* SpecialString */
code > span.im { color: #ff5500; } /* Import */
code > span.co { color: #898887; } /* Comment */
code > span.do { color: #607880; } /* Documentation */
code > span.an { color: #ca60ca; } /* Annotation */
code > span.cv { color: #0095ff; } /* CommentVar */
code > span.ot { color: #006e28; } /* Other */
code > span.fu { color: #644a9b; } /* Function */
code > span.va { color: #0057ae; } /* Variable */
code > span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code > span.op { color: #1f1c1b; } /* Operator */
code > span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code > span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code > span.pp { color: #006e28; } /* Preprocessor */
code > span.at { color: #0057ae; } /* Attribute */
code > span.re { color: #0057ae; } /* RegionMarker */
code > span.in { color: #b08000; } /* Information */
code > span.wa { color: #bf0303; } /* Warning */
code > span.al { color: #bf0303; font-weight: bold; } /* Alert */
code > span.er { color: #bf0303; text-decoration: underline; } /* Error */
code > span. { color: #1f1c1b; } /* Normal */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">Emotion and empathy measures</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#emotion-matching-task">Emotion matching task</a></li>
        <li><a href="#emotion--and-empathy-related-measures-and-erp">Emotion- and empathy related measures and ERP</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Same-different matching task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load and prepare data sets -->
<div id="emotion-matching-task" class="section level1">
<h1>Emotion matching task</h1>
<p>We employed an emotion matching task (EMT; adapted from Watling &amp; Damaskinou, 2018) to assess childrenâ€™s emotion knowledge. Children saw two faces with the same identity but different facial expression. Both faces were presented at the same time. While the faces were on screen, the children heard an audio lay-over of one of the emotion words (happy, angry or neutral). The children had to indicate with a button press which face matched the audio lay-over. We measured reaction times and accuracy.</p>
<p>We excluded:</p>
<ul>
<li>Reaction times &lt; 250 ms or &gt; 7s</li>
<li>Values &lt;/&gt; 2.5 of the median absolute deviation (MAD) based on the individual participant</li>
<li>Incorrect answers</li>
</ul>
<p>We calculated general linear mixed models (GLMM) for accuracy rates and linear mixed models (LMM) for reaction times. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all (general) linear mixed model analyses to control for cognitive abilities of the children as well as potential differences in age.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
<p>We expected the highest accuracy rates for happy faces (tested with <code>GLMM</code>) and fastest reaction times for pairings where happy faces were involved (tested with <code>LMM</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p><br></p>
<div id="descriptives" class="section level4">
<h4><strong>Descriptives</strong></h4>
<p><br></p>
<!-- Plot EMT accuracy & reaction time -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select RT inspected criteria</span>
  EMT_Acc_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>) 

<span class="co"># Select correct trials</span>
  EMT_Acc_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT_Acc_Plot, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Create factor, define neutral as baseline</span>
  EMT_Acc_Plot<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_Acc_Plot<span class="op">$</span>emotion, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Get accuracy for novel and repeated condition </span>
  acc_all =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID<span class="op">+</span>emotion, EMT_Acc_Plot)) 

<span class="co"># Recode to accuracy in percent</span>
  acc_all<span class="op">$</span>Freq =<span class="st"> </span>(acc_all<span class="op">$</span>Freq<span class="op">/</span><span class="dv">24</span>)<span class="op">*</span><span class="dv">100</span>

<span class="co"># Calculate descriptives on accuracy</span>
  stats_acc_all =<span class="st"> </span><span class="kw">summarySE</span>(acc_all, <span class="dt">measurevar=</span><span class="st">&quot;Freq&quot;</span>, <span class="dt">groupvars=</span><span class="kw">c</span>(<span class="st">&quot;emotion&quot;</span>))

<span class="co"># Plot accuracy</span>
  EMT_Acc_bar =<span class="st"> </span><span class="kw">ggplot</span>(stats_acc_all, <span class="kw">aes</span>(<span class="dt">x=</span>emotion, <span class="dt">y=</span>Freq, <span class="dt">fill =</span> emotion)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.7</span>,<span class="dt">width=</span><span class="fl">0.9</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>Freq<span class="op">-</span>se, <span class="dt">ymax=</span>Freq<span class="op">+</span>se), <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">width=</span><span class="fl">0.2</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span> (<span class="dt">x=</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">60</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">60</span>,<span class="dv">20</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>emotion_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span>theme_SN

<span class="co"># Raincloud plot EMT RT</span>

<span class="co"># Only examine clean data</span>
  EMT_RT_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)

<span class="co"># Select correct responses</span>
  EMT_RT_Plot =<span class="st"> </span><span class="kw">subset</span>(EMT_RT_Plot, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Create factor, define neutral as baseline</span>
  EMT_RT_Plot<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_RT_Plot<span class="op">$</span>emotion, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Calculate summary</span>
  lb =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(x)
  ub =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x)
  
  sumld =<span class="st"> </span><span class="kw">ddply</span>(EMT_RT_Plot , <span class="op">~</span><span class="st"> </span>emotion, summarise,
                <span class="dt">mean =</span> <span class="kw">mean</span>(RT_in_ms), <span class="dt">median =</span> <span class="kw">median</span>(RT_in_ms), <span class="dt">lower =</span> <span class="kw">lb</span>(RT_in_ms), <span class="dt">upper =</span> <span class="kw">ub</span>(RT_in_ms))
  
<span class="co"># Plot rainclouds</span>
  EMT_RT_rain =<span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">data =</span> EMT_RT_Plot, <span class="kw">aes</span>(<span class="dt">y =</span> RT_in_ms, <span class="dt">x =</span> emotion, <span class="dt">fill =</span> emotion))  <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">12</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> RT_in_ms, <span class="dt">color =</span> emotion), <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">1</span>), <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)  <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">x =</span> emotion, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">2</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">2</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">width =</span> <span class="dv">0</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Reaction time [ms]&quot;</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">6500</span>,<span class="dv">2000</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">6500</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="fl">2.00</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co"># flip or not?</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>emotion_col) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>emotion_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>() <span class="op">+</span>
<span class="st">    </span>theme_SN<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>())
  
<span class="co"># Combine plots</span>
  <span class="kw">combine_plots</span>(EMT_Acc_bar, EMT_RT_rain,
                <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> <span class="dv">1</span>,
                <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>))</code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_acc_RT_plot-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><br></p>
<hr />
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<!-- GLMM / LMM assumption checks -->
<div id="glmm-random-effect-structure" class="section level5">
<h5>GLMM: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># RT cleaning criteria</span>
  EMT_Acc =<span class="st"> </span><span class="kw">subset</span>(EMT,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  

<span class="co"># Factor random effects </span>
  EMT_Acc<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EMT_Acc<span class="op">$</span>ID)
  EMT_Acc<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EMT_Acc<span class="op">$</span>Stim_Type)

<span class="co"># Create factor, define neutral as baseline</span>
  EMT_Acc<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_Acc<span class="op">$</span>emotion, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(EMT_Acc<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)

<span class="co"># Add contrast columns</span>
  mm_mod_EMT_Acc =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>emotion, EMT_Acc) 

<span class="co"># Attach to dataframe</span>
  EMT_Acc[,(<span class="kw">ncol</span>(EMT_Acc)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EMT_Acc)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_mod_EMT_Acc
  <span class="kw">names</span>(EMT_Acc)[(<span class="kw">ncol</span>(EMT_Acc)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EMT_Acc)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>) 

<span class="co"># Construct model             </span>
  mod_EMT_Acc.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Answer<span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span>Stim_Type),                   
                          <span class="dt">data =</span> EMT_Acc,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)         


<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_Acc.glmm1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_Acc.glmm1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Likelihood ratio testing </span>

<span class="co"># ID</span>
  mod_EMT_Acc.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Answer<span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span>Stim_Type),                   
                          <span class="dt">data =</span> EMT_Acc,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)    

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm2)


<span class="co"># Stimulus type </span>
  mod_EMT_Acc.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Answer<span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span>  <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),                   
                          <span class="dt">data =</span> EMT_Acc,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)    


<span class="co"># Calculate ANOVAs</span>
  <span class="kw">anova</span>(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm3)


<span class="co"># Final model</span>
  mod_EMT_Acc.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Answer<span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>ID)<span class="op">+</span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type),                   
                            <span class="dt">data =</span> EMT_Acc,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)  </code></pre></div>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Hap_Neu</code>, <code>Ang_Neu</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ID) + ,     (1 + Hap_Neu + Ang_Neu || Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-overdispersion" class="section level5">
<h5>GLMM: Overdispersion</h5>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assumption check: Appropriate estimation of variance</span>
  <span class="kw">overdisp_fun</span>(mod_EMT_Acc.glmm4)</code></pre></div>
<pre><code>  chisq   ratio     rdf       p 
1036.50    0.72 1448.00    1.00 </code></pre>
<hr />
</div>
<div id="lmm-random-effect-structure" class="section level5">
<h5>LMM: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correct responses</span>
  EMT_RT =<span class="st"> </span><span class="kw">subset</span>(EMT, Answer <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># RT cleaning criteria</span>
  EMT_RT =<span class="st"> </span><span class="kw">subset</span>(EMT_RT,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  

<span class="co"># Factor random effects </span>
  EMT_RT<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EMT_RT<span class="op">$</span>ID)
  EMT_RT<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EMT_RT<span class="op">$</span>Stim_Type)

<span class="co"># Create factor, define neutral as baseline</span>
  EMT_RT<span class="op">$</span>emotion =<span class="st"> </span><span class="kw">factor</span>(EMT_RT<span class="op">$</span>emotion, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(EMT_RT<span class="op">$</span>emotion) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)

<span class="co"># Add contrast columns</span>
  mm_c =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>emotion, EMT_RT) 

<span class="co"># Attach to dataframe</span>
  EMT_RT[,(<span class="kw">ncol</span>(EMT_RT)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EMT_RT)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_c
  <span class="kw">names</span>(EMT_RT)[(<span class="kw">ncol</span>(EMT_RT)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EMT_RT)] =<span class="st">  </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>) 

<span class="co"># Build model </span>
  mod_EMT_RT.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> EMT_RT,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_RT.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_RT.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)


<span class="co"># Improved model</span>
  mod_EMT_RT.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> EMT_RT,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))


<span class="co"># Re-check the model</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_EMT_RT.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_EMT_RT.lmer2 ),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

## Likelihood ratio testing

<span class="co"># ID</span>
  mod_EMT_RT.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> EMT_RT,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_EMT_RT.lmer2,mod_EMT_RT.lmer3)

<span class="co"># Stim_Type </span>
  mod_EMT_RT.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> EMT_RT,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_EMT_RT.lmer2,mod_EMT_RT.lmer4)


<span class="co"># Final model</span>
  mod_EMT_RT.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID)<span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type),
                          <span class="dt">data =</span> EMT_RT,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + ,     (1 | ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm-normality-of-residuals" class="section level5">
<h5>LMM: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RT_in_ms <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data=</span>EMT_RT)
  res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  
  
  qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))

<span class="co"># Check which transformation of DV is suitable</span>

<span class="co"># Calculate box-cox plot</span>
  mod_RT_targ =<span class="st"> </span><span class="kw">lm</span>(RT_in_ms <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data=</span>EMT_RT)
  <span class="kw">boxcox</span>(mod_RT_targ)   </code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (with log transform)</span>
  mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RT_in_ms) <span class="op">~</span><span class="st"> </span>emotion, <span class="dt">data=</span>EMT_RT)
  res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log, <span class="dt">main=</span><span class="st">&quot;QQplot after transformation&quot;</span>)    
  norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main=</span><span class="st">&quot;Density plot after transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))            </code></pre></div>
<hr />
</div>
<div id="lmm-homoscedasticity" class="section level5">
<h5>LMM: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_EMT_RT.lmer5), <span class="kw">residuals</span>(mod_EMT_RT.lmer5))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)         </code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print GLMM / LMM results -->
<p>With regard to accuracy, we did not find a significant effect for happy vs neutral faces or angry vs neutral faces. Children were significantly faster for happy compared to neutral faces, but not for angry compared to neutral faces. None of the covariates reached significance.</p>
<div align="center">


<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define labels      </span>
  labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Intercept&quot;</span>,<span class="st">&quot;Happy vs Neutral&quot;</span>, <span class="st">&quot;Angry vs Neutral&quot;</span>, <span class="st">&quot;Age&quot;</span>,<span class="st">&quot;Working memory&quot;</span>)

<span class="co"># Show results</span>
  <span class="kw">tab_model</span>(mod_EMT_Acc.glmm4, mod_EMT_RT.lmer5,
          <span class="dt">pred.labels=</span>labels, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>,
          <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,
          <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>,
          <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">TRUE</span>,
          <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;Accuracy&quot;</span>,<span class="st">&quot;Reaction time&quot;</span>) , <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Accuracy
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Reaction time
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
7.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
125.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.421
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.039</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.151
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.061
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.155
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.130
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.636
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.171
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.12
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.02 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7.06 <sub>Stim_Type.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.89 <sub>Stim_Type.2</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.71 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.45
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1457
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
994
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.027 / 0.428
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.054 / 0.483
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="emotion--and-empathy-related-measures-and-erp" class="section level1">
<h1>Emotion- and empathy related measures and ERP</h1>
<p>We also investigated the link between ERP amplitudes and emotion- and empathy-related measures. We calculated correlations between the amplitude differences of angry and neutral faces with composite scores parentsâ€™ and experimenterâ€™s rating of childrenâ€™s empathy and emotion knowledge.</p>
<!-- Display correlation plots -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Separate data set for neutral and angry and dalculate participant&#39;s P1/P3 mean

<span class="co"># angry</span>
  ERPs_ang =<span class="st"> </span><span class="kw">subset</span>(ERPs, Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)
  ERPs_mean =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">tapply</span>(ERPs_ang<span class="op">$</span>mean_ROI_P1,ERPs_ang<span class="op">$</span>ID, mean))
  <span class="kw">names</span>(ERPs_mean)[<span class="dv">1</span>] =<span class="st"> &quot;P1_ang&quot;</span>
  ERPs_mean<span class="op">$</span>P3_ang =<span class="st"> </span><span class="kw">tapply</span>(ERPs_ang<span class="op">$</span>mean_ROI_P3,ERPs_ang<span class="op">$</span>ID, mean)

<span class="co"># neutral  </span>
  ERPs_neu =<span class="st"> </span><span class="kw">subset</span>(ERPs, Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)
  ERPs_mean<span class="op">$</span>P1_neu =<span class="st"> </span><span class="kw">tapply</span>(ERPs_neu<span class="op">$</span>mean_ROI_P1,ERPs_neu<span class="op">$</span>ID, mean)
  ERPs_mean<span class="op">$</span>P3_neu =<span class="st"> </span><span class="kw">tapply</span>(ERPs_neu<span class="op">$</span>mean_ROI_P3,ERPs_neu<span class="op">$</span>ID, mean)

<span class="co"># Calculate difference score for angry-neutral</span>
  ERPs_mean<span class="op">$</span>P1_Diff_Ang_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P1_ang<span class="op">-</span>ERPs_mean<span class="op">$</span>P1_neu
  ERPs_mean<span class="op">$</span>P3_Diff_Ang_Neu =<span class="st"> </span>ERPs_mean<span class="op">$</span>P3_ang<span class="op">-</span>ERPs_mean<span class="op">$</span>P3_neu

<span class="co"># Remove rows of de-selected participants </span>
  ERPs_mean =<span class="st"> </span>ERPs_mean[<span class="op">-</span><span class="kw">c</span>(<span class="dv">4</span>),]  

<span class="co"># Integrate questionnare data   </span>
  ERPs_mean<span class="op">$</span>EMK_EK_P =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EK_P
  ERPs_mean<span class="op">$</span>EMK_EM_P =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EM_P
  ERPs_mean<span class="op">$</span>EMK_EK_Ch =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EK_Ch
  ERPs_mean<span class="op">$</span>EMK_EM_Ch =<span class="st"> </span>qn_data<span class="op">$</span>EMK_EM_Ch

<span class="co"># Compute composite scores for parental/children measures of EMK</span>
  ERPs_mean<span class="op">$</span>EMK_EK =<span class="st"> </span>ERPs_mean<span class="op">$</span>EMK_EK_P <span class="op">+</span><span class="st"> </span>ERPs_mean<span class="op">$</span>EMK_EK_Ch
  ERPs_mean<span class="op">$</span>EMK_EM =<span class="st"> </span>ERPs_mean<span class="op">$</span>EMK_EM_Ch <span class="op">+</span><span class="st"> </span>ERPs_mean<span class="op">$</span>EMK_EM_Ch

<span class="co"># Select variables</span>
  ERPs_corr =<span class="st"> </span><span class="kw">subset</span>(ERPs_mean,<span class="dt">select =</span> <span class="kw">c</span>(P1_Diff_Ang_Neu, P3_Diff_Ang_Neu, EMK_EM,EMK_EK))

## Plot correlations

<span class="co"># Empathy and P1 difference  </span>
  EMT_ERP_scat1 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean,<span class="kw">aes</span>(<span class="dt">x =</span> EMK_EM, <span class="dt">y =</span> P1_Diff_Ang_Neu))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span><span class="st">&quot;gray0&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray0&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Empathy Score&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P1 difference angry vs neutral&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()

<span class="co"># Empathy and P3 difference  </span>
  EMT_ERP_scat2 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean,<span class="kw">aes</span>(<span class="dt">x=</span> EMK_EM, <span class="dt">y =</span> P3_Diff_Ang_Neu))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span><span class="st">&quot;gray27&quot;</span>, <span class="dt">fill =</span><span class="st">&quot;gray27&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Empathy Score&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P3 difference angry vs neutral&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()

<span class="co"># EK and P1 difference  </span>
  EMT_ERP_scat3 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean,<span class="kw">aes</span>(<span class="dt">x =</span> EMK_EK, <span class="dt">y =</span> P1_Diff_Ang_Neu))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span><span class="st">&quot;gray35&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;gray35&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Emotion knowledge&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P1 difference angry vs neutral&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()

<span class="co"># EK and P3 difference  </span>
  EMT_ERP_scat4 =<span class="st"> </span><span class="kw">ggplot</span>(ERPs_mean,<span class="kw">aes</span>(<span class="dt">x=</span> EMK_EK, <span class="dt">y =</span> P3_Diff_Ang_Neu))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">shape =</span> <span class="dv">21</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">color =</span><span class="st">&quot;gray52&quot;</span>, <span class="dt">fill =</span><span class="st">&quot;gray52&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span>lm, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Emotion knowledge&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;P3 difference angry vs neutral&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()

<span class="co"># Combine plots</span>
  <span class="co"># Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)</span>
  <span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(EMT_ERP_scat1, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(EMT_ERP_scat2, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(EMT_ERP_scat3, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(EMT_ERP_scat4, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>) </code></pre></div>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMK_ERP_scat_plots-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><br></p>
<p>None of the correlations between ERP amplitude differences and emotion- and empathy-related measures reached significance.</p>
<!-- Display correlation table -->
<div align="center">
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create correlation table</span>
  ERP_corr_table  =<span class="st"> </span><span class="kw">apaCorr</span>(<span class="kw">as.matrix</span>(ERPs_corr), <span class="dt">corrtype =</span> <span class="st">&quot;spearman&quot;</span>)
  <span class="kw">kable</span>(ERP_corr_table , <span class="dt">format =</span> <span class="st">&quot;markdown&quot;</span>)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1. P1 Diff Ang Neu</td>
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">2. P3 Diff Ang Neu</td>
<td align="left">0.5**</td>
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">3. EMK EM</td>
<td align="left">0.26</td>
<td align="left">0.05</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">4. EMK EK</td>
<td align="left">-0.11</td>
<td align="left">-0.2</td>
<td align="left">0.11</td>
<td align="left">-</td>
</tr>
</tbody>
</table>
</div>
<p><em>Note:</em> Correlation coefficients were computed with Spearmanâ€™s rank correlations. * p&lt; .05; ** p&lt; .01; *** p&lt; .001.</p>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get session info </span>
  <span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>R version 3.6.2 (2019-12-12)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 16299)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
 [1] table1_1.2           knitr_1.28           gridGraphics_0.5-0  
 [4] corrplot_0.84        gvlma_1.0.0.3        eegUtils_0.5.0      
 [7] akima_0.6-2          forcats_0.5.0        stringr_1.4.0       
[10] purrr_0.3.4          readr_1.3.1          tidyr_1.0.2         
[13] tibble_3.0.1         tidyverse_1.3.0      sjlabelled_1.1.3    
[16] sjmisc_2.8.4         sjPlot_2.8.3         Rmisc_1.5           
[19] plyr_1.8.6           reshape2_1.4.4       psych_1.9.12.31     
[22] MASS_7.3-51.5        lmerTest_3.1-2       lme4_1.1-23         
[25] Matrix_1.2-18        Hmisc_4.4-0          Formula_1.2-3       
[28] survival_3.1-8       lattice_0.20-38      ggstatsplot_0.4.0   
[31] ez_4.4-0             EnvStats_2.3.1       eeptools_1.2.2      
[34] ggplot2_3.3.0        dplyr_0.8.5          cowplot_1.0.0       
[37] summarytools_0.9.6   miceadds_3.9-14      mice_3.9.0          
[40] rmdformats_0.3.7     XLConnectJars_0.2-15 XLConnect_1.0.1     
[43] kableExtra_1.1.0    

loaded via a namespace (and not attached):
 [1] vcd_1.4-7            ps_1.3.2             lmtest_0.9-37       
 [4] crayon_1.3.4         jcolors_0.0.4        nlme_3.1-147        
 [7] backports_1.1.6      metafor_2.4-0        reprex_0.3.0        
[10] ggcorrplot_0.1.3     rlang_0.4.5          readxl_1.3.1        
[13] performance_0.4.5    nloptr_1.2.2.1       callr_3.4.3         
[16] rjson_0.2.20         glue_1.4.0           loo_2.2.0           
[19] rstan_2.19.3         parallel_3.6.2       processx_3.4.2      
[22] shinydashboard_0.7.1 tcltk_3.6.2          haven_2.2.0         
[25] tidyselect_1.0.0     rio_0.5.16           zoo_1.8-7           
[28] mc2d_0.1-18          xtable_1.8-4         MatrixModels_0.4-1  
[31] magrittr_1.5         evaluate_0.14        cli_2.0.2           
[34] rstudioapi_0.11      miniUI_0.1.1.1       sp_1.4-1            
[37] rpart_4.1-15         maps_3.3.0           shiny_1.4.0.2       
[40] xfun_0.13            parameters_0.6.1     groupedstats_0.2.2  
[43] inline_0.3.15        pkgbuild_1.0.6       cluster_2.1.0       
[46] bridgesampling_1.0-0 WRS2_1.0-0           expm_0.999-4        
[49] Brobdingnag_1.2-6    ggrepel_0.8.2        listenv_0.8.0       
[52] png_0.1-7            reshape_0.8.8        future_1.17.0       
[55] zeallot_0.1.0        withr_2.2.0          rcompanion_2.3.25   
[58] cellranger_1.1.0     pracma_2.2.9         coda_0.19-3         
[61] pillar_1.4.3         multcomp_1.4-13      fs_1.4.1            
[64] paletteer_1.1.0      vctrs_0.2.4          ellipsis_0.3.0      
[67] generics_0.0.2       nortest_1.0-4        tools_3.6.2         
[70] foreign_0.8-72       munsell_0.5.0        emmeans_1.4.6       
[73] fastmap_1.0.1        compiler_3.6.2       abind_1.4-5         
 [ reached getOption(&quot;max.print&quot;) -- omitted 129 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
