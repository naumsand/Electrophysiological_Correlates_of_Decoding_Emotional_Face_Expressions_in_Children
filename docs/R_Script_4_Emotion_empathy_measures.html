<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Emotion and empathy measures</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-wrench"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    EEG task measures
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Emotion and empathy measures</h1>

</div>


<!-- Set up workspace -->
<!-- Load and prepare data sets -->
<p><br></p>
<div id="emotion-matching-task" class="section level3">
<h3>Emotion matching task</h3>
<p>We employed an emotion matching task (EMT; adapted from Watling &amp; Damaskinou, 2018) to assess children’s emotion knowledge. Children saw two faces with the same identity but different facial expression. Both faces were presented at the same time. While the faces were on screen, the children heard an audio lay-over of one of the emotion words (happy, angry or neutral). The children had to indicate with a button press which face matched the audio lay-over. We measured reaction times and accuracy.</p>
<p>We excluded:</p>
<ul>
<li>Reaction times &lt; 250 ms or &gt; 7s</li>
<li>Values &lt;/&gt; 2.5 of the median absolute deviation (MAD) based on the individual participant</li>
<li>Incorrect answers</li>
</ul>
<p>We calculated general linear mixed models (GLMM) for accuracy rates and linear mixed models (LMM) for reaction times. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all (general) linear mixed model analyses to control for cognitive abilities of the children as well as potential differences in age.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
<p>We expected the highest accuracy rates for happy faces (tested with <code>GLMM</code>) and fastest reaction times for pairings where happy faces were involved (tested with <code>LMM</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p><br></p>
<div id="descriptives" class="section level4">
<h4><strong>Descriptives</strong></h4>
<p><br></p>
<!-- Plot EMT accuracy & reaction time -->
<pre class="r"><code># Select RT inspected criteria
  EMT_Acc_Plot = subset(EMT,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE) 

# Select correct trials
  EMT_Acc_Plot = subset(EMT_Acc_Plot, Answer == 1)

# Create factor, define neutral as baseline
  EMT_Acc_Plot$emotion = factor(EMT_Acc_Plot$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Get accuracy for novel and repeated condition 
  acc_all = data.frame(xtabs(~ID+emotion, EMT_Acc_Plot)) 

# Recode to accuracy in percent
  acc_all$Freq = (acc_all$Freq/24)*100

# Calculate descriptives on accuracy
  stats_acc_all = summarySE(acc_all, measurevar=&quot;Freq&quot;, groupvars=c(&quot;emotion&quot;))

# Plot accuracy
  EMT_Acc_bar = ggplot(stats_acc_all, aes(x=emotion, y=Freq, fill = emotion)) + 
    geom_bar(position=position_dodge(), stat=&quot;identity&quot;,colour=&quot;black&quot;, size=0.7,width=0.9) +
    geom_errorbar(aes(ymin=Freq-se, ymax=Freq+se), size=1, width=0.2, position=position_dodge(.9)) +
    labs (x= &quot;&quot;, y = &quot;Accuracy [%]&quot;) +
    coord_cartesian(ylim = c(0, 60)) +
    scale_y_continuous(breaks=seq(0,60,20))+
    scale_fill_manual(values=emotion_col)+
    theme_bw()+
    theme_SN

# Raincloud plot EMT RT

# Only examine clean data
  EMT_RT_Plot = subset(EMT,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)

# Select correct responses
  EMT_RT_Plot = subset(EMT_RT_Plot, Answer == 1)

# Create factor, define neutral as baseline
  EMT_RT_Plot$emotion = factor(EMT_RT_Plot$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Calculate summary
  lb = function(x) mean(x) - sd(x)
  ub = function(x) mean(x) + sd(x)
  
  sumld = ddply(EMT_RT_Plot , ~ emotion, summarise,
                mean = mean(RT_in_ms), median = median(RT_in_ms), lower = lb(RT_in_ms), upper = ub(RT_in_ms))
  
# Plot rainclouds
  EMT_RT_rain =  ggplot(data = EMT_RT_Plot, aes(y = RT_in_ms, x = emotion, fill = emotion))  +
    geom_flat_violin(position = position_nudge(x = .12, y = 0), alpha = 1, color=&quot;black&quot;) +
    geom_point(aes(y = RT_in_ms, color = emotion), shape = 19, position = position_jitter(width = .1), size = .7, alpha = 1)  +
    geom_point(data = sumld, aes(x = emotion, y = mean), position = position_nudge(x = .2), size = 2.5) +
    geom_errorbar(data = sumld, aes(ymin = lower, ymax = upper, y = mean), position = position_nudge(x = .2, y = 0), width = 0)+
    scale_y_continuous(name=&quot;Reaction time [ms]&quot;, breaks=seq(0,6500,1000), limits=c(0,6500))+
    xlab(&quot;&quot;)+
    expand_limits(x = 2.00) +
    guides(fill = FALSE) +
    guides(color = FALSE) +
    coord_flip() + # flip or not?
    scale_fill_manual(values=emotion_col) +
    scale_color_manual(values=emotion_col)+
    theme_bw() +
    theme_SN+
    theme(panel.grid.major.y = element_blank())
  
# Combine plots
  combine_plots(EMT_Acc_bar, EMT_RT_rain,
                ncol = 2, nrow = 1,
                labels = c(&quot;A&quot;, &quot;B&quot;))</code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_acc_RT_plot-1.png" width="1056" /></p>
<p><br></p>
<hr />
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<!-- GLMM / LMM assumption checks -->
<div id="glmm-random-effect-structure" class="section level5">
<h5>GLMM: Random effect structure</h5>
<pre class="r"><code># RT cleaning criteria
  EMT_Acc = subset(EMT,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  

# Factor random effects 
  EMT_Acc$ID = as.factor(EMT_Acc$ID)
  EMT_Acc$Stim_Type = as.factor(EMT_Acc$Stim_Type)

# Create factor, define neutral as baseline
  EMT_Acc$emotion = factor(EMT_Acc$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Set treatment contrast
  contrasts(EMT_Acc$emotion) = contr.treatment(3)

# Add contrast columns
  mm_mod_EMT_Acc =  model.matrix( ~ emotion, EMT_Acc) 

# Attach to dataframe
  EMT_Acc[,(ncol(EMT_Acc)+1):(ncol(EMT_Acc)+3)] = mm_mod_EMT_Acc
  names(EMT_Acc)[(ncol(EMT_Acc)-2):ncol(EMT_Acc)] = c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 

# Construct model             
  mod_EMT_Acc.glmm1 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                            (1 + Hap_Neu + Ang_Neu ||ID) + 
                            (1 + Hap_Neu + Ang_Neu ||Stim_Type),                   
                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                          family = binomial)         


# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_EMT_Acc.glmm1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_EMT_Acc.glmm1),comp = &quot;Variance&quot;)

# Likelihood ratio testing 

# ID
  mod_EMT_Acc.glmm2 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                            (1 |ID) + 
                            (1 + Hap_Neu + Ang_Neu ||Stim_Type),                   
                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                          family = binomial)    

# Calculate ANOVA
  anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm2)


# Stimulus type 
  mod_EMT_Acc.glmm3 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                            (1  + Hap_Neu + Ang_Neu ||ID) + 
                            (1 |Stim_Type),                   
                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                          family = binomial)    


# Calculate ANOVAs
  anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm3)


# Final model
  mod_EMT_Acc.glmm4 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + (1|ID)+(1 + Hap_Neu + Ang_Neu || Stim_Type),                   
                            data = EMT_Acc,control=glmerControl(calc.derivs = FALSE), family = binomial)  </code></pre>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Hap_Neu</code>, <code>Ang_Neu</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ID) + ,     (1 + Hap_Neu + Ang_Neu || Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-overdispersion" class="section level5">
<h5>GLMM: Overdispersion</h5>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<pre class="r"><code># Assumption check: Appropriate estimation of variance
  overdisp_fun(mod_EMT_Acc.glmm4)</code></pre>
<pre><code>##   chisq   ratio     rdf       p 
## 1036.50    0.72 1448.00    1.00</code></pre>
<hr />
</div>
<div id="lmm-random-effect-structure" class="section level5">
<h5>LMM: Random effect structure</h5>
<pre class="r"><code># Correct responses
  EMT_RT = subset(EMT, Answer == 1)

# RT cleaning criteria
  EMT_RT = subset(EMT_RT,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  

# Factor random effects 
  EMT_RT$ID = as.factor(EMT_RT$ID)
  EMT_RT$Stim_Type = as.factor(EMT_RT$Stim_Type)

# Create factor, define neutral as baseline
  EMT_RT$emotion = factor(EMT_RT$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Set treatment contrast
  contrasts(EMT_RT$emotion) = contr.treatment(3)

# Add contrast columns
  mm_c =  model.matrix( ~ emotion, EMT_RT) 

# Attach to dataframe
  EMT_RT[,(ncol(EMT_RT)+1):(ncol(EMT_RT)+3)] = mm_c
  names(EMT_RT)[(ncol(EMT_RT)-2):ncol(EMT_RT)] =  c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 

# Build model 
  mod_EMT_RT.lmer1 = lmer(log(RT_in_ms) ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Hap_Neu + Ang_Neu||ID) +
                            (1 + Hap_Neu + Ang_Neu||Stim_Type),
                          data = EMT_RT,
                          control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_EMT_RT.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_EMT_RT.lmer1),comp = &quot;Variance&quot;)


# Improved model
  mod_EMT_RT.lmer2 = lmer(log(RT_in_ms) ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Ang_Neu||ID) +
                            (0 + Ang_Neu||Stim_Type),
                          data = EMT_RT,
                          control=lmerControl(calc.derivs = FALSE))


# Re-check the model
  summary(rePCA(mod_EMT_RT.lmer2))
  print(VarCorr(mod_EMT_RT.lmer2 ),comp = &quot;Variance&quot;)

## Likelihood ratio testing

# ID
  mod_EMT_RT.lmer3 = lmer(log(RT_in_ms) ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 |ID) +
                            (0 + Ang_Neu||Stim_Type),
                          data = EMT_RT,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_EMT_RT.lmer2,mod_EMT_RT.lmer3)

# Stim_Type 
  mod_EMT_RT.lmer4 = lmer(log(RT_in_ms) ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Ang_Neu|ID) +
                            (1|Stim_Type),
                          data = EMT_RT,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_EMT_RT.lmer2,mod_EMT_RT.lmer4)


# Final model
  mod_EMT_RT.lmer5 = lmer(log(RT_in_ms) ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 | ID)+
                            (1 | Stim_Type),
                          data = EMT_RT,
                          control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). Accordingly, we fitted single-trial data to the following model:</p>
<p><code>log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + ,     (1 | ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm-normality-of-residuals" class="section level5">
<h5>LMM: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_RT_lmm_no_log = lm(RT_in_ms ~ emotion, data=EMT_RT)
  res.mod_RT_lmm_no_log = residuals(mod_RT_lmm_no_log)
  
  par(mfrow=c(1,2))
  
  
  qqpl_RT_lmm_no_log = qqPlot(res.mod_RT_lmm_no_log, main=&quot;QQplot before transformation&quot;)    
  norm_RT_lmm_no_log = plot(density(res.mod_RT_lmm_no_log), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))

# Check which transformation of DV is suitable

# Calculate box-cox plot
  mod_RT_targ = lm(RT_in_ms ~ emotion, data=EMT_RT)
  boxcox(mod_RT_targ)   </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-2.png" width="576" /></p>
<pre class="r"><code># Visualize normality assumption of residuals (with log transform)
  mod_RT_lmm_log = lm(log(RT_in_ms) ~ emotion, data=EMT_RT)
  res.mod_RT_lmm_log = residuals(mod_RT_lmm_log)
  
  par(mfrow=c(1,2))
  qqpl_RT_lmm_log = qqPlot(res.mod_RT_lmm_log, main=&quot;QQplot after transformation&quot;)    
  norm_RT_lmm_log = plot(density(res.mod_RT_lmm_log), main=&quot;Density plot after transformation&quot;)  </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-3.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))            </code></pre>
<hr />
</div>
<div id="lmm-homoscedasticity" class="section level5">
<h5>LMM: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_EMT_RT.lmer5), residuals(mod_EMT_RT.lmer5))
  abline(0, 0)         </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_homosk-1.png" width="480" /></p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print GLMM / LMM results -->
<p>With regard to accuracy, we did not find a significant effect for happy vs neutral faces or angry vs neutral faces. Children were significantly faster for happy compared to neutral faces, but not for angry compared to neutral faces. None of the covariates reached significance.</p>
<pre class="r"><code># Define labels      
  labels = c(&quot;Intercept&quot;,&quot;Happy vs Neutral&quot;, &quot;Angry vs Neutral&quot;, &quot;Age&quot;,&quot;Working memory&quot;)

# Show results
  tab_model(mod_EMT_Acc.glmm4, mod_EMT_RT.lmer5,
          pred.labels=labels, show.ci = FALSE,
          show.se = TRUE, string.se = &quot;SE&quot;,
          show.stat = TRUE, string.stat = &quot;t&quot;,
          show.re.var = TRUE, show.obs = TRUE,
          emph.p = TRUE, dv.labels=c(&quot;Accuracy&quot;,&quot;Reaction time&quot;) , show.icc = TRUE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Accuracy
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Reaction time
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
7.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
125.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.421
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.039</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.44
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.151
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.061
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.155
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.130
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.636
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.171
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.12
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.02 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
7.06 <sub>Stim_Type.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.89 <sub>Stim_Type.2</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.71 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.45
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1457
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
994
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.027 / 0.428
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.054 / 0.483
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
<p><br></p>
</div>
</div>
<div id="emotion--and-empathy-related-measures-and-erp" class="section level3">
<h3>Emotion- and empathy related measures and ERP</h3>
<p>We also investigated the link between ERP amplitudes and emotion- and empathy-related measures. We calculated correlations between the amplitude differences of angry and neutral faces with composite scores parents’ and experimenter’s rating of children’s empathy and emotion knowledge.</p>
<!-- Display correlation plots -->
<pre class="r"><code>## Separate data set for neutral and angry and dalculate participant&#39;s P1/P3 mean

# angry
  ERPs_ang = subset(ERPs, Condition == 3)
  ERPs_mean = data.frame(tapply(ERPs_ang$mean_ROI_P1,ERPs_ang$ID, mean))
  names(ERPs_mean)[1] = &quot;P1_ang&quot;
  ERPs_mean$P3_ang = tapply(ERPs_ang$mean_ROI_P3,ERPs_ang$ID, mean)

# neutral  
  ERPs_neu = subset(ERPs, Condition == 2)
  ERPs_mean$P1_neu = tapply(ERPs_neu$mean_ROI_P1,ERPs_neu$ID, mean)
  ERPs_mean$P3_neu = tapply(ERPs_neu$mean_ROI_P3,ERPs_neu$ID, mean)

# Calculate difference score for angry-neutral
  ERPs_mean$P1_Diff_Ang_Neu = ERPs_mean$P1_ang-ERPs_mean$P1_neu
  ERPs_mean$P3_Diff_Ang_Neu = ERPs_mean$P3_ang-ERPs_mean$P3_neu

# Remove rows of de-selected participants 
  ERPs_mean = ERPs_mean[-c(4),]  

# Integrate questionnare data   
  ERPs_mean$EMK_EK_P = qn_data$EMK_EK_P
  ERPs_mean$EMK_EM_P = qn_data$EMK_EM_P
  ERPs_mean$EMK_EK_Ch = qn_data$EMK_EK_Ch
  ERPs_mean$EMK_EM_Ch = qn_data$EMK_EM_Ch

# Compute composite scores for parental/children measures of EMK
  ERPs_mean$EMK_EK = ERPs_mean$EMK_EK_P + ERPs_mean$EMK_EK_Ch
  ERPs_mean$EMK_EM = ERPs_mean$EMK_EM_Ch + ERPs_mean$EMK_EM_Ch

# Select variables
  ERPs_corr = subset(ERPs_mean,select = c(P1_Diff_Ang_Neu, P3_Diff_Ang_Neu, EMK_EM,EMK_EK))

## Plot correlations

# Empathy and P1 difference  
  EMT_ERP_scat1 = ggplot(ERPs_mean,aes(x = EMK_EM, y = P1_Diff_Ang_Neu))+
    geom_point(shape = 21, size = 2, color =&quot;gray0&quot;, fill = &quot;gray0&quot;)+
    geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
    labs(x = &quot;Empathy Score&quot;, y = &quot;P1 difference angry vs neutral&quot;)+
    theme_bw()

# Empathy and P3 difference  
  EMT_ERP_scat2 = ggplot(ERPs_mean,aes(x= EMK_EM, y = P3_Diff_Ang_Neu))+
    geom_point(shape = 21, size = 2, color =&quot;gray27&quot;, fill =&quot;gray27&quot;)+
    geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
    labs(x = &quot;Empathy Score&quot;, y = &quot;P3 difference angry vs neutral&quot;)+
    theme_bw()

# EK and P1 difference  
  EMT_ERP_scat3 = ggplot(ERPs_mean,aes(x = EMK_EK, y = P1_Diff_Ang_Neu))+
    geom_point(shape = 21, size = 2, color =&quot;gray35&quot;, fill = &quot;gray35&quot;)+
    geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
    labs(x = &quot;Emotion knowledge&quot;, y = &quot;P1 difference angry vs neutral&quot;)+
    theme_bw()

# EK and P3 difference  
  EMT_ERP_scat4 = ggplot(ERPs_mean,aes(x= EMK_EK, y = P3_Diff_Ang_Neu))+
    geom_point(shape = 21, size = 2, color =&quot;gray52&quot;, fill =&quot;gray52&quot;)+
    geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
    labs(x = &quot;Emotion knowledge&quot;, y = &quot;P3 difference angry vs neutral&quot;)+
    theme_bw()

# Combine plots
  # Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)
  ggdraw(xlim = c(0, 1), ylim = c(0,1)) +
    draw_plot(EMT_ERP_scat1, 0, 0.5, 0.5, 0.5) +
    draw_plot(EMT_ERP_scat2, 0.5, 0.5, 0.5, 0.5) +
    draw_plot(EMT_ERP_scat3, 0, 0, 0.5, 0.5) +
    draw_plot(EMT_ERP_scat4, 0.5, 0, 0.5, 0.5) </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMK_ERP_scat_plots-1.png" width="672" /></p>
<p><br></p>
<p>None of the correlations between ERP amplitude differences and emotion- and empathy-related measures reached significance.</p>
<!-- Display correlation table -->
<pre class="r"><code># Create correlation table
  ERP_corr_table  = apaCorr(as.matrix(ERPs_corr), corrtype = &quot;spearman&quot;)
  kable(ERP_corr_table , format = &quot;markdown&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">1</th>
<th align="left">2</th>
<th align="left">3</th>
<th align="left">4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1. P1 Diff Ang Neu</td>
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">2. P3 Diff Ang Neu</td>
<td align="left">0.5**</td>
<td align="left">-</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">3. EMK EM</td>
<td align="left">0.26</td>
<td align="left">0.05</td>
<td align="left">-</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">4. EMK EK</td>
<td align="left">-0.11</td>
<td align="left">-0.2</td>
<td align="left">0.11</td>
<td align="left">-</td>
</tr>
</tbody>
</table>
<p><em>Note:</em> Correlation coefficients were computed with Spearman’s rank correlations. * p&lt; .05; ** p&lt; .01; *** p&lt; .001.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
