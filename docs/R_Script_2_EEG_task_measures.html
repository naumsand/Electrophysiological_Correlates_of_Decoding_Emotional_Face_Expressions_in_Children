<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Matching task</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #ffffff; color: #1f1c1b; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #ffffff; color: #a0a0a0; border-right: 1px solid #a0a0a0; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #1f1c1b; background-color: #ffffff; }
code > span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code > span.dt { color: #0057ae; } /* DataType */
code > span.dv { color: #b08000; } /* DecVal */
code > span.bn { color: #b08000; } /* BaseN */
code > span.fl { color: #b08000; } /* Float */
code > span.cn { color: #aa5500; } /* Constant */
code > span.ch { color: #924c9d; } /* Char */
code > span.sc { color: #3daee9; } /* SpecialChar */
code > span.st { color: #bf0303; } /* String */
code > span.vs { color: #bf0303; } /* VerbatimString */
code > span.ss { color: #ff5500; } /* SpecialString */
code > span.im { color: #ff5500; } /* Import */
code > span.co { color: #898887; } /* Comment */
code > span.do { color: #607880; } /* Documentation */
code > span.an { color: #ca60ca; } /* Annotation */
code > span.cv { color: #0095ff; } /* CommentVar */
code > span.ot { color: #006e28; } /* Other */
code > span.fu { color: #644a9b; } /* Function */
code > span.va { color: #0057ae; } /* Variable */
code > span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code > span.op { color: #1f1c1b; } /* Operator */
code > span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code > span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code > span.pp { color: #006e28; } /* Preprocessor */
code > span.at { color: #0057ae; } /* Attribute */
code > span.re { color: #0057ae; } /* RegionMarker */
code > span.in { color: #b08000; } /* Information */
code > span.wa { color: #bf0303; } /* Warning */
code > span.al { color: #bf0303; font-weight: bold; } /* Alert */
code > span.er { color: #bf0303; text-decoration: underline; } /* Error */
code > span. { color: #1f1c1b; } /* Normal */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">Matching task</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#task-description">Task description</a></li>
        <li><a href="#accuracy">Accuracy</a></li>
        <li><a href="#reaction-time">Reaction time</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Same-different matching task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load data set-->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>Our EEG paradigm included a delayed same-different matching task in which children had do indicate whether Face 1 and Face 2 showed the same (<code>repeated</code>) or a different emotional facial expression (<code>novel</code>). We measured participantsâ€™ accuracy rates and reaction times.</p>
<p>We excluded:</p>
<ul>
<li>Reaction times &lt; 250 ms or &gt; 7s</li>
<li>Values &lt;/&gt; 2.5 of the median absolute deviation (MAD) based on the individual participant</li>
<li>Incorrect answers</li>
</ul>
<p>We calculated general linear mixed models (GLMM) for accuracy rates and linear mixed models (LMM) for reaction times. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all (general) linear mixed model analyses to control for cognitive abilities of the children as well as potential differences in age.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
</div>
<div id="accuracy" class="section level1">
<h1>Accuracy</h1>
<p>We predicted that children would be less accurate when Face 1 and Face 2 were repeated (<code>GLMM 1</code>). We also expected the highest accuracy rates for pairings where happy faces were involved (<code>GLMM 2</code>).</p>
<p><br></p>
<div id="descriptive-statistics" class="section level5">
<h5><strong>Descriptive statistics</strong></h5>
<!-- Draw EEG task accuracy plots -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select outlier-free data and correct trials</span>
  EEG_task_Acc_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)
  EEG_task_Acc_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_Acc_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

## Plot separated by novel vs repeated trials  
  
<span class="co"># Recode variable</span>
  EEG_task_Acc_plot<span class="op">$</span>Cong[EEG_task_Acc_plot<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span>
  EEG_task_Acc_plot<span class="op">$</span>Cong[EEG_task_Acc_plot<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span>

<span class="co"># Get accuracy for novel and repeated condition</span>
  acc_all =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID<span class="op">+</span>Cong, EEG_task_Acc_plot))

<span class="co"># Recode to accuracy in percent (72 novel trials, 72 repeated trials)</span>
  acc_all<span class="op">$</span>Freq =<span class="st"> </span>(acc_all<span class="op">$</span>Freq<span class="op">/</span><span class="dv">72</span>)<span class="op">*</span><span class="dv">100</span>

<span class="co"># Factor condition</span>
  acc_all<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">as.factor</span>(acc_all<span class="op">$</span>Cong)

<span class="co"># Calculate descriptives on accuracy</span>
  stats_acc_all =<span class="st"> </span><span class="kw">summarySE</span>(acc_all, <span class="dt">measurevar=</span><span class="st">&quot;Freq&quot;</span>, <span class="dt">groupvars=</span><span class="kw">c</span>(<span class="st">&quot;Cong&quot;</span>))

<span class="co"># Plot accuracy</span>
  EEG_acc_plot=<span class="kw">ggplot</span>(stats_acc_all, <span class="kw">aes</span>(<span class="dt">x=</span>Cong, <span class="dt">y=</span>Freq, <span class="dt">fill =</span> Cong)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.7</span>,<span class="dt">width=</span><span class="fl">0.9</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>Freq<span class="op">-</span>se, <span class="dt">ymax=</span>Freq<span class="op">+</span>se), <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">width=</span><span class="fl">0.2</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span> (<span class="dt">x=</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>nov_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">65</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">60</span>,<span class="dv">20</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span>theme_SN

## Plot separated by emotions

<span class="co"># Select outlier-free data and correct trials</span>
  EEG_task_Acc_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)
  EEG_task_Acc_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_Acc_targ_plot,Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
  
<span class="co"># Recode variable</span>
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span>
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span>
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span>
  
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span>
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span>
  EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span>
  
  EEG_task_Acc_targ_plot<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_targ_plot<span class="op">$</span>Target, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))
  
<span class="co"># Get accuracy for novel and repeated condition</span>
  acc_emo =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID<span class="op">+</span>Target, EEG_task_Acc_targ_plot))
  
<span class="co"># Recode to accuracy in percent (48 happy trials, 49 neutral trials, 47 angry trials)</span>
  acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;happy&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;happy&quot;</span>]<span class="op">/</span><span class="dv">48</span>)<span class="op">*</span><span class="dv">100</span>
  acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;neutral&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;neutral&quot;</span>]<span class="op">/</span><span class="dv">49</span>)<span class="op">*</span><span class="dv">100</span>
  acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;angry&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target<span class="op">==</span><span class="st"> &quot;angry&quot;</span>]<span class="op">/</span><span class="dv">47</span>)<span class="op">*</span><span class="dv">100</span>
  
<span class="co"># Factor condition</span>
  acc_emo<span class="op">$</span>Target =<span class="st"> </span><span class="kw">as.factor</span>(acc_emo<span class="op">$</span>Target)
  
<span class="co"># Calculate descriptives on accuracy</span>
  stats_acc_emo =<span class="st"> </span><span class="kw">summarySE</span>(acc_emo, <span class="dt">measurevar=</span><span class="st">&quot;Freq&quot;</span>, <span class="dt">groupvars=</span><span class="kw">c</span>(<span class="st">&quot;Target&quot;</span>))
  
<span class="co"># Plot accuracy</span>
  EEG_acc_emo_plot=<span class="kw">ggplot</span>(stats_acc_emo, <span class="kw">aes</span>(<span class="dt">x=</span>Target, <span class="dt">y=</span>Freq, <span class="dt">fill =</span> Target)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position=</span><span class="kw">position_dodge</span>(), <span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">0.7</span>,<span class="dt">width=</span><span class="fl">0.9</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>Freq<span class="op">-</span>se, <span class="dt">ymax=</span>Freq<span class="op">+</span>se), <span class="dt">size=</span><span class="dv">1</span>, <span class="dt">width=</span><span class="fl">0.2</span>, <span class="dt">position=</span><span class="kw">position_dodge</span>(.<span class="dv">9</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span> (<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">65</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">60</span>,<span class="dv">20</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>emotion_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span>theme_SN<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.y=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y=</span><span class="kw">element_blank</span>())

<span class="co"># Display plots</span>
  fig_EEG_acc =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(EEG_acc_plot, EEG_acc_emo_plot, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))
  fig_EEG_acc  </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_Acc_plots-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="model-specification" class="section level5 tabset tabset-pills">
<h5><strong>Model specification</strong></h5>
<!-- GLMM model specifications -->
<p><br></p>
<div id="glmm-1-random-effect-structure" class="section level6">
<h6>GLMM 1: Random effect structure</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select outlier-free data</span>
  EEG_task_Acc_glmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)

<span class="co"># Factor random effects</span>
  EEG_task_Acc_glmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_glmm<span class="op">$</span>ID)
  EEG_task_Acc_glmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_glmm<span class="op">$</span>Stim_Type)

<span class="co"># Factor fixed factor congruency</span>
  EEG_task_Acc_glmm<span class="op">$</span>Cong[EEG_task_Acc_glmm<span class="op">$</span>Cong<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span>
  EEG_task_Acc_glmm<span class="op">$</span>Cong[EEG_task_Acc_glmm<span class="op">$</span>Cong<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span>
  EEG_task_Acc_glmm<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_glmm<span class="op">$</span>Cong)

<span class="co"># Set effect coding contrast</span>
  <span class="kw">contrasts</span>(EEG_task_Acc_glmm<span class="op">$</span>Cong) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

## Construct full model

<span class="co"># Create contrast matrix</span>
  mm_EEG_task_Acc =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Cong, EEG_task_Acc_glmm)

<span class="co"># Attach to dataframe</span>
  EEG_task_Acc_glmm =<span class="st"> </span>EEG_task_Acc_glmm
  EEG_task_Acc_glmm[,(<span class="kw">ncol</span>(EEG_task_Acc_glmm)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_Acc_glmm)<span class="op">+</span><span class="dv">2</span>)] =<span class="st"> </span>mm_EEG_task_Acc
  <span class="kw">names</span>(EEG_task_Acc_glmm)[(<span class="kw">ncol</span>(EEG_task_Acc_glmm)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_Acc_glmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Grand Mean&quot;</span>, <span class="st">&quot;Nov_Rep&quot;</span>)

<span class="co"># Build full model</span>
  mod_Acc_EEG.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),
                              <span class="dt">data =</span> EEG_task_Acc_glmm,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                              <span class="dt">family =</span> binomial)

## Check random effect structure (cut-off: 0.005 - 0.001)

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_EEG.glmm1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_EEG.glmm1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

## Likelihood-ratio-testing
  
<span class="co"># ID   </span>
  mod_Acc_EEG.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> EEG_task_Acc_glmm,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)

<span class="co"># Stim Type</span>
  mod_Acc_EEG.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID)  <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> EEG_task_Acc_glmm,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)

<span class="co"># Calculate ANOVAs</span>
  anov_glmm1_glmm2 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_EEG.glmm1,mod_Acc_EEG.glmm2)
  anov_glmm1_glmm3 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_EEG.glmm1,mod_Acc_EEG.glmm3)


<span class="co"># Final model</span>
  mod_Acc_EEG.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type),
                          <span class="dt">data =</span> EEG_task_Acc_glmm,<span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                          <span class="dt">family =</span> binomial)</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotions (<code>Novel vs Repeated</code>). Consequently, we fitted single-trial data to the following model:</p>
<p><code>Response ~ Nov_Rep + scale(Age) + scale(WM) + (1 + Nov_Rep || ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-1-overdispersion" class="section level6">
<h6>GLMM 1: Overdispersion</h6>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assumption check: Appropriate estimation of variance - check for overdispersion</span>
  <span class="kw">overdisp_fun</span>(mod_Acc_EEG.glmm4)</code></pre></div>
<pre><code>  chisq   ratio     rdf       p 
2725.06    0.87 3139.00    1.00 </code></pre>
<hr />
</div>
<div id="glmm-2-random-effect-structure" class="section level6">
<h6>GLMM 2: Random effect structure</h6>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get outlier-free data</span>
  EEG_task_Acc_targ_glmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)

<span class="co"># Rename variables</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">4</span>] =<span class="st"> &quot;hap&quot;</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">5</span>] =<span class="st"> &quot;neu&quot;</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">6</span>] =<span class="st"> &quot;ang&quot;</span>
  
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">7</span>] =<span class="st"> &quot;hap&quot;</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">8</span>] =<span class="st"> &quot;neu&quot;</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">9</span>] =<span class="st"> &quot;ang&quot;</span>

<span class="co"># Create factor, get neutral as baseline</span>
  EEG_task_Acc_targ_glmm<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Target, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neu&quot;</span>,<span class="st">&quot;hap&quot;</span>,<span class="st">&quot;ang&quot;</span>))
  EEG_task_Acc_targ_glmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>ID)
  EEG_task_Acc_targ_glmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Stim_Type)

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Target) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)

## Construct full model

<span class="co"># Add contrast columns</span>
  mm_EEG_task_Acc_targ =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Target, EEG_task_Acc_targ_glmm)

<span class="co"># Attach to dataframe</span>
  EEG_task_Acc_targ_glmm[,(<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_EEG_task_Acc_targ
  <span class="kw">names</span>(EEG_task_Acc_targ_glmm)[(<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_Acc_targ_glmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>)

<span class="co"># Build full model</span>
  mod_Acc_targ.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>ID)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>Stim_Type),
                             <span class="dt">data =</span> EEG_task_Acc_targ_glmm,
                             <span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                             <span class="dt">family =</span> binomial)

## Check random effect structure (cut-off: 0.005 - 0.001)

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_targ.glmm1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_targ.glmm1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)


<span class="co"># Re-build model</span>
  mod_Acc_targ.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM)
                           <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>ID)
                           <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>Stim_Type),
                           <span class="dt">data =</span> EEG_task_Acc_targ_glmm,
                           <span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                           <span class="dt">family =</span> binomial)


<span class="co"># Re-check random structure</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_targ.glmm2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_targ.glmm2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)


## Likelihood-ratio testing

<span class="co"># ID</span>
  mod_Acc_targ.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span>ID)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>Stim_Type),
                             <span class="dt">data =</span> EEG_task_Acc_targ_glmm,
                             <span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                             <span class="dt">family =</span> binomial)
<span class="co"># Stimulus type  </span>
  mod_Acc_targ.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>ID)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>Stim_Type),
                             <span class="dt">data =</span> EEG_task_Acc_targ_glmm,
                             <span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                             <span class="dt">family =</span> binomial)

<span class="co"># Calculate ANOVAs</span>
  anov_glmm2_glmm3 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_targ.glmm2,mod_Acc_targ.glmm3)
  anov_glmm2_glmm4 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_targ.glmm2,mod_Acc_targ.glmm4)


<span class="co"># Final model</span>
  mod_Acc_targ.glmm5 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span>ID)
                             <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang<span class="op">||</span>Stim_Type),
                             <span class="dt">data =</span> EEG_task_Acc_targ_glmm,
                             <span class="dt">control=</span><span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>),
                             <span class="dt">family =</span> binomial)</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 2. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM) + (1 | ,     ID) + (0 + Neu_Hap + Neu_Ang || Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-2-overdispersion" class="section level6">
<h6>GLMM 2: Overdispersion</h6>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Assumption check: Appropriate estimation of variance - check for overdispersion</span>
  <span class="kw">overdisp_fun</span>(mod_Acc_targ.glmm5)</code></pre></div>
<pre><code> chisq  ratio    rdf      p 
2813.2    0.9 3138.0    1.0 </code></pre>
<hr />
</div>
</div>
<div id="results" class="section level5">
<h5><strong>Results</strong></h5>
<!-- Print GLMM results -->
<p>Model results indicated that participants were equally accurate in trials with repeated in comparison to a novel emotion at Face 2. Descriptively, participants showed the highest accuracy when happy faces were presented as Face 2. This difference, however, was not significant in comparison to neutral faces. Similarly, there was no significant difference between angry and neutral facial expressions.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create labels</span>
  labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Novel vs Repeated&quot;</span>,<span class="st">&quot;Age&quot;</span>,<span class="st">&quot;Working memory&quot;</span>, <span class="st">&quot;Neutral vs Happy&quot;</span>, <span class="st">&quot;Neutral vs Angry&quot;</span>)

<span class="co"># Create table</span>
  <span class="kw">tab_model</span>(mod_Acc_EEG.glmm4, mod_Acc_targ.glmm5,
          <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>,
          <span class="dt">pred.labels=</span>labels, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>,
          <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,
          <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>,
          <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">TRUE</span>,
          <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;Face 2 Novelty&quot;</span>,<span class="st">&quot;Face 2 Emotion&quot;</span>) , <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Novelty
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Emotion
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.000
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.913
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.925
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.271
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.246
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.168
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.815
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.02 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
2.69 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.13 <sub>Stim_Type.1</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.18 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.11 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.26
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
3146
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
3146
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.015 / 0.186
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.015 / 0.270
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="reaction-time" class="section level1">
<h1>Reaction time</h1>
<p>We expected children to be slower when Face 1 and Face 2 showed the same emotion (<code>LMM1</code>). Additionally, we expected the lowest reaction times for pairings where happy faces were involved (<code>LMM2</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p><br></p>
<div id="descriptives" class="section level4">
<h4><strong>Descriptives</strong></h4>
<!-- Draw EEG task RT plots -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Plot separated by novel vs repeated trials 

<span class="co"># Choose outlier-free and correct trial data</span>
  EEG_task_RT_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  
  EEG_task_RT_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Rename values for repeated and novel trials </span>
  EEG_task_RT_plot<span class="op">$</span>Cong[EEG_task_RT_plot<span class="op">$</span>Cong<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span>
  EEG_task_RT_plot<span class="op">$</span>Cong[EEG_task_RT_plot<span class="op">$</span>Cong<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span>
  
<span class="co"># Calculate summary</span>
  lb =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(x)
  ub =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x)
  
  sumld =<span class="st"> </span><span class="kw">ddply</span>(EEG_task_RT_plot , <span class="op">~</span><span class="st"> </span>Cong, summarise,
                <span class="dt">mean =</span> <span class="kw">mean</span>(RTs), <span class="dt">median =</span> <span class="kw">median</span>(RTs), <span class="dt">lower =</span> <span class="kw">lb</span>(RTs), <span class="dt">upper =</span> <span class="kw">ub</span>(RTs))

<span class="co"># Plot rainclouds</span>
  EEG_task_RT_rain =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> EEG_task_RT_plot, <span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">x =</span> Cong, <span class="dt">fill =</span> Cong))  <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">18</span>, <span class="dt">y =</span> <span class="dv">0</span>),  <span class="dt">adjust=</span><span class="fl">1.5</span>, <span class="dt">trim=</span><span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">color =</span> Cong), <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">1</span>), <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">x =</span> Cong, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">22</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">22</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">width =</span> <span class="dv">0</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Reaction time [ms]&quot;</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7000</span>,<span class="dv">2000</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">7000</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">name=</span><span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="dv">5</span>, <span class="dt">y =</span> <span class="dv">3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co"># flip or not?</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>nov_col) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>nov_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span>theme_SN <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>())

## Plot separated by emotions

<span class="co"># Choose outlier-free and correct trial data</span>
  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)
  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Choose EEG task data with correct trials</span>
  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Rename variables</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span>

<span class="co"># Set target as factor / Recode target</span>
  EEG_task_RT_targ_plot<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_targ_plot<span class="op">$</span>Target, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Create summary  </span>
  sumld =<span class="st"> </span><span class="kw">ddply</span>(EEG_task_RT_targ_plot , <span class="op">~</span><span class="st"> </span>Target, summarise,
                <span class="dt">mean =</span> <span class="kw">mean</span>(RTs), <span class="dt">median =</span> <span class="kw">median</span>(RTs), <span class="dt">lower =</span> <span class="kw">lb</span>(RTs), <span class="dt">upper =</span> <span class="kw">ub</span>(RTs))

<span class="co"># Plot rainclouds</span>
  EEG_RT_emo_rain =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> EEG_task_RT_targ_plot, <span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">x =</span> Target, <span class="dt">fill =</span> Target))  <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">color =</span> Target), <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> .<span class="dv">1</span>), <span class="dt">size =</span> .<span class="dv">7</span>, <span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">18</span>, <span class="dt">y =</span> <span class="dv">0</span>),  <span class="dt">adjust=</span><span class="fl">1.5</span>, <span class="dt">trim=</span><span class="ot">TRUE</span>, <span class="dt">alpha=</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">x =</span> Target, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">22</span>), <span class="dt">size =</span> <span class="fl">2.5</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> sumld, <span class="kw">aes</span>(<span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper, <span class="dt">y =</span> mean), <span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> .<span class="dv">22</span>, <span class="dt">y =</span> <span class="dv">0</span>), <span class="dt">width =</span> <span class="dv">0</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Reaction time [ms]&quot;</span>,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7000</span>,<span class="dv">2000</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">7000</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="fl">5.00</span>, <span class="dt">y =</span> <span class="dv">1</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co"># flip or not?</span>
<span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>emotion_col) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>emotion_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span>
<span class="st">    </span>theme_SN <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>())
  
<span class="co"># Display plots</span>
  fig_EEG_RT =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(EEG_task_RT_rain, EEG_RT_emo_rain, <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))
  fig_EEG_RT</code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_plots-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="model-specification-1" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<!-- LMM assumption checks -->
<div id="lmm1-random-effect-structure" class="section level5">
<h5>LMM1: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Choose outlier-free data and correct answers    </span>
  EEG_task_RT_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  
  EEG_task_RT_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_lmm, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Recode for repeated and novel trials</span>
  EEG_task_RT_lmm<span class="op">$</span>Cong[EEG_task_RT_lmm<span class="op">$</span>Cong<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span>
  EEG_task_RT_lmm<span class="op">$</span>Cong[EEG_task_RT_lmm<span class="op">$</span>Cong<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span>

<span class="co"># Prepare fixed factors </span>
  EEG_task_RT_lmm<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>Cong)

<span class="co"># Factor ID and stimulus type </span>
  EEG_task_RT_lmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>Stim_Type)
  EEG_task_RT_lmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>ID)

<span class="co"># Define effect coding contrast for novelty </span>
  <span class="kw">contrasts</span>(EEG_task_RT_lmm<span class="op">$</span>Cong) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

<span class="co"># Create contrast matrix </span>
  mm_EEG_task_RT =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Cong, EEG_task_RT_lmm) 

<span class="co"># Attach to dataframe</span>
  EEG_task_RT_lmm[,(<span class="kw">ncol</span>(EEG_task_RT_lmm)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_RT_lmm)<span class="op">+</span><span class="dv">2</span>)] =<span class="st"> </span>mm_EEG_task_RT
  <span class="kw">names</span>(EEG_task_RT_lmm)[(<span class="kw">ncol</span>(EEG_task_RT_lmm)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_RT_lmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Grand Mean&quot;</span>, <span class="st">&quot;Nov_Rep&quot;</span>)            

<span class="co"># Build full model with new names                </span>
  mod_RT_EEG.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span>Stim_Type),                   
                          <span class="dt">data =</span> EEG_task_RT_lmm,<span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

## PCA to check random effect structure (Cut-off: 0.005 - 0.001)

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># 3rd: remove all terms with zero variance --&gt; comprises final model </span>
  mod_RT_EEG.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),                   
                        <span class="dt">data =</span> EEG_task_RT_lmm,<span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># 4th: re-check the model PCA / variance of random factors</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># 5th: Do Likelihood Ratio Test (LRT) - to check whether all random slopes improve the model</span>

<span class="co"># LRT without random slope Nov_Rep for ID</span>
  mod_RT_EEG.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                          </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),                   
                        <span class="dt">data =</span> EEG_task_RT_lmm,<span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_RT_EEG.lmer2,mod_RT_EEG.lmer3)

<span class="co"># LRT without random slope Nov_Rep for Stim_Type</span>
  mod_RT_EEG.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),                   
                          <span class="dt">data =</span> EEG_task_RT_lmm,<span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)
  
<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_RT_EEG.lmer2,mod_RT_EEG.lmer4)


<span class="co"># 6th: remove random slopes which did not improve the model </span>
  mod_RT_EEG.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep  <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),                   
                          <span class="dt">data =</span> EEG_task_RT_lmm,<span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># 7th: re-check the model PCA / variance of random factors</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer5))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer5),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</code></pre></div>
<p>We applied a scaled sum contrast to compare reaction times for novel vs repeated facial expressions. The final model was built as:</p>
<p><code>log(RTs) ~ Nov_Rep + scale(Age) + scale(WM) + ((1 | ID) + (0 + ,     Nov_Rep | ID)) + (1 | Stim_Type)</code></p>
</div>
<div id="lmm1-normality-of-residuals" class="section level5">
<h5>LMM1: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 

<span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data=</span>EEG_task_RT_lmm)
  res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)

  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))

<span class="co"># Check which transformation of DV is suitable</span>

<span class="co"># Calculate box-cox plot</span>
  mod_RT_targ =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data=</span>EEG_task_RT_lmm)
  <span class="kw">boxcox</span>(mod_RT_targ)   </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (with log transform)</span>
  mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data=</span>EEG_task_RT_lmm)
  res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log, <span class="dt">main=</span><span class="st">&quot;QQplot after transformation&quot;</span>)    
  norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main=</span><span class="st">&quot;Density plot after transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm1-homoscedasticity" class="section level5">
<h5>LMM1: Homoscedasticity</h5>
<p>Based on the figure, we assume homoscedasticity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity</span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_RT_EEG.lmer5), <span class="kw">residuals</span>(mod_RT_EEG.lmer5))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="lmm2-random-effect-structure" class="section level5">
<h5>LMM2: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Choose outlier-free data and correct answers          </span>
  EEG_task_RT_targ_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
  EEG_task_RT_targ_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_lmm,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  

<span class="co"># Rename variables </span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">4</span>] =<span class="st"> &quot;hap&quot;</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">5</span>] =<span class="st"> &quot;neu&quot;</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">6</span>] =<span class="st"> &quot;ang&quot;</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">7</span>] =<span class="st"> &quot;hap&quot;</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">8</span>] =<span class="st"> &quot;neu&quot;</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target<span class="op">==</span><span class="dv">9</span>] =<span class="st"> &quot;ang&quot;</span>

<span class="co"># Create factors, define neutral as baseline</span>
  EEG_task_RT_targ_lmm<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Target, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neu&quot;</span>,<span class="st">&quot;hap&quot;</span>,<span class="st">&quot;ang&quot;</span>))
  EEG_task_RT_targ_lmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>ID)
  EEG_task_RT_targ_lmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Stim_Type)

<span class="co"># Create contrast for emotion</span>
  <span class="kw">contrasts</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Target) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">1</span>)

<span class="co"># Add contrast columns</span>
  mm_EEG_task_RT_targ =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Target, EEG_task_RT_targ_lmm) 

<span class="co"># Attach to dataframe</span>
  EEG_task_RT_targ_lmm[,(<span class="kw">ncol</span>(EEG_task_RT_targ_lmm)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_RT_targ_lmm)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_EEG_task_RT_targ
  <span class="kw">names</span>(EEG_task_RT_targ_lmm)[(<span class="kw">ncol</span>(EEG_task_RT_targ_lmm)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_RT_targ_lmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)    

## Define model 
  mod_RT_targ.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>
<span class="st">                             </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                             </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                             </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                           <span class="dt">data =</span> EEG_task_RT_targ_lmm,
                           <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># 3rd: remove all terms with zero variance --&gt; comprises final model</span>
  mod_RT_targ.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>
<span class="st">                           </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                           </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                           </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                         <span class="dt">data =</span> EEG_task_RT_targ_lmm,
                         <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># 4th: re-check the model PCA / variance of random factors</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># 5th: Likelihood-ratio-testing</span>
<span class="co"># Stim Type</span>
  mod_RT_targ.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>
<span class="st">                           </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                           </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                           </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),
                         <span class="dt">data =</span> EEG_task_RT_targ_lmm,
                         <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)

<span class="co"># Calculate ANOVA  </span>
  <span class="kw">anova</span>(mod_RT_targ.lmer2,mod_RT_targ.lmer3)


<span class="co"># Re-check the model PCA / variance of random factors</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer3))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer3),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 2. we applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>log(RTs) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm2-normality-of-residuals" class="section level5">
<h5>LMM2: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 

<span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data=</span>EEG_task_RT_lmm)
  res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))

<span class="co"># Check which transformation of DV is suitable </span>

<span class="co"># Calculate box-cox plot</span>
  mod_resp =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data=</span>EEG_task_RT_targ_lmm)
  <span class="kw">boxcox</span>(mod_resp)   </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (with log transform)</span>
  mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data=</span>EEG_task_RT_targ_lmm)
  res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log,<span class="dt">main=</span><span class="st">&quot;QQplot after transformation&quot;</span>)    
  norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main=</span><span class="st">&quot;Density plot after transformation&quot;</span>)</code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm2-homoscedasticity" class="section level5">
<h5>LMM2: Homoscedasticity</h5>
<p>Based on the figure, we assume homoscedasticity.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity</span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_RT_targ.lmer2), <span class="kw">residuals</span>(mod_RT_targ.lmer3))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)    </code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="results-1" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print LMM results -->
<p>Contrary to our hypothesis, we did not find a significant main effect of novelty. Children seemed to be equally fast in detecting novel and repeated facial expression. Trials in which the emotion happy was presented as Face 2 were detected significantly faster compared to neutral faces. No difference between angry and neutral as Face 2 could be found.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create table</span>
  <span class="kw">tab_model</span>(mod_RT_EEG.lmer5, mod_RT_targ.lmer3,
          <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>,
          <span class="dt">pred.labels=</span>labels,
          <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>,
          <span class="dt">show.se=</span><span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,
          <span class="dt">show.stat=</span><span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>,
          <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, 
          <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">TRUE</span>,
          <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;Face 2 Novelty&quot;</span>,<span class="st">&quot;Face 2 Emotion&quot;</span>) , <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Novelty
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Emotion
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.284
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.452
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.450
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.169
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.164
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.006</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.363
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.36
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.01 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.24
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2361
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2361
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.022 / 0.041
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.019 / 0.254
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get session info </span>
  <span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>R version 3.6.2 (2019-12-12)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 16299)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.0        stringr_1.4.0        purrr_0.3.4         
 [4] readr_1.3.1          tidyr_1.0.2          tibble_3.0.1        
 [7] tidyverse_1.3.0      sjlabelled_1.1.3     sjmisc_2.8.4        
[10] sjPlot_2.8.3         Rmisc_1.5            plyr_1.8.6          
[13] reshape2_1.4.4       psych_1.9.12.31      MASS_7.3-51.5       
[16] lmerTest_3.1-2       lme4_1.1-23          Matrix_1.2-18       
[19] Hmisc_4.4-0          Formula_1.2-3        survival_3.1-8      
[22] lattice_0.20-38      ggstatsplot_0.4.0    ez_4.4-0            
[25] EnvStats_2.3.1       eeptools_1.2.2       ggplot2_3.3.0       
[28] dplyr_0.8.5          cowplot_1.0.0        table1_1.2          
[31] miceadds_3.9-14      mice_3.9.0           rmdformats_0.3.7    
[34] XLConnectJars_0.2-15 XLConnect_1.0.1      kableExtra_1.1.0    

loaded via a namespace (and not attached):
 [1] estimability_1.3       coda_0.19-3            acepack_1.4.1         
 [4] knitr_1.28             multcomp_1.4-13        data.table_1.12.8     
 [7] rpart_4.1-15           inline_0.3.15          generics_0.0.2        
[10] callr_3.4.3            TH.data_1.0-10         correlation_0.2.0     
[13] lubridate_1.7.8        webshot_0.5.2          xml2_1.3.1            
[16] httpuv_1.5.2           StanHeaders_2.21.0-1   assertthat_0.2.1      
[19] WRS2_1.0-0             xfun_0.13              hms_0.5.3             
[22] rJava_0.9-12           evaluate_0.14          promises_1.1.0        
[25] tidyBF_0.2.0           fansi_0.4.1            dbplyr_1.4.3          
[28] readxl_1.3.1           htmlwidgets_1.5.1      DBI_1.1.0             
[31] reshape_0.8.8          stats4_3.6.2           paletteer_1.1.0       
[34] ellipsis_0.3.0         rcompanion_2.3.25      backports_1.1.6       
[37] bookdown_0.18          insight_0.8.3          ggcorrplot_0.1.3      
[40] libcoin_1.0-5          jmvcore_1.2.5          vctrs_0.2.4           
[43] abind_1.4-5            withr_2.2.0            metaBMA_0.6.2         
[46] checkmate_2.0.0        bdsmatrix_1.3-4        emmeans_1.4.6         
[49] vcd_1.4-7              prettyunits_1.1.1      mnormt_1.5-6          
[52] fastGHQuad_1.0         cluster_2.1.0          crayon_1.3.4          
[55] pkgconfig_2.0.3        nlme_3.1-147           statsExpressions_0.4.1
[58] palr_0.2.0             nnet_7.3-12            pals_1.6              
[61] rlang_0.4.5            lifecycle_0.2.0        miniUI_0.1.1.1        
[64] groupedstats_0.2.2     skimr_2.1.1            LaplacesDemon_16.1.4  
[67] MatrixModels_0.4-1     sandwich_2.5-1         EMT_1.1               
[70] modelr_0.1.6           dichromat_2.0-0        cellranger_1.1.0      
[73] matrixStats_0.56.0     broomExtra_4.0.0       lmtest_0.9-37         
 [ reached getOption(&quot;max.print&quot;) -- omitted 109 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
