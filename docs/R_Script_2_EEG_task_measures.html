<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>Delayed matched-to-sample task</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">Delayed matched-to-sample task</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#task-description">Task description</a></li>
        <li><a href="#accuracy">Accuracy</a></li>
        <li><a href="#reaction-times">Reaction times</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Del. matched-to-sample task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load data set-->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>Our EEG paradigm included a delayed same-different matching task in which children had do indicate whether Face 1 and Face 2 showed the same (<code>repeated</code>) or a different emotional facial expression (<code>novel</code>). We measured participantsâ€™ accuracy rates and reaction times.</p>
<p>We excluded:</p>
<ul>
<li>Reaction times &lt; 250 ms or &gt; 7s</li>
<li>Values &lt;/&gt; 2.5 of the median absolute deviation (MAD) based on the individual participant</li>
<li>Incorrect answers</li>
<li>Rejected EEG trials</li>
</ul>
<p>We calculated general linear mixed models (GLMM) for accuracy rates and linear mixed models (LMM) for reaction times. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all (general) linear mixed model analyses to control for cognitive abilities of the children as well as potential differences in age.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
</div>
<div id="accuracy" class="section level1">
<h1>Accuracy</h1>
<p>We predicted that children would be less accurate when Face 1 and Face 2 were repeated (<code>GLMM 1</code>). We also expected the highest accuracy rates for pairings where happy faces were involved (<code>GLMM 2</code>).</p>
<p><br></p>
<div id="descriptive-statistics" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Draw EEG task accuracy plots -->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co"># Select outlier-free data and correct trials</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a>EEG_task_Acc_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>EEG_task_Acc_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_Acc_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="co">## Plot separated by novel vs repeated trials</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a><span class="co"># Recode variable</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a>EEG_task_Acc_plot<span class="op">$</span>Cong[EEG_task_Acc_plot<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>EEG_task_Acc_plot<span class="op">$</span>Cong[EEG_task_Acc_plot<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co"># Get accuracy for novel and repeated condition</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>acc_all =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID <span class="op">+</span><span class="st"> </span>Cong, EEG_task_Acc_plot))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a><span class="co"># Recode to accuracy in percent (72 novel trials, 72 repeated trials)</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a>acc_all<span class="op">$</span>Freq =<span class="st"> </span>(acc_all<span class="op">$</span>Freq<span class="op">/</span><span class="dv">72</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a><span class="co"># Factor condition</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a>acc_all<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">as.factor</span>(acc_all<span class="op">$</span>Cong)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a><span class="co"># Calculate descriptives on accuracy</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a>stats_acc_all =<span class="st"> </span><span class="kw">summarySEwithin</span>(acc_all, <span class="dt">measurevar =</span> <span class="st">&quot;Freq&quot;</span>, <span class="dt">withinvars =</span> <span class="kw">c</span>(<span class="st">&quot;Cong&quot;</span>), </span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>    <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a><span class="co"># Plot accuracy</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a>EEG_acc_plot =<span class="st"> </span><span class="kw">ggplot</span>(stats_acc_all, <span class="kw">aes</span>(<span class="dt">x =</span> Cong, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> Cong)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), </span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a>    <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>, <span class="dt">width =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Freq <span class="op">-</span><span class="st"> </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a><span class="st">    </span>se, <span class="dt">ymax =</span> Freq <span class="op">+</span><span class="st"> </span>se), <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> nov_col) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>    <span class="dv">65</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>theme_SN</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a><span class="co">## Plot separated by emotions</span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a><span class="co"># Select outlier-free data and correct trials</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a>EEG_task_Acc_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>EEG_task_Acc_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_Acc_targ_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a><span class="co"># Recode variable</span></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target[EEG_task_Acc_targ_plot<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a>EEG_task_Acc_targ_plot<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_targ_plot<span class="op">$</span>Target, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a><span class="co"># Get accuracy for novel and repeated condition</span></span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a>acc_emo =<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span>ID <span class="op">+</span><span class="st"> </span>Target, EEG_task_Acc_targ_plot))</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a><span class="co"># Recode to accuracy in percent (48 happy trials, 49 neutral trials, 47 angry</span></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a><span class="co"># trials)</span></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a>acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;happy&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;happy&quot;</span>]<span class="op">/</span><span class="dv">48</span>) <span class="op">*</span><span class="st"> </span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a><span class="st">    </span><span class="dv">100</span></span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a>acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>]<span class="op">/</span><span class="dv">49</span>) <span class="op">*</span><span class="st"> </span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a><span class="st">    </span><span class="dv">100</span></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a>acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;angry&quot;</span>] =<span class="st"> </span>(acc_emo<span class="op">$</span>Freq[acc_emo<span class="op">$</span>Target <span class="op">==</span><span class="st"> &quot;angry&quot;</span>]<span class="op">/</span><span class="dv">47</span>) <span class="op">*</span><span class="st"> </span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a><span class="st">    </span><span class="dv">100</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a><span class="co"># Factor condition</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a>acc_emo<span class="op">$</span>Target =<span class="st"> </span><span class="kw">as.factor</span>(acc_emo<span class="op">$</span>Target)</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a><span class="co"># Calculate descriptives on accuracy</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a>stats_acc_emo =<span class="st"> </span><span class="kw">summarySEwithin</span>(acc_emo, <span class="dt">measurevar =</span> <span class="st">&quot;Freq&quot;</span>, <span class="dt">withinvars =</span> <span class="kw">c</span>(<span class="st">&quot;Target&quot;</span>), </span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a>    <span class="dt">idvar =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a><span class="co"># Plot accuracy</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a>EEG_acc_emo_plot =<span class="st"> </span><span class="kw">ggplot</span>(stats_acc_emo, <span class="kw">aes</span>(<span class="dt">x =</span> Target, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> Target)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="kw">position_dodge</span>(), <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="fl">0.7</span>, </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a>        <span class="dt">width =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin =</span> Freq <span class="op">-</span><span class="st"> </span>se, <span class="dt">ymax =</span> Freq <span class="op">+</span><span class="st"> </span>se), <span class="dt">size =</span> <span class="dv">1</span>, </span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a>    <span class="dt">width =</span> <span class="fl">0.2</span>, <span class="dt">position =</span> <span class="kw">position_dodge</span>(<span class="fl">0.9</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Accuracy [%]&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">65</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">60</span>, <span class="dv">20</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>() <span class="op">+</span><span class="st"> </span>theme_SN <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a>    <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a><span class="co"># Display plots</span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a>fig_EEG_acc =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(EEG_acc_plot, EEG_acc_emo_plot, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">rel_widths =</span> <span class="kw">c</span>(<span class="dv">1</span>, </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a>    <span class="dv">1</span>))</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a>fig_EEG_acc</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_Acc_plots-1.png" width="576" style="display: block; margin: auto;" /></p>
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills"><strong>Model specification</strong></h4>
<!-- GLMM model specifications -->
<p><br></p>
<div id="glmm-1-random-effect-structure" class="section level5">
<h5>GLMM 1: Random effect structure</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Select outlier-free data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>EEG_task_Acc_glmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a><span class="co"># Factor random effects</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>EEG_task_Acc_glmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_glmm<span class="op">$</span>ID)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a>EEG_task_Acc_glmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_glmm<span class="op">$</span>Stim_Type)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a><span class="co"># Factor fixed factor congruency</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>EEG_task_Acc_glmm<span class="op">$</span>Cong[EEG_task_Acc_glmm<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>EEG_task_Acc_glmm<span class="op">$</span>Cong[EEG_task_Acc_glmm<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a>EEG_task_Acc_glmm<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_glmm<span class="op">$</span>Cong)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a><span class="co"># Set effect coding contrast</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a><span class="kw">contrasts</span>(EEG_task_Acc_glmm<span class="op">$</span>Cong) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a><span class="co">## Construct full model</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a><span class="co"># Create contrast matrix</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a>mm_EEG_task_Acc =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Cong, EEG_task_Acc_glmm)</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a>EEG_task_Acc_glmm =<span class="st"> </span>EEG_task_Acc_glmm</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a>EEG_task_Acc_glmm[, (<span class="kw">ncol</span>(EEG_task_Acc_glmm) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_Acc_glmm) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)] =<span class="st"> </span>mm_EEG_task_Acc</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="kw">names</span>(EEG_task_Acc_glmm)[(<span class="kw">ncol</span>(EEG_task_Acc_glmm) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_Acc_glmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Grand Mean&quot;</span>, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a>    <span class="st">&quot;Nov_Rep&quot;</span>)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a>mod_Acc_EEG.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a><span class="co">## Check random effect structure (cut-off: 0.005 - 0.001)</span></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_EEG.glmm1))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_EEG.glmm1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a><span class="co"># Adapt model</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a>mod_Acc_EEG.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a></span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_EEG.glmm2))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a></span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_EEG.glmm2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a><span class="co">## Likelihood-ratio-testing</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a>mod_Acc_EEG.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true"></a></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true"></a><span class="co"># Stim Type</span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true"></a>mod_Acc_EEG.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true"></a></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true"></a><span class="co"># Calculate ANOVAs</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true"></a>anov_glmm1_glmm2_<span class="dv">3</span> =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_EEG.glmm2, mod_Acc_EEG.glmm3)</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true"></a>anov_glmm1_glmm2_<span class="dv">4</span> =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_EEG.glmm2, mod_Acc_EEG.glmm4)</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true"></a></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true"></a>mod_Acc_EEG.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotions (<code>Novel vs Repeated</code>). Consequently, we fitted single-trial data to the following model:</p>
<p><code>Response ~ Nov_Rep + scale(Age) + scale(WM) + (1 + Nov_Rep || ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-1-overdispersion" class="section level5">
<h5>GLMM 1: Overdispersion</h5>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Assumption check: Appropriate estimation of variance - check for overdispersion</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">overdisp_fun</span>(mod_Acc_EEG.glmm4)</span></code></pre></div>
<pre><code>  chisq   ratio     rdf       p 
2259.43    0.86 2624.00    1.00 </code></pre>
<hr />
</div>
<div id="glmm-2-random-effect-structure" class="section level5">
<h5>GLMM 2: Random effect structure</h5>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="co"># Get outlier-free data</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true"></a>EEG_task_Acc_targ_glmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;hap&quot;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neu&quot;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;ang&quot;</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;hap&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neu&quot;</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target[EEG_task_Acc_targ_glmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;ang&quot;</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Target, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neu&quot;</span>, </span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true"></a>    <span class="st">&quot;hap&quot;</span>, <span class="st">&quot;ang&quot;</span>))</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>ID)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true"></a>EEG_task_Acc_targ_glmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Stim_Type)</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true"></a><span class="kw">contrasts</span>(EEG_task_Acc_targ_glmm<span class="op">$</span>Target) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true"></a></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true"></a><span class="co">## Construct full model</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true"></a></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true"></a>mm_EEG_task_Acc_targ =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Target, EEG_task_Acc_targ_glmm)</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true"></a></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true"></a>EEG_task_Acc_targ_glmm[, (<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true"></a><span class="st">    </span><span class="dv">3</span>)] =<span class="st"> </span>mm_EEG_task_Acc_targ</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true"></a><span class="kw">names</span>(EEG_task_Acc_targ_glmm)[(<span class="kw">ncol</span>(EEG_task_Acc_targ_glmm) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_Acc_targ_glmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true"></a>    <span class="st">&quot;Neu_Hap&quot;</span>, <span class="st">&quot;Neu_Ang&quot;</span>)</span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true"></a></span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true"></a><span class="co"># Build full model</span></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true"></a>mod_Acc_targ.glmm1 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_targ_glmm, </span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)</span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true"></a></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true"></a><span class="co">## Check random effect structure (cut-off: 0.005 - 0.001)</span></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true"></a></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_targ.glmm1))</span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true"></a></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_targ.glmm1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true"></a></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true"></a></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true"></a><span class="co"># Re-build model</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true"></a>mod_Acc_targ.glmm2 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_targ_glmm, </span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)</span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true"></a></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true"></a><span class="co"># Re-check random structure</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_Acc_targ.glmm2))</span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_Acc_targ.glmm2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true"></a></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true"></a><span class="co">## Likelihood-ratio testing</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true"></a></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true"></a>mod_Acc_targ.glmm3 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_targ_glmm, </span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)</span>
<span id="cb5-65"><a href="#cb5-65" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
<span id="cb5-66"><a href="#cb5-66" aria-hidden="true"></a>mod_Acc_targ.glmm4 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-67"><a href="#cb5-67" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_targ_glmm, <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb5-68"><a href="#cb5-68" aria-hidden="true"></a>    <span class="dt">family =</span> binomial)</span>
<span id="cb5-69"><a href="#cb5-69" aria-hidden="true"></a></span>
<span id="cb5-70"><a href="#cb5-70" aria-hidden="true"></a><span class="co"># Calculate ANOVAs</span></span>
<span id="cb5-71"><a href="#cb5-71" aria-hidden="true"></a>anov_glmm2_glmm3 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_targ.glmm2, mod_Acc_targ.glmm3)</span>
<span id="cb5-72"><a href="#cb5-72" aria-hidden="true"></a>anov_glmm2_glmm4 =<span class="st"> </span><span class="kw">anova</span>(mod_Acc_targ.glmm2, mod_Acc_targ.glmm4)</span>
<span id="cb5-73"><a href="#cb5-73" aria-hidden="true"></a></span>
<span id="cb5-74"><a href="#cb5-74" aria-hidden="true"></a></span>
<span id="cb5-75"><a href="#cb5-75" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb5-76"><a href="#cb5-76" aria-hidden="true"></a>mod_Acc_targ.glmm5 =<span class="st"> </span><span class="kw">glmer</span>(Response <span class="op">~</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb5-77"><a href="#cb5-77" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Neu_Hap <span class="op">+</span><span class="st"> </span>Neu_Ang <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_Acc_targ_glmm, </span>
<span id="cb5-78"><a href="#cb5-78" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">glmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">family =</span> binomial)</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 2. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM) + (1 | ,     ID) + (0 + Neu_Hap + Neu_Ang || Stim_Type)</code></p>
<hr />
</div>
<div id="glmm-2-overdispersion" class="section level5">
<h5>GLMM 2: Overdispersion</h5>
<p>If the p-value is &lt; 0.05, data would be overdispersed. Here p &gt; 0.05. Hence, overdispersion is not a problem.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Assumption check: Appropriate estimation of variance - check for overdispersion</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">overdisp_fun</span>(mod_Acc_targ.glmm5)</span></code></pre></div>
<pre><code>  chisq   ratio     rdf       p 
2340.25    0.89 2623.00    1.00 </code></pre>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print GLMM results -->
<p>Participants were equally accurate in trials with repeated in comparison to novel emotions at Face 2. We built an additional GLMM separated by emotions of Face 2 (average across repeated / novel trials) to identify potential matching differences elicited by emotion. We found no significant differences for happy facial expression in comparison to neutral facial expressions. Similarly, there was no significant difference between angry and neutral faces presented as Face 2</p>
<div align="center">


<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co"># Create labels</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Novel vs Repeated&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working memory&quot;</span>, <span class="st">&quot;Neutral vs Happy&quot;</span>, <span class="st">&quot;Neutral vs Angry&quot;</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_Acc_EEG.glmm4, mod_Acc_targ.glmm5, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, <span class="dt">pred.labels =</span> labels, </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true"></a>    <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true"></a>    <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Face 2 Novelty&quot;</span>, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true"></a>        <span class="st">&quot;Face 2 Emotion&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Novelty
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Emotion
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.944
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.955
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.916
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.80
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.312
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.276
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.269
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.13
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.45
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.652
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
3.29
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.21 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
2.69 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.06 <sub>Stim_Type.1</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.18 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.12 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.26
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.012 / 0.180
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.012 / 0.274
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="reaction-times" class="section level1">
<h1>Reaction times</h1>
<p>We expected children to be slower when Face 1 and Face 2 showed the same emotion (<code>LMM1</code>). Additionally, we expected the lowest reaction times for pairings where happy faces were involved (<code>LMM2</code>). Assumptions for multiple regression were checked for all models (normality of the residuals, linearity, multicollinearity, homoscedasticity).</p>
<p><br></p>
<div id="descriptives" class="section level4">
<h4><strong>Descriptives</strong></h4>
<!-- Draw EEG task RT plots -->
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co">## Plot separated by novel vs repeated trials </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a><span class="co"># Choose outlier-free and correct trial data</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a>  EEG_task_RT_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a>  EEG_task_RT_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a><span class="co"># Rename values for repeated and novel trials </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true"></a>  EEG_task_RT_plot<span class="op">$</span>Cong[EEG_task_RT_plot<span class="op">$</span>Cong<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true"></a>  EEG_task_RT_plot<span class="op">$</span>Cong[EEG_task_RT_plot<span class="op">$</span>Cong<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true"></a>  </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true"></a><span class="co"># Calculate summary</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true"></a>  lb =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true"></a>  ub =<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">mean</span>(x) <span class="op">+</span><span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true"></a>  </span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true"></a>  sumld =<span class="st"> </span><span class="kw">ddply</span>(EEG_task_RT_plot , <span class="op">~</span><span class="st"> </span>Cong, summarise,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true"></a>                <span class="dt">mean =</span> <span class="kw">mean</span>(RTs), <span class="dt">median =</span> <span class="kw">median</span>(RTs), <span class="dt">lower =</span> <span class="kw">lb</span>(RTs), <span class="dt">upper =</span> <span class="kw">ub</span>(RTs))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true"></a><span class="co"># Plot rainclouds</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true"></a>  EEG_task_RT_rain =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> EEG_task_RT_plot, <span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">x =</span> Cong, <span class="dt">fill =</span> Cong))  <span class="op">+</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.18</span>, <span class="dt">y =</span> <span class="dv">0</span>),  <span class="dt">adjust=</span><span class="fl">1.5</span>, <span class="dt">trim=</span><span class="ot">TRUE</span>, <span class="dt">alpha =</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">color =</span> Cong), <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.1</span>), <span class="dt">size =</span> <span class="fl">.3</span>, <span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">.1</span>, <span class="dt">guides =</span> <span class="ot">FALSE</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Reaction time [ms]&quot;</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7000</span>,<span class="dv">2000</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">7000</span>))<span class="op">+</span></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_discrete</span>(<span class="dt">name=</span><span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true"></a><span class="st">    </span><span class="kw">expand_limits</span>(<span class="dt">x =</span><span class="dv">1</span>, <span class="dt">y =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co"># flip or not?</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>nov_col) <span class="op">+</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>nov_col)<span class="op">+</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true"></a><span class="st">    </span>theme_SN <span class="op">+</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true"></a><span class="co">## Plot separated by emotions</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true"></a><span class="co"># Choose outlier-free and correct trial data</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true"></a>  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data,Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true"></a>  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true"></a><span class="co"># Choose EEG task data with correct trials</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true"></a>  EEG_task_RT_targ_plot =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_plot, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true"></a></span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">4</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">5</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">6</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">7</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">8</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target[EEG_task_RT_targ_plot<span class="op">$</span>Target<span class="op">==</span><span class="dv">9</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true"></a><span class="co"># Set target as factor / Recode target</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true"></a>  EEG_task_RT_targ_plot<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_targ_plot<span class="op">$</span>Target, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true"></a></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true"></a><span class="co"># Create summary  </span></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true"></a>  sumld =<span class="st"> </span><span class="kw">ddply</span>(EEG_task_RT_targ_plot , <span class="op">~</span><span class="st"> </span>Target, summarise,</span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true"></a>                <span class="dt">mean =</span> <span class="kw">mean</span>(RTs), <span class="dt">median =</span> <span class="kw">median</span>(RTs), <span class="dt">lower =</span> <span class="kw">lb</span>(RTs), <span class="dt">upper =</span> <span class="kw">ub</span>(RTs))</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true"></a></span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true"></a><span class="co"># Plot rainclouds</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true"></a>  EEG_RT_emo_rain =<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> EEG_task_RT_targ_plot, <span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">x =</span> Target, <span class="dt">fill =</span> Target))  <span class="op">+</span></span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">y =</span> RTs, <span class="dt">color =</span> Target), <span class="dt">shape =</span> <span class="dv">19</span>, <span class="dt">position =</span> <span class="kw">position_jitter</span>(<span class="dt">width =</span> <span class="fl">.1</span>), <span class="dt">size =</span> <span class="fl">.3</span>, <span class="dt">alpha =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_flat_violin</span>(<span class="dt">position =</span> <span class="kw">position_nudge</span>(<span class="dt">x =</span> <span class="fl">.18</span>, <span class="dt">y =</span> <span class="dv">0</span>),  <span class="dt">adjust=</span><span class="fl">1.5</span>, <span class="dt">trim=</span><span class="ot">TRUE</span>, <span class="dt">alpha=</span> <span class="dv">1</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>(<span class="dt">width =</span> <span class="fl">.1</span>, <span class="dt">guides =</span> <span class="ot">FALSE</span>, <span class="dt">outlier.shape =</span> <span class="ot">NA</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">name=</span><span class="st">&quot;Reaction time [ms]&quot;</span>, <span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">7000</span>,<span class="dv">2000</span>), <span class="dt">limits=</span><span class="kw">c</span>(<span class="dv">250</span>,<span class="dv">7000</span>))<span class="op">+</span></span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true"></a><span class="st">    </span><span class="kw">expand_limits</span>(<span class="dt">x =</span> <span class="fl">1.00</span>, <span class="dt">y =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true"></a><span class="st">    </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st"> </span><span class="co"># flip or not?</span></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_manual</span>(<span class="dt">values=</span>emotion_col) <span class="op">+</span></span>
<span id="cb9-69"><a href="#cb9-69" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_manual</span>(<span class="dt">values=</span>emotion_col)<span class="op">+</span></span>
<span id="cb9-70"><a href="#cb9-70" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_bw</span>()<span class="op">+</span></span>
<span id="cb9-71"><a href="#cb9-71" aria-hidden="true"></a><span class="st">    </span>theme_SN <span class="op">+</span></span>
<span id="cb9-72"><a href="#cb9-72" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major.y =</span> <span class="kw">element_blank</span>())</span>
<span id="cb9-73"><a href="#cb9-73" aria-hidden="true"></a>  </span>
<span id="cb9-74"><a href="#cb9-74" aria-hidden="true"></a><span class="co"># Display plots</span></span>
<span id="cb9-75"><a href="#cb9-75" aria-hidden="true"></a>  fig_EEG_RT =<span class="st"> </span>cowplot<span class="op">::</span><span class="kw">plot_grid</span>(EEG_task_RT_rain, EEG_RT_emo_rain,</span>
<span id="cb9-76"><a href="#cb9-76" aria-hidden="true"></a>                                  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>),</span>
<span id="cb9-77"><a href="#cb9-77" aria-hidden="true"></a>                                  <span class="dt">ncol=</span><span class="dv">2</span>, <span class="dt">rel_widths=</span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-78"><a href="#cb9-78" aria-hidden="true"></a>  fig_EEG_RT</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_plots-1.png" width="576" style="display: block; margin: auto;" /> <br></p>
</div>
<div id="model-specification-1" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills"><strong>Model specification</strong></h4>
<!-- LMM assumption checks -->
<div id="lmm1-random-effect-structure" class="section level5">
<h5>LMM1: Random effect structure</h5>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="co"># Choose outlier-free data and correct answers</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true"></a>EEG_task_RT_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true"></a>EEG_task_RT_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_lmm, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true"></a><span class="co"># Recode for repeated and novel trials</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true"></a>EEG_task_RT_lmm<span class="op">$</span>Cong[EEG_task_RT_lmm<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true"></a>EEG_task_RT_lmm<span class="op">$</span>Cong[EEG_task_RT_lmm<span class="op">$</span>Cong <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true"></a>EEG_task_RT_lmm<span class="op">$</span>Cong =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>Cong)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true"></a><span class="co"># Factor ID and stimulus type</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true"></a>EEG_task_RT_lmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>Stim_Type)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true"></a>EEG_task_RT_lmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_lmm<span class="op">$</span>ID)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true"></a><span class="co"># Define effect coding contrast for novelty</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true"></a><span class="kw">contrasts</span>(EEG_task_RT_lmm<span class="op">$</span>Cong) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true"></a></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true"></a><span class="co"># Create contrast matrix</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true"></a>mm_EEG_task_RT =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Cong, EEG_task_RT_lmm)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true"></a></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true"></a>EEG_task_RT_lmm[, (<span class="kw">ncol</span>(EEG_task_RT_lmm) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_RT_lmm) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)] =<span class="st"> </span>mm_EEG_task_RT</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true"></a><span class="kw">names</span>(EEG_task_RT_lmm)[(<span class="kw">ncol</span>(EEG_task_RT_lmm) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_RT_lmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Grand Mean&quot;</span>, </span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true"></a>    <span class="st">&quot;Nov_Rep&quot;</span>)</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true"></a></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true"></a><span class="co"># Build full model with new names</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true"></a>mod_RT_EEG.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true"></a></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true"></a><span class="co">## PCA to check random effect structure (Cut-off: 0.005 - 0.001)</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true"></a></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer1))</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true"></a></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true"></a></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true"></a><span class="co"># 3rd: remove all terms with zero variance --&gt; comprises final model</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true"></a>mod_RT_EEG.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true"></a></span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true"></a><span class="co"># 4th: re-check the model PCA / variance of random factors</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer2))</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true"></a></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true"></a><span class="co"># 5th: Do Likelihood Ratio Test (LRT) - to check whether all random slopes</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true"></a><span class="co"># improve the model</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true"></a></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true"></a><span class="co"># LRT without random slope Nov_Rep for ID</span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true"></a>mod_RT_EEG.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true"></a></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true"></a><span class="kw">anova</span>(mod_RT_EEG.lmer2, mod_RT_EEG.lmer3)</span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true"></a></span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true"></a><span class="co"># LRT without random slope Nov_Rep for Stim_Type</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true"></a>mod_RT_EEG.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true"></a></span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true"></a><span class="kw">anova</span>(mod_RT_EEG.lmer2, mod_RT_EEG.lmer4)</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true"></a></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true"></a></span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true"></a><span class="co"># 6th: remove random slopes which did not improve the model</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true"></a>mod_RT_EEG.lmer5 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true"></a></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true"></a><span class="co"># 7th: re-check the model PCA / variance of random factors</span></span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_EEG.lmer5))</span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_EEG.lmer5), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span></code></pre></div>
<p>We applied a scaled sum contrast to compare reaction times for novel vs repeated facial expressions. The final model was built as:</p>
<p><code>log(RTs) ~ Nov_Rep + scale(Age) + scale(WM) + ((1 | ID) + (0 + ,     Nov_Rep | ID)) + (1 | Stim_Type)</code></p>
</div>
<div id="lmm1-normality-of-residuals" class="section level5">
<h5>LMM1: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true"></a>mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data =</span> EEG_task_RT_lmm)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true"></a>res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true"></a>qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true"></a>norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a><span class="co"># Check which transformation of DV is suitable</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a><span class="co"># Calculate box-cox plot</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>mod_RT_targ =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data =</span> EEG_task_RT_lmm)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a><span class="kw">boxcox</span>(mod_RT_targ)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (with log transform)</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Cong, <span class="dt">data =</span> EEG_task_RT_lmm)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a>res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true"></a>qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log, <span class="dt">main =</span> <span class="st">&quot;QQplot after transformation&quot;</span>)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true"></a>norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main =</span> <span class="st">&quot;Density plot after transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_normres-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm1-homoscedasticity" class="section level5">
<h5>LMM1: Homoscedasticity</h5>
<p>Based on the figure, we assume homoscedasticity.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_RT_EEG.lmer5), <span class="kw">residuals</span>(mod_RT_EEG.lmer5))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
<div id="lmm2-random-effect-structure" class="section level5">
<h5>LMM2: Random effect structure</h5>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co"># Choose outlier-free data and correct answers</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a>EEG_task_RT_targ_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a>EEG_task_RT_targ_lmm =<span class="st"> </span><span class="kw">subset</span>(EEG_task_RT_targ_lmm, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true"></a><span class="st">    </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>EEG_trial_loss <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true"></a><span class="co"># Rename variables</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">4</span>] =<span class="st"> &quot;hap&quot;</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">5</span>] =<span class="st"> &quot;neu&quot;</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">6</span>] =<span class="st"> &quot;ang&quot;</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">7</span>] =<span class="st"> &quot;hap&quot;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">8</span>] =<span class="st"> &quot;neu&quot;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target[EEG_task_RT_targ_lmm<span class="op">$</span>Target <span class="op">==</span><span class="st"> </span><span class="dv">9</span>] =<span class="st"> &quot;ang&quot;</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true"></a><span class="co"># Create factors, define neutral as baseline</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Target =<span class="st"> </span><span class="kw">factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Target, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neu&quot;</span>, </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true"></a>    <span class="st">&quot;hap&quot;</span>, <span class="st">&quot;ang&quot;</span>))</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>ID)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true"></a>EEG_task_RT_targ_lmm<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Stim_Type)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true"></a><span class="co"># Create contrast for emotion</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true"></a><span class="kw">contrasts</span>(EEG_task_RT_targ_lmm<span class="op">$</span>Target) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>, <span class="dt">base =</span> <span class="dv">1</span>)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true"></a>mm_EEG_task_RT_targ =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Target, EEG_task_RT_targ_lmm)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true"></a>EEG_task_RT_targ_lmm[, (<span class="kw">ncol</span>(EEG_task_RT_targ_lmm) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(EEG_task_RT_targ_lmm) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true"></a><span class="st">    </span><span class="dv">3</span>)] =<span class="st"> </span>mm_EEG_task_RT_targ</span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true"></a><span class="kw">names</span>(EEG_task_RT_targ_lmm)[(<span class="kw">ncol</span>(EEG_task_RT_targ_lmm) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(EEG_task_RT_targ_lmm)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true"></a>    <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true"></a></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true"></a><span class="co">## Define model</span></span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true"></a>mod_RT_targ.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_targ_lmm, </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true"></a></span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer1))</span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true"></a></span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true"></a><span class="co"># 3rd: remove all terms with zero variance --&gt; comprises final model</span></span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true"></a>mod_RT_targ.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_targ_lmm, </span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true"></a></span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true"></a><span class="co"># 4th: re-check the model PCA / variance of random factors</span></span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer2))</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true"></a><span class="co"># 5th: Likelihood-ratio-testing Stim Type</span></span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true"></a>mod_RT_targ.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> EEG_task_RT_targ_lmm, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>), </span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true"></a>    <span class="dt">REML =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true"></a></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true"></a><span class="kw">anova</span>(mod_RT_targ.lmer2, mod_RT_targ.lmer3)</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true"></a></span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true"></a></span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true"></a><span class="co"># Re-check the model PCA / variance of random factors</span></span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_RT_targ.lmer3))</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_RT_targ.lmer3), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 2. we applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>log(RTs) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm2-normality-of-residuals" class="section level5">
<h5>LMM2: Normality of residuals</h5>
<p>RTs were log-transformed (determined using the Box-Cox procedure) to meet the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a>mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data =</span> EEG_task_RT_lmm)</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a>res.mod_RT_lmm_no_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_no_log)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>qqpl_RT_lmm_no_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_no_log, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>norm_RT_lmm_no_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_no_log), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="co"># Check which transformation of DV is suitable</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a><span class="co"># Calculate box-cox plot</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a>mod_resp =<span class="st"> </span><span class="kw">lm</span>(RTs <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data =</span> EEG_task_RT_targ_lmm)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a><span class="kw">boxcox</span>(mod_resp)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-2.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (with log transform)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>mod_RT_lmm_log =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(RTs) <span class="op">~</span><span class="st"> </span>Target, <span class="dt">data =</span> EEG_task_RT_targ_lmm)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>res.mod_RT_lmm_log =<span class="st"> </span><span class="kw">residuals</span>(mod_RT_lmm_log)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a>qqpl_RT_lmm_log =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_RT_lmm_log, <span class="dt">main =</span> <span class="st">&quot;QQplot after transformation&quot;</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>norm_RT_lmm_log =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_RT_lmm_log), <span class="dt">main =</span> <span class="st">&quot;Density plot after transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_normres-3.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm2-homoscedasticity" class="section level5">
<h5>LMM2: Homoscedasticity</h5>
<p>Based on the figure, we assume homoscedasticity.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_RT_targ.lmer2), <span class="kw">residuals</span>(mod_RT_targ.lmer3))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_homosk-1.png" width="480" style="display: block; margin: auto;" /></p>
<hr />
</div>
</div>
<div id="results-1" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Print LMM results -->
<p>Contrary to our hypothesis, we did not find a significant main effect of novelty. Children seemed to be equally fast in detecting novel and repeated facial expression. We built an additional LMM to identify potential matching differences for different emotions for Face 2 (contrast: happy vs.Â neutral, angry vs.Â neutral). Trials in which the emotion happy was presented as Face 2 were detected significantly faster than neutral faces. No difference between angry and neutral faces could be found. None of the covariates reached significance.</p>
<div align="center">


<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_RT_EEG.lmer5, mod_RT_targ.lmer3, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, <span class="dt">pred.labels =</span> labels, </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true"></a>    <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true"></a>    <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;Face 2 Novelty&quot;</span>, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true"></a>        <span class="st">&quot;Face 2 Emotion&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
Â 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Novelty
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Face 2 Emotion
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.177
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.439
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.430
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.145
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.49
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.137
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.013</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.36
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.174
</td>
</tr>
<tr>
<td colspan="9" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ïƒ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.35
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Ï„<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.01 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
Â 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.24
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.025 / 0.043
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.020 / 0.253
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>Ïƒ2</em>: within-group variance; <em>Ï„00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] forcats_0.5.0      stringr_1.4.0      purrr_0.3.4        readr_1.3.1       
 [5] tidyr_1.1.1        tibble_3.0.3       tidyverse_1.3.0    sjlabelled_1.1.6  
 [9] sjmisc_2.8.5       sjPlot_2.8.4       Rmisc_1.5          plyr_1.8.6        
[13] reshape2_1.4.4     psych_2.0.7        MASS_7.3-51.6      lmerTest_3.1-2    
[17] lme4_1.1-23        Matrix_1.2-18      Hmisc_4.4-1        Formula_1.2-3     
[21] survival_3.1-12    lattice_0.20-41    ggstatsplot_0.5.0  ez_4.4-0          
[25] EnvStats_2.3.1     eeptools_1.2.4     ggplot2_3.3.2      dplyr_1.0.1       
[29] cowplot_1.0.0      summarytools_0.9.6 miceadds_3.10-28   mice_3.11.0       
[33] rmdformats_0.3.7   XLConnect_1.0.1    kableExtra_1.1.0  

loaded via a namespace (and not attached):
 [1] estimability_1.3       coda_0.19-3            knitr_1.29            
 [4] multcomp_1.4-13        data.table_1.13.0      rpart_4.1-15          
 [7] inline_0.3.15          generics_0.0.2         TH.data_1.0-10        
[10] callr_3.4.3            correlation_0.3.0      webshot_0.5.2         
[13] xml2_1.3.2             lubridate_1.7.9        httpuv_1.5.4          
[16] StanHeaders_2.21.0-6   assertthat_0.2.1       WRS2_1.1-0            
[19] xfun_0.16              hms_0.5.3              rJava_0.9-13          
[22] evaluate_0.14          promises_1.1.1         tidyBF_0.2.1          
[25] fansi_0.4.1            dbplyr_1.4.4           readxl_1.3.1          
[28] tmvnsim_1.0-2          DBI_1.1.0              htmlwidgets_1.5.1     
[31] reshape_0.8.8          kSamples_1.2-9         stats4_4.0.2          
[34] Rmpfr_0.8-1            paletteer_1.2.0        ellipsis_0.3.1        
[37] rcompanion_2.3.25      backports_1.1.8        V8_3.2.0              
[40] bookdown_0.20          insight_0.9.0          ggcorrplot_0.1.3      
[43] rapportools_1.0        RcppParallel_5.0.2     libcoin_1.0-6         
[46] vctrs_0.3.2            abind_1.4-5            withr_2.2.0           
[49] pryr_0.1.4             metaBMA_0.6.3          emmeans_1.5.0         
[52] bdsmatrix_1.3-4        checkmate_2.0.0        vcd_1.4-7             
[55] prettyunits_1.1.1      mnormt_2.0.1           fastGHQuad_1.0        
[58] cluster_2.1.0          crayon_1.3.4           labeling_0.3          
[61] pkgconfig_2.0.3        SuppDists_1.1-9.5      nlme_3.1-148          
[64] statsExpressions_0.4.2 nnet_7.3-14            rlang_0.4.7           
[67] lifecycle_0.2.0        miniUI_0.1.1.1         groupedstats_1.0.1    
[70] skimr_2.1.2            LaplacesDemon_16.1.4   sandwich_2.5-1        
[73] MatrixModels_0.4-1     EMT_1.1                modelr_0.1.8          
 [ reached getOption(&quot;max.print&quot;) -- omitted 117 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
