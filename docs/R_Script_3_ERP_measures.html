<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>ERP measures</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-wrench"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    EEG task measures
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">ERP measures</h1>

</div>


<!-- Set up workspace -->
<!-- Load data set -->
<p><br></p>
<p>We developed a novel paradigm to examine ERP responses to novel and repeated emotional faces. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the emotional expression displayed (happy, fearful or neutral).</p>
<p>We calculated linear mixed models (LMM) separately for each ERP component. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all linear mixed model analyses to control for cognitive abilities of the children as well as potential age differences.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
<p><br></p>
<div id="valence-effects" class="section level3">
<h3>Valence effects</h3>
<p><br></p>
<p>We predicted that ERP amplitudes of sensory (P1, N170) and higher-order (P3) components would be larger for emotional compared to neutral facial expressions. We examined this hypothesis in response to Face 1.</p>
<p><br></p>
<div id="descriptive-statistics" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<pre class="r"><code>## P1/P3 trajectories

# Load data
  Face1_data = read.csv(&quot;./data/ROI_P1_P3_Face1.csv&quot;,header = TRUE)

# De-select participants
  Face1_data = Face1_data[with(Face1_data, !(Face1_data$ID==&quot;05&quot;)), ]

# Select time window
  Face1_data = Face1_data[(Face1_data$Time &gt;= -200)&amp; (Face1_data$Time &lt;= 600),]

# Rename conditions
  Face1_data$Condition[Face1_data$Condition == 1]=&#39;happy&#39;;
  Face1_data$Condition[Face1_data$Condition == 2]=&#39;neutral&#39;;
  Face1_data$Condition[Face1_data$Condition == 3]=&#39;angry&#39;;

# Select conditions of interest
  Face1_data_all_emo_sep = Face1_data[(Face1_data$Condition == &#39;happy&#39;)  | (Face1_data$Condition == &#39;angry&#39;) | (Face1_data$Condition == &#39;neutral&#39;),]
  
  
# Factor and level emotion
  Face1_data_all_emo_sep$Condition = factor(Face1_data_all_emo_sep$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))


# Plot data
  P1_P3_val_traj = ggplot(Face1_data_all_emo_sep,aes(Time,ROI_Average))+
    theme(panel.background = element_blank(), panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
          axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)),
          axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)),
          legend.text=element_text(size=7),
          legend.key = element_rect(fill = &quot;white&quot;))+
    stat_summary(fun.y = mean, geom = &quot;line&quot;, size = 0.8, linetype = &quot;solid&quot;, aes(colour= Condition))+
    scale_color_discrete(guide = guide_legend(override.aes = list(color = &quot;white&quot;)))+
    scale_colour_manual(values = emotion_col)+
    labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;Mean ROI amplitude [&quot;,mu,&quot;V]&quot;)),colour = &quot;&quot;)+
    theme(legend.position=&quot;none&quot;) +
    coord_cartesian(ylim=c(-2, 16),xlim=c(-100,600)) +
    scale_y_continuous(breaks=seq(-2,16,2))+
    scale_x_continuous(breaks=seq(-100,600,100))+
    geom_vline(xintercept = 0, linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
    geom_hline(yintercept = 0, linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)+
    geom_text(x=110, y=14, label = &quot;P1&quot;, color=&quot;black&quot;, size=3)+
    geom_text(x=350, y=14, label = &quot;P3&quot;, color=&quot;black&quot;, size=3)


## N170 trajectories

# Load data
  Face1_data_l = read.csv(&quot;./data/left_ROI_N170_Face1.csv&quot;,header = TRUE)
  Face1_data_r = read.csv(&quot;./data/right_ROI_N170_Face1.csv&quot;,header = TRUE)

# Select time windows
  Face1_data_l = Face1_data_l[(Face1_data_l$Time &gt;= -200)&amp; (Face1_data_l$Time &lt;= 600),]
  Face1_data_r = Face1_data_r[(Face1_data_r$Time &gt;= -200)&amp; (Face1_data_r$Time &lt;= 600),]

# De-select participants
  Face1_data_l = Face1_data_l[with(Face1_data_l, !(Face1_data_l$ID==&quot;05&quot;)), ]
  Face1_data_r = Face1_data_r[with(Face1_data_r, !(Face1_data_r$ID==&quot;05&quot;)), ]

# Rename conditions
  Face1_data_l$Condition[Face1_data_l$Condition == 1]=&#39;happy&#39;;
  Face1_data_l$Condition[Face1_data_l$Condition == 2]=&#39;neutral&#39;;
  Face1_data_l$Condition[Face1_data_l$Condition == 3]=&#39;angry&#39;;
  
  Face1_data_r$Condition[Face1_data_r$Condition == 1]=&#39;happy&#39;;
  Face1_data_r$Condition[Face1_data_r$Condition == 2]=&#39;neutral&#39;;
  Face1_data_r$Condition[Face1_data_r$Condition == 3]=&#39;angry&#39;;

# Select conditions of interest
  Face1_data_all_emo_sep_l = Face1_data_l[(Face1_data_l$Condition == &#39;happy&#39;)  | (Face1_data_l$Condition == &#39;angry&#39;) | (Face1_data_l$Condition == &#39;neutral&#39;),]
  
  Face1_data_all_emo_sep_r = Face1_data_r[(Face1_data_r$Condition == &#39;happy&#39;)  | (Face1_data_r$Condition == &#39;angry&#39;) | (Face1_data_r$Condition == &#39;neutral&#39;),]
  
# Factor and level emotion
  Face1_data_all_emo_sep_l$Condition = factor(Face1_data_all_emo_sep_l$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

    Face1_data_all_emo_sep_r$Condition = factor(Face1_data_all_emo_sep_r$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Average N170 trajectories for left and right hemisphere  
  Face1_N170 = (Face1_data_all_emo_sep_l + Face1_data_all_emo_sep_r)/2
  Face1_N170$Condition = Face1_data_all_emo_sep_l$Condition
  
# Plot N170 trajectory   
   N170_val_traj = ggplot(Face1_N170,aes(Time,ROI_Average))+
      theme(panel.background = element_blank(),panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
            axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
            axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)),
            legend.text=element_text(size=7),
            legend.key = element_rect(fill = &quot;white&quot;))+
      stat_summary(fun.y = mean, geom = &quot;line&quot;,size = 0.8, linetype = &quot;solid&quot;, aes(colour= Condition))+
      scale_colour_manual(values = emotion_col)+
      theme(legend.position=&quot;none&quot;)+
      labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;&quot;)),colour = &quot;&quot;)+
      coord_cartesian(ylim=c(-6,6),xlim=c(-100,600)) +
      scale_y_continuous(breaks=seq(-6,6,2))+
      scale_x_continuous(breaks=seq(-100,600,100))+
      geom_vline(xintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
      geom_hline(yintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)+
      geom_text(x=200, y=-5.2, label = &quot;N170&quot;, color=&quot;black&quot;, size = 3)

# Load topography information
  Topo_Emo = read.csv(file=&quot;./data/ERPs_Topo_Face1.csv&quot;, header=TRUE, sep=&quot;,&quot;)

# Exclude participant
  Topo_Emo = Topo_Emo[with(Topo_Emo, !(Topo_Emo$ID==5)), ]

# Re-name to fit topoplot function
  names(Topo_Emo)[names(Topo_Emo) == &quot;Time&quot;] = &quot;time&quot;

# Change from wide to long format for electrodes
  Topo_Emo = gather(Topo_Emo, electrode, amplitude, Fp1:Oz, factor_key=TRUE)

# Rename A1/A2
  names(Topo_Emo)[names(Topo_Emo) == &quot;A1&quot;] &lt;- &quot;TP9&quot;
  names(Topo_Emo)[names(Topo_Emo) == &quot;A2&quot;] &lt;- &quot;TP10&quot;

# Plot topoplots for happy
  Topo_Emo_Hap = subset(Topo_Emo, Condition == 1)
  
# Plot topoplots for neutral
  Topo_Emo_Neu = subset(Topo_Emo, Condition == 2)

# Plot topoplots for angry
  Topo_Emo_Ang = subset(Topo_Emo, Condition == 3)
  
# Calculate difference score angry-neutral
  Topo_Diff_Ang_Neu = data.frame(ID = Topo_Emo_Hap[,1], time = Topo_Emo_Hap[,3],
                                  electrode = Topo_Emo_Hap[,4], amplitude = Topo_Emo_Ang$amplitude - Topo_Emo_Neu$amplitude)
  
  
# Calculate difference score happy-neutral
  Topo_Diff_Hap_Neu = data.frame(ID = Topo_Emo_Hap[,1], time = Topo_Emo_Hap[,3],
                                  electrode = Topo_Emo_Hap[,4], amplitude = Topo_Emo_Hap$amplitude - Topo_Emo_Neu$amplitude)  
  
## P1s   

# Select time windows
  Topo_Diff_Ang_Neu_P1 = subset(Topo_Diff_Ang_Neu, time &gt;= 80 &amp; time &lt;= 120)
  Topo_Diff_Hap_Neu_P1 = subset(Topo_Diff_Hap_Neu, time &gt;= 80 &amp; time &lt;= 120)

# Add electrode information  
  Topo_Diff_Ang_Neu_P1 = electrode_locations(Topo_Diff_Ang_Neu_P1, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)
  Topo_Diff_Hap_Neu_P1 = electrode_locations(Topo_Diff_Hap_Neu_P1, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

# Draw topographies
  topo_diff_ang_neu_P1 = ggplot(Topo_Diff_Ang_Neu_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P1 (80-120 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  

# Draw topographies
  topo_diff_hap_neu_P1 = ggplot(Topo_Diff_Hap_Neu_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                   ggtitle(&quot;&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))  

## N170s 

# Select time windows
  Topo_Diff_Ang_Neu_N170 = subset(Topo_Diff_Ang_Neu, time &gt;= 170 &amp; time &lt;= 230)
  Topo_Diff_Hap_Neu_N170 = subset(Topo_Diff_Hap_Neu, time &gt;= 170 &amp; time &lt;= 230)

# Add electrode information  
  Topo_Diff_Ang_Neu_N170 = electrode_locations(Topo_Diff_Ang_Neu_N170, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)
  Topo_Diff_Hap_Neu_N170 = electrode_locations(Topo_Diff_Hap_Neu_N170, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

# Draw topographies
  topo_diff_ang_neu_N170 = ggplot(Topo_Diff_Ang_Neu_N170, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;N170 (170-230 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,3)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  

# Draw topographies
  topo_diff_hap_neu_N170 = ggplot(Topo_Diff_Hap_Neu_N170, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,3)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))  
  
## P3s   

# Select time windows
  Topo_Diff_Ang_Neu_P3 = subset(Topo_Diff_Ang_Neu, time &gt;= 300 &amp; time &lt;= 600)
  Topo_Diff_Hap_Neu_P3 = subset(Topo_Diff_Hap_Neu, time &gt;= 300 &amp; time &lt;= 600)

# Add electrode information  
  Topo_Diff_Ang_Neu_P3 = electrode_locations(Topo_Diff_Ang_Neu_P3, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)
  Topo_Diff_Hap_Neu_P3 = electrode_locations(Topo_Diff_Hap_Neu_P3, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

# Draw topographies
  topo_diff_ang_neu_P3 = ggplot(Topo_Diff_Ang_Neu_P3, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P3 (300-600 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,4)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  

# Draw topographies
  topo_diff_hap_neu_P3 = ggplot(Topo_Diff_Hap_Neu_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,4)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))  </code></pre>
<pre class="r"><code># Get legend for trajectories
  traj_emo = ggplot(Face1_N170,aes(Time,ROI_Average))+
      theme(panel.background = element_blank(),panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
            axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
            axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)),
            legend.text=element_text(size=10),
            legend.key = element_rect(fill = &quot;white&quot;))+
      stat_summary(fun.y = mean, geom = &quot;line&quot;,size = 1, linetype = &quot;solid&quot;, aes(colour= Condition))+
      scale_colour_manual(values = emotion_col)+
      theme(legend.position=&quot;right&quot;)+
      labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;&quot;)),colour = &quot;&quot;)+
      coord_cartesian(ylim=c(-6,6),xlim=c(-100,600)) +
      scale_y_continuous(breaks=seq(-6,6,2))+
      scale_x_continuous(breaks=seq(-100,600,100))+
      geom_vline(xintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
      geom_hline(yintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)

  traj_leg_emo = get_legend(traj_emo)

# Get legend for topos
  topo_leg_P1 =  ggplot(Topo_Diff_Ang_Neu_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                      ggtitle(&quot;Angry-Neutral&quot;)+
                      geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 2,
                                head_size = 1.5) +
                      scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2,2)) +
                      theme_void() +
                      coord_equal() +
                      labs(fill = expression(paste(&quot; &quot;, mu,&quot;V&quot;)))+
                      theme(legend.position  = &quot;right&quot;)
  
  topo_leg_P1 = get_legend(topo_leg_P1)


  topo_leg_N170 = ggplot(Topo_Diff_Ang_Neu_N170, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                      ggtitle(&quot;Angry-Neutral&quot;)+
                      geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 2,
                                head_size = 1.5) +
                      scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,3)) +
                      theme_void() +
                      coord_equal() +
                      labs(fill = expression(paste(&quot; &quot;, mu,&quot;V&quot;)))+
                      theme(legend.position = &quot;right&quot;)
 
  
  topo_leg_N170 = get_legend(topo_leg_N170)
  
  
  topo_leg_P3 =  ggplot(Topo_Diff_Ang_Neu_P3, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                      ggtitle(&quot;Angry-Neutral&quot;)+
                      geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 2,
                                head_size = 1.5) +
                      scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-3,4)) +
                      theme_void() +
                      coord_equal() +
                      labs(fill = expression(paste(&quot; &quot;, mu,&quot;V&quot;)))+
                      theme(legend.position  = &quot;right&quot;)
  
  topo_leg_P3 = get_legend(topo_leg_P3)  

  
# Get difference labels
  text = paste(&quot;\n Angry-\n&quot;, &quot;Neutral\n&quot;)
  
  ang_neu_text = ggplot() + 
    annotate(&quot;text&quot;, x = 4, y = 25, size=4, label = text) + 
    theme_minimal() +
    theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),
          axis.line = element_line(color = &quot;white&quot;,size = 1, linetype = &quot;solid&quot;),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.title.y = element_blank(),
          axis.title.x = element_blank(),
          panel.background = element_rect(colour = &quot;white&quot;, size = 0.5),
          axis.ticks = element_blank())

  text = paste(&quot;\n Happy-\n&quot;, &quot;Neutral\n&quot;)
  
  hap_neu_text = ggplot() + 
    annotate(&quot;text&quot;, x = 4, y = 25, size=4, label = text) + 
    theme_minimal() +
    theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),
          axis.line = element_line(color = &quot;white&quot;,size = 1, linetype = &quot;solid&quot;),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.title.y = element_blank(),
          axis.title.x = element_blank(),
          panel.background = element_rect(colour = &quot;white&quot;, size = 0.5),
          axis.ticks = element_blank()) 
  
# Get capital letters
  text = paste(&quot;\n A\n&quot;,&quot;\n \n&quot;,&quot;\n \n&quot;,&quot;\n \n&quot;,&quot;\n B\n&quot;)
  
  first_plot = ggplot() + 
    annotate(&quot;text&quot;, x = 4, y = 25, size=5, label = text) + 
    theme_minimal() +
    theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),
          axis.line = element_line(color = &quot;white&quot;,size = 1, linetype = &quot;solid&quot;),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.title.y = element_blank(),
          axis.title.x = element_blank(),
          panel.background = element_rect(colour = &quot;white&quot;, size = 0.5),
          axis.ticks = element_blank()) 
  
# Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)
  ggdraw(xlim = c(0, 1.2), ylim = c(0,1.4)) +
    draw_plot(first_plot, -0.68, 0.25, 1.4, 1.4) +
    draw_plot(P1_P3_val_traj, 0.05, 0.7, 0.5, 0.6)+ 
    draw_plot(N170_val_traj, 0.55, 0.7, 0.5, 0.6)+
    draw_plot(traj_leg_emo, 1, 1, 0.25, 0.25)+
    draw_plot(ang_neu_text, -0.05, 0.25, 0.3, 0.3)+
    draw_plot(hap_neu_text, -0.05, -0.05, 0.3, 0.3)+
    draw_plot(topo_diff_ang_neu_P1, 0.12, 0.3, 0.3, 0.3) +
    draw_plot(topo_diff_hap_neu_P1, 0.12, 0.00, 0.3, 0.3) +
    draw_plot(topo_leg_P1, 0.37, 0.25, 0.15, 0.15)+ 
    draw_plot(topo_diff_ang_neu_N170, 0.47, 0.3, 0.3, 0.3) +
    draw_plot(topo_diff_hap_neu_N170, 0.47, 0.00, 0.3, 0.3) +
    draw_plot(topo_leg_N170, 0.72, 0.25, 0.15, 0.15)+
    draw_plot(topo_diff_ang_neu_P3, 0.82, 0.3, 0.3, 0.3) +
    draw_plot(topo_diff_hap_neu_P3, 0.82, 0.00, 0.3, 0.3) +
    draw_plot(topo_leg_P3, 1.07, 0.25, 0.15, 0.15)</code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_val_plot-1.png" width="672" /></p>
<p><br><br></p>
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<pre class="r"><code># Select Face 1
  P1_Val = subset(ERP_data,Group_pt == 1) 

# Prepare fixed factors 
  P1_Val$ID = as.factor(P1_Val$ID)
  P1_Val$Stim_Type = as.factor(P1_Val$Stim_Type)

# Re-code emotion condition
  P1_Val$Condition[P1_Val$Condition==1] = &quot;happy&quot;
  P1_Val$Condition[P1_Val$Condition==2] = &quot;neutral&quot;
  P1_Val$Condition[P1_Val$Condition==3] = &quot;angry&quot;

# Create factor &amp; set neutral as baseline
  P1_Val$Condition = factor(P1_Val$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Add contrast columns
  mm_P1_Val =  model.matrix( ~ Condition, P1_Val) 

# Attach to dataframe
  P1_Val[,(ncol(P1_Val)+1):(ncol(P1_Val)+3)] = mm_P1_Val
  names(P1_Val)[(ncol(P1_Val)-2):ncol(P1_Val)] = c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 

# Build model 
  mod_P1_val.lmer1 = lmer(mean_ROI_P1 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Hap_Neu + Ang_Neu||ID) +
                            (1 + Hap_Neu + Ang_Neu||Stim_Type),
                          data = P1_Val,
                          control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_P1_val.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_P1_val.lmer1),comp = &quot;Variance&quot;)

# Remove intercepts/slopes based on variance check 
  mod_P1_val.lmer2 = lmer(mean_ROI_P1 ~ 
                          Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                          (1 + Hap_Neu + Ang_Neu||ID) +
                          (0 + Hap_Neu||Stim_Type),
                        data = P1_Val,
                        control=lmerControl(calc.derivs = FALSE))

# Re-check the model
  summary(rePCA(mod_P1_val.lmer2))
  print(VarCorr(mod_P1_val.lmer2),comp = &quot;Variance&quot;)

# Likelihood ratio testing

# For ID
  mod_P1_val.lmer3 = lmer(mean_ROI_P1 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 |ID) +
                            (0 + Hap_Neu + Ang_Neu||Stim_Type),
                          data = P1_Val,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P1_val.lmer2,mod_P1_val.lmer3)

# Stimulus type
  mod_P1_val.lmer4 = lmer(mean_ROI_P1 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Ang_Neu||ID) +
                            (1 |Stim_Type),
                          data = P1_Val,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P1_val.lmer2,mod_P1_val.lmer4)


# Final model
  mod_P1_val.lmer4 = lmer(mean_ROI_P1 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 |ID) +
                            (1 |Stim_Type),
                          data = P1_Val,
                          control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<pre class="r"><code># Set treatment contrast
  contrasts(P1_Val$Condition) = contr.treatment(3)

## Check properties of DV / residuals 
  P1_Val$Trans_P1 = P1_Val$mean_ROI_P1 + 1 - min(P1_Val$mean_ROI_P1)

# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(P1_Val$Trans_P1 ~ P1_Val$Condition)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_P1_val = lm(Trans_P1 ~ Condition, data=P1_Val)
  res.mod_P1_val = residuals(mod_P1_val)
  
  par(mfrow=c(1,2))
  qqpl_mod_P1_val = qqPlot(res.mod_P1_val, main=&quot;QQplot before transformation&quot;)    
  norm_mod_P1_val = plot(density(res.mod_P1_val), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm_p1-homoscedasticity" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_P1_val.lmer4), residuals(mod_P1_val.lmer4))
  abline(0, 0)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<pre class="r"><code># Transform dataset so that left/right hemisphere are accounted for 
  N170_Val = gather (ERP_data, Elect_site, N170_Amplitude, mean_ROI_N170l:mean_ROI_N170r, factor_key = TRUE)

# Add variable name
  N170_Val$Elect_site = as.character(N170_Val$Elect_site)
  N170_Val$Elect_site[N170_Val$Elect_site == &quot;mean_ROI_N170l&quot;] = &#39;left&#39;
  N170_Val$Elect_site[N170_Val$Elect_site == &quot;mean_ROI_N170r&quot;] = &quot;right&quot;

# Prepare fixed factors 
  N170_Val$ID = as.factor(N170_Val$ID)
  N170_Val$Stim_Type = as.factor(N170_Val$Stim_Type)
  N170_Val$Elect_site = factor(N170_Val$Elect_site)

# Select primes
  N170_Val = subset(N170_Val,Group_pt == 1) 

# Re-code values for emotion variable
  N170_Val$Condition[N170_Val$Condition==1] = &quot;happy&quot;
  N170_Val$Condition[N170_Val$Condition==2] = &quot;neutral&quot;
  N170_Val$Condition[N170_Val$Condition==3] = &quot;angry&quot;

# Create factor, get neutral as baseline
  N170_Val$Condition = factor(N170_Val$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Set treatment contrast
  contrasts(N170_Val$Condition) = contr.treatment(3)

# Set contrast for hemisphere
  contrasts(N170_Val$Elect_site) = contr.sum(2)/2



# Add contrast columns
  mm_N170_Val =  model.matrix( ~ Condition + Elect_site + Condition*Elect_site, N170_Val) 

# Attach to dataframe
  N170_Val[,(ncol(N170_Val)+1):(ncol(N170_Val)+6)] = mm_N170_Val
  names(N170_Val)[(ncol(N170_Val)-5):ncol(N170_Val)] = c(&quot;Mean&quot;, &quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;, &quot;Elect_site&quot;, &quot;Hap_NeuxElect_site&quot;, &quot;Ang_NeuxElect_site&quot;) 

# Get model
  mod_N170_val.lmer1 = lmer(N170_Amplitude ~ 
                              Hap_Neu + Ang_Neu+ Hap_NeuxElect_site + Ang_NeuxElect_site + scale(Age) + scale(WM) + 
                              (1 + Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + Elect_site||ID) +
                              (1 + Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + Elect_site||Stim_Type),
                            data = N170_Val,
                            control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_N170_val.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_N170_val.lmer1),comp = &quot;Variance&quot;)

# Improved model
  mod_N170_val.lmer2 = lmer(N170_Amplitude ~ 
                              Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + scale(Age) + scale(WM) + 
                              (1 |ID),
                            data = N170_Val,
                            control=lmerControl(calc.derivs = FALSE))
# Re-check the model
  summary(rePCA(mod_N170_val.lmer2))
  print(VarCorr(mod_N170_val.lmer2),comp = &quot;Variance&quot;)</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). For the N170, we also included a scaled sum contrast for hemisphere (<code>Elect_site</code>) as well as an interaction of emotional facial expressions with hemisphere. The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + ,     scale(Age) + scale(WM) + (1 | ID)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<pre class="r"><code>## Check properties of DV / residuals 
  N170_Val$Trans_N170 = N170_Val$N170_Amplitude + 1 - min(N170_Val$N170_Amplitude)

# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(N170_Val$Trans_N170 ~ N170_Val$Condition)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_box-1.png" width="576" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_N170_val = lm(Trans_N170 ~ Condition, data=N170_Val)
  res.mod_N170_val = residuals(mod_N170_val)
  
  par(mfrow=c(1,2))
  qqpl_mod_N170_val = qqPlot(res.mod_N170_val, main=&quot;QQplot before transformation&quot;)    
  norm_mod_N170_val = plot(density(res.mod_N170_val), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))  </code></pre>
<hr />
</div>
<div id="lmm_n170-homoscedasticity" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_N170_val.lmer2), residuals(mod_N170_val.lmer2))
  abline(0, 0) </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<pre class="r"><code># Select primes
  P3_Val = subset(ERP_data, Group_pt == 1) 

# Prepare fixed factors 
  P3_Val$ID = as.factor(P3_Val$ID)
  P3_Val$Stim_Type = as.factor(P3_Val$Stim_Type)

# Re-Name values of emotion condition
  P3_Val$Condition[P3_Val$Condition==1] = &quot;happy&quot;
  P3_Val$Condition[P3_Val$Condition==2] = &quot;neutral&quot;
  P3_Val$Condition[P3_Val$Condition==3] = &quot;angry&quot;

# Create factor, get neutral as baseline
  P3_Val$Condition = factor(P3_Val$Condition, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

# Set treatment contrast
  contrasts(P3_Val$Condition) = contr.treatment(3)


# Add contrast columns
  mm_P3_Val =  model.matrix( ~ Condition, P3_Val) 

# Attach to dataframe
  P3_Val[,(ncol(P3_Val)+1):(ncol(P3_Val)+3)] = mm_P3_Val
  names(P3_Val)[(ncol(P3_Val)-2):ncol(P3_Val)] = c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 

# Get model 
  mod_P3_val.lmer1 = lmer(mean_ROI_P3 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 + Hap_Neu + Ang_Neu||ID) +
                            (1 + Hap_Neu + Ang_Neu||Stim_Type),
                          data = P3_Val,
                          control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_P3_val.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_P3_val.lmer1),comp = &quot;Variance&quot;)

# Improved model
  mod_P3_val.lmer2 = lmer(mean_ROI_P3 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 | ID) +
                            (1 + Ang_Neu||Stim_Type),
                          data = P3_Val,
                          control=lmerControl(calc.derivs = FALSE))

# Re-check the model
  summary(rePCA(mod_P3_val.lmer2))
  print(VarCorr(mod_P3_val.lmer2),comp = &quot;Variance&quot;)


# Likelihood ratio testing 

# Stimulus type 
  mod_P3_val.lmer3 = lmer(mean_ROI_P3 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 |ID) +
                            (1 |Stim_Type),
                          data = P3_Val,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA 
  anova(mod_P3_val.lmer2, mod_P3_val.lmer3)


# Final model
  mod_P3_val.lmer4 = lmer(mean_ROI_P3 ~ 
                            Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                            (1 |ID) +
                            (1 |Stim_Type),
                          data = P3_Val,
                          control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<pre class="r"><code>## Check properties of DV / residuals 
  P3_Val$Trans_P3 = P3_Val$mean_ROI_P3 + 1 - min(P3_Val$mean_ROI_P3)

# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(P3_Val$Trans_P3 ~ P3_Val$Condition)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_box-1.png" width="576" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_P3_val = lm(Trans_P3 ~ Condition, data=P3_Val)
  res.mod_P3_val = residuals(mod_P3_val)
  
  par(mfrow=c(1,2))
  qqpl_mod_P3_val = qqPlot(res.mod_P3_val, main=&quot;QQplot before transformation&quot;)    
  norm_mod_P3_val = plot(density(res.mod_P3_val), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm_p3-homoscedasticity" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_P3_val.lmer4), residuals(mod_P3_val.lmer4))
  abline(0, 0)    </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Present ERP valence effects -->
<p>P1 Amplitudes at Face 1 were significantly larger for angry in comparison to neutral facial expressions. No difference was found for the contrast of happy vs neutral faces. In contrast to our hypothesis, no differences N170 amplitde difference between happy or angry faces compared to neutral faces were detected. None of the interactions of hemisphere with the emotion contrasts reached significance. In line with our hypothesis, angry faces elicited larger amplitudes compared to neutral faces. No difference, however, was found between happy and neutral faces.</p>
<pre class="r"><code># Define labels 
labels = c(&quot;Intercept&quot;,&quot;Happy vs Neutral&quot;, &quot;Angry vs Neutral&quot;, &quot;Age&quot;, &quot;Working Memory&quot;,&quot;HvsN X ROI&quot;, &quot;AvsN X ROI&quot;)

# Create table
  tab_model(mod_P1_val.lmer4, mod_N170_val.lmer2, mod_P3_val.lmer4, 
          pred.labels=labels,
          string.est = &quot;b&quot;,
          show.se=TRUE, string.se = &quot;SE&quot;,
          show.stat=TRUE, string.stat = &quot;t&quot;,
          show.ci = FALSE, 
          show.re.var = TRUE, show.obs = TRUE,
          emph.p = TRUE, dv.labels=c(&quot;P1 Amplitudes&quot;,&quot;N170 Amplitudes&quot;,&quot;P3 Amplitudes&quot;),
          show.icc = TRUE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
12.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
11.90
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-7.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-10.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
8.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
6.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.99
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.121
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.843
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.349
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.014</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.164
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.030</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.239
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.998
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.070
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.922
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.867
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.852
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
HvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.371
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.59
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.372
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
198.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
156.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
277.65
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.09 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.38 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
25.12 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
29.41 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2859
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
5718
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2859
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.009 / NA
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.001 / 0.061
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.014 / 0.110
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
<p><br></p>
</div>
</div>
<div id="categorization-effects" class="section level3">
<h3>Categorization effects</h3>
<p><br></p>
<p>We hypothesized that ERP amplitudes for Face 2 would decrease in response to an identical Face 1.</p>
<p><br></p>
<div id="descriptive-statistics-1" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<pre class="r"><code>## P1 and P3

# Load Face 2 data
  Face2_data = read.csv(&quot;./data/ROI_P1_P3_Face2.csv&quot;,header = TRUE)

# De-select participants
  Face2_data = Face2_data[with(Face2_data, !(Face2_data$ID==&quot;05&quot;)), ]

# Select time window of interest
  Face2_data = Face2_data[(Face2_data$Time &gt;= -200)&amp; (Face2_data$Time &lt;= 600),]

# Rename values of Face2 condition
  Face2_data$Condition[Face2_data$Condition == 1]=&#39;repeated&#39;;
  Face2_data$Condition[Face2_data$Condition == 2]=&#39;novel&#39;;
  Face2_data$Condition[Face2_data$Condition == 3]=&#39;prime&#39;;
  Face2_data$Condition[Face2_data$Condition == 4]=&#39;c_happy&#39;;
  Face2_data$Condition[Face2_data$Condition == 5]=&#39;c_neutral&#39;;
  Face2_data$Condition[Face2_data$Condition == 6]=&#39;c_angry&#39;;
  Face2_data$Condition[Face2_data$Condition == 7]=&#39;ic_happy&#39;;
  Face2_data$Condition[Face2_data$Condition == 8]=&#39;ic_neutral&#39;;
  Face2_data$Condition[Face2_data$Condition == 9]=&#39;ic_angry&#39;;

# Plot ERP trajectory for P1/P3
  Face2_data_icc = Face2_data[(Face2_data$Condition == &#39;repeated&#39;)  | (Face2_data$Condition == &#39;novel&#39;),]
  
  P1_cat_traj = ggplot(Face2_data_icc,aes(Time,ROI_Average))+
    theme(panel.background = element_blank(),panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
          axis.title.y = element_text(margin = margin(t = 0, r = 5, b = 0, l = 0)),
          axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)),
          axis.text=element_text(size=8))+
    stat_summary(fun.y = mean,geom = &quot;line&quot;, size = 0.8, linetype = &quot;solid&quot;,aes(colour= Condition))+
    scale_colour_manual(values = nov_col)+
    #ggtitle(&quot;P1 &amp; P3&quot;) +
    theme(legend.position=&quot;none&quot;)+      
    labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;Mean ROI amplitude [&quot;,mu,&quot;V]&quot;)),colour = &quot;&quot;)+
    coord_cartesian(ylim=c(-2, 18),xlim=c(-100,600)) +
    scale_y_continuous(breaks=seq(-2,18,4))+
    scale_x_continuous(breaks=seq(-100,600,100))+
    geom_vline(xintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
    geom_hline(yintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)+
    geom_text(x=120, y=16.8, label = &quot;P1&quot;, color=&quot;black&quot;, size=3)+
    geom_text(x=350, y=14.8, label = &quot;P3&quot;, color=&quot;black&quot;, size=3)

## N170
  Face2_data_l = read.csv(&quot;./data/left_ROI_N170_Face2.csv&quot;,header = TRUE)
  Face2_data_r = read.csv(&quot;./data/right_ROI_N170_Face2.csv&quot;,header = TRUE)

# De-select participants
  Face2_data_l = Face2_data_l[with(Face2_data_l, !(Face2_data_l$ID==&quot;05&quot;)), ]
  Face2_data_r = Face2_data_r[with(Face2_data_r, !(Face2_data_r$ID==&quot;05&quot;)), ]

# Select time window of interest
  Face2_data_l = Face2_data_l[(Face2_data_l$Time &gt;= -200)&amp; (Face2_data_l$Time &lt;= 1000),]
  Face2_data_r = Face2_data_r[(Face2_data_r$Time &gt;= -200)&amp; (Face2_data_r$Time &lt;= 1000),]

# Rename conditions
  Face2_data_l$Condition[Face2_data_l$Condition == 1]=&#39;repeated&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 2]=&#39;novel&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 3]=&#39;prime&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 4]=&#39;c_happy&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 5]=&#39;c_neutral&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 6]=&#39;c_angry&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 7]=&#39;ic_happy&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 8]=&#39;ic_neutral&#39;;
  Face2_data_l$Condition[Face2_data_l$Condition == 9]=&#39;ic_angry&#39;;

  Face2_data_r$Condition[Face2_data_r$Condition == 1]=&#39;repeated&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 2]=&#39;novel&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 3]=&#39;prime&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 4]=&#39;c_happy&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 5]=&#39;c_neutral&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 6]=&#39;c_angry&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 7]=&#39;ic_happy&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 8]=&#39;ic_neutral&#39;;
  Face2_data_r$Condition[Face2_data_r$Condition == 9]=&#39;ic_angry&#39;;

# Select conditions of interest
  Face2_data_icc_l = Face2_data_l[(Face2_data_l$Condition == &#39;repeated&#39;)  | (Face2_data_l$Condition == &#39;novel&#39;),]
  Face2_data_icc_r = Face2_data_r[(Face2_data_r$Condition == &#39;repeated&#39;) | (Face2_data_r$Condition == &#39;novel&#39;),]
  
  Face2_data_icc_l$Condition = as.factor(Face2_data_icc_l$Condition)
  Face2_data_icc_r$Condition = as.factor(Face2_data_icc_r$Condition)
  
# Average N170 trajectories for left and right hemisphere  
  Face2_N170 = (Face2_data_icc_l + Face2_data_icc_r)/2
  Face2_N170$Condition = Face2_data_icc_l$Condition  
  
# Plot N170 trajectory
  N170_cat_traj = ggplot(Face2_N170,aes(Time,ROI_Average))+
    theme(panel.background = element_blank(),panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
          axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
          axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)))+
    stat_summary(fun.y = mean,geom = &quot;line&quot;,size = 0.8 ,linetype = &quot;solid&quot;,aes(colour= Condition))+
    scale_colour_manual(values =  nov_col)+
    theme(legend.position=&quot;none&quot;)+          # turn off legend
    labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;&quot;)),colour = &quot;&quot;)+
    coord_cartesian(ylim=c(-6,6),xlim=c(-100,600)) +
    scale_y_continuous(breaks=seq(-6,6,2))+
    scale_x_continuous(breaks=seq(-100,600,100))+
    geom_vline(xintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
    geom_hline(yintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)+
    geom_text(x=200, y=-5, label = &quot;N170&quot;, color=&quot;black&quot;, size=3)
  
# Load topography information
  Topo_Cat = read.csv(file=&quot;./data/ERPs_Topo_Face2.csv&quot;, header=TRUE, sep=&quot;,&quot;)

# Remove participant 5
  Topo_Cat = Topo_Cat[with(Topo_Cat, !(Topo_Cat$ID==5)), ]

# Re-name to fit topoplot function
  names(Topo_Cat)[names(Topo_Cat) == &quot;Time&quot;] = &quot;time&quot;

# Change from wide to long format for electrodes
  Topo_Cat = gather(Topo_Cat, electrode, amplitude, Fp1:Oz, factor_key=TRUE)

# Rename A1/A2
  names(Topo_Cat)[names(Topo_Cat) == &quot;A1&quot;] &lt;- &quot;TP9&quot;
  names(Topo_Cat)[names(Topo_Cat) == &quot;A2&quot;] &lt;- &quot;TP10&quot;

# Plot topoplots for repeated trials
  Topo_Cat_Rep = subset(Topo_Cat, Condition == 10)

# Plot topoplots for novel trials
  Topo_Cat_Nov = subset(Topo_Cat, Condition == 11)
  
  
# Calculate difference score novel-repeated
  Topo_Diff_Nov_Rep = data.frame(ID = Topo_Cat_Rep[,1], time = Topo_Cat_Rep[,3],
                                  electrode = Topo_Cat_Rep[,4], amplitude = Topo_Cat_Nov$amplitude - Topo_Cat_Rep$amplitude)  
  
## P1

# Select time windows
  Topo_Diff_Nov_Rep_P1 = subset(Topo_Diff_Nov_Rep, time &gt;= 80 &amp; time &lt;= 120)

# Add electrode information  
  Topo_Diff_Nov_Rep_P1 = electrode_locations(Topo_Diff_Nov_Rep_P1, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

  topo_diff_Nov_Rep_P1 = ggplot(Topo_Diff_Nov_Rep_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P1 (80-120 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  
  
## N170
  
# Select time windows
  Topo_Diff_Nov_Rep_N170 = subset(Topo_Diff_Nov_Rep, time &gt;= 170 &amp; time &lt;= 230)

# Add electrode information  
  Topo_Diff_Nov_Rep_N170 = electrode_locations(Topo_Diff_Nov_Rep_N170, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

  
  topo_diff_Nov_Rep_N170 = ggplot(Topo_Diff_Nov_Rep_N170, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;N170 (170-230 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-1,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  
## P3
  
# Select time windows
  Topo_Diff_Nov_Rep_P3 = subset(Topo_Diff_Nov_Rep, time &gt;= 300 &amp; time &lt;= 600)

# Add electrode information  
  Topo_Diff_Nov_Rep_P3 = electrode_locations(Topo_Diff_Nov_Rep_P3, electrode = &quot;electrode&quot;,  drop = FALSE,montage = NULL)

  
  topo_diff_Nov_Rep_P3 = ggplot(Topo_Diff_Nov_Rep_P3, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P3 (300-600 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2.5,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;Amplitude (&quot;, mu,&quot;V)&quot;)))+
                    theme(legend.position = &quot;none&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))</code></pre>
<pre class="r"><code># Get legend for trajectories
  traj_leg_cat =ggplot(Face2_data_icc,aes(Time,ROI_Average))+
    theme(panel.background = element_blank(),panel.border = element_rect(colour = &quot;grey&quot;, fill=NA, size=2),
          axis.title.y = element_text(margin = margin(t = 0, r = 10, b = 0, l = 0)),
          axis.title.x = element_text(margin = margin(t = -5, r = 10, b = 0, l = 0)),
         legend.key = element_rect(fill = &quot;white&quot;))+
    stat_summary(fun.y = mean,geom = &quot;line&quot;, size = 1, linetype = &quot;solid&quot;,aes(colour= Condition))+
    scale_colour_manual(values = nov_col)+
    #ggtitle(&quot;P1 &amp; P3&quot;) +
    theme(legend.position=&quot;bottom&quot;)+      
    labs(x = &quot;\ntime (ms)&quot;,y = expression(paste(&quot;Mean ROI amplitude [&quot;,mu,&quot;V]&quot;)),colour = &quot;&quot;)+
    coord_cartesian(ylim=c(-2, 17),xlim=c(-100,600)) +
    scale_y_continuous(breaks=seq(-2,17,2))+
    scale_x_continuous(breaks=seq(-100,600,100))+
    geom_vline(xintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot; )+
    geom_hline(yintercept = 0,linetype = &quot;dashed&quot;,colour=&quot;grey&quot;)

  traj_leg_cat = get_legend(traj_leg_cat)

# Get legend for topos
  topo_P1_leg_cat = ggplot(Topo_Diff_Nov_Rep_P1, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P1 (80-120 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;&quot;, mu,&quot;V&quot;)))+
                    theme(legend.position = &quot;right&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  
  topo_P1_leg_cat = get_legend(topo_P1_leg_cat)
  
  topo_N170_leg_cat = ggplot(Topo_Diff_Nov_Rep_N170, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;N170 (170-230 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-1,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;&quot;, mu,&quot;V&quot;)))+
                    theme(legend.position = &quot;right&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
  
  topo_N170_leg_cat = get_legend(topo_N170_leg_cat)
  
  topo_P3_leg_cat = ggplot(Topo_Diff_Nov_Rep_P3, aes(x = x, y = y, fill = amplitude, label = electrode)) +
                    ggtitle(&quot;P3 (300-600 ms)&quot;)+
                    geom_topo(grid_res = 300, interp_limit = &quot;head&quot;, chan_markers = &quot;point&quot;, chan_size = 1,
                              head_size = 1.5) +
                    scale_fill_distiller(palette = &quot;RdBu&quot; , limits = c(-2.5,2)) +
                    theme_void() +
                    coord_equal() +
                    labs(fill = expression(paste(&quot;&quot;, mu,&quot;V&quot;)))+
                    theme(legend.position = &quot;right&quot;, plot.title = element_text(size = 10, face = &quot;bold&quot;))
    
    
  topo_P3_leg_cat = get_legend(topo_P3_leg_cat)


# Get difference label
  text = paste(&quot;\n Novel-\n&quot;, &quot;Repeated\n&quot;)
  
  nov_rep_text = ggplot() + 
    annotate(&quot;text&quot;, x = 4, y = 25, size=4, label = text) + 
    theme_minimal() +
    theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),
          axis.line = element_line(color = &quot;white&quot;,size = 1, linetype = &quot;solid&quot;),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.title.y = element_blank(),
          axis.title.x = element_blank(),
          panel.background = element_rect(colour = &quot;white&quot;, size = 0.5),
          axis.ticks = element_blank())
  
# Get capital letters
  text = paste(&quot;\n A\n&quot;,&quot;\n \n&quot;,&quot;\n \n&quot;,&quot;\n \n&quot;,&quot;\n B\n&quot;)
  
  first_plot = ggplot() + 
    annotate(&quot;text&quot;, x = 4, y = 25, size=5, label = text) + 
    theme_minimal() +
    theme(panel.grid.major=element_blank(), panel.grid.minor=element_blank(),
          axis.line = element_line(color = &quot;white&quot;,size = 1, linetype = &quot;solid&quot;),
          axis.text.x = element_blank(),
          axis.text.y = element_blank(),
          axis.title.y = element_blank(),
          axis.title.x = element_blank(),
          panel.background = element_rect(colour = &quot;white&quot;, size = 0.5),
          axis.ticks = element_blank()) 
  
# Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)
  ggdraw(xlim = c(0, 1.2), ylim = c(0,1.4)) +
    draw_plot(first_plot, -0.68, 0.25, 1.4, 1.4) +
    draw_plot(P1_cat_traj, 0.05, 0.7, 0.5, 0.6) + 
    draw_plot(N170_cat_traj, 0.55, 0.7, 0.5, 0.6) +
    draw_plot(traj_leg_cat, 0.45, 0.6, 0.3, 0.25) +
    draw_plot(nov_rep_text, -0.05, 0.15, 0.3, 0.3) +
    draw_plot(topo_diff_Nov_Rep_P1, 0.1, 0.15, 0.4, 0.4) +
    draw_plot(topo_P1_leg_cat, 0.25, 0.15, 0.4, 0.4) +
    draw_plot(topo_diff_Nov_Rep_N170, 0.43, 0.15, 0.4, 0.4) +
    draw_plot(topo_N170_leg_cat, 0.58, 0.15, 0.4, 0.4) +
    draw_plot(topo_diff_Nov_Rep_P3, 0.75, 0.15, 0.4, 0.4) +
    draw_plot(topo_P3_leg_cat, 0.9, 0.15, 0.4, 0.4) </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_cat_plot-1.png" width="672" /></p>
<p><br></p>
</div>
<div id="model-specification-1" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure-1" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<pre class="r"><code># Select correct responses
  P1_Cat = subset(ERP_data, Response == 1)    

# Select targets
  P1_Cat = subset(P1_Cat,Group_pt == 2)   

# Prepare fixed factors 
  P1_Cat$ID = as.factor(P1_Cat$ID)
  P1_Cat$Stim_Type = as.factor(P1_Cat$Stim_Type)

# Define novel vs repeated trials
  P1_Cat[P1_Cat$Group_pcic==2,]$Group_pcic = &quot;repeated&quot;
  P1_Cat[P1_Cat$Group_pcic==3,]$Group_pcic = &quot;novel&quot;

# Create factor, get neutral as baseline
  P1_Cat$Group_pcic = factor(P1_Cat$Group_pcic, levels=c(&quot;novel&quot;,&quot;repeated&quot;))

# Set treatment contrast
  contrasts(P1_Cat$Group_pcic) = contr.sum(2)/2 
           
# Add contrast columns
  mm_P1_Cat =  model.matrix( ~ Group_pcic, P1_Cat) 

# Attach to dataframe
  P1_Cat[,(ncol(P1_Cat)+1):(ncol(P1_Cat)+2)] = mm_P1_Cat
  names(P1_Cat)[(ncol(P1_Cat)-1):ncol(P1_Cat)] = c(&quot;Mean&quot;,&quot;Nov_Rep&quot;) 

# Build model 
  mod_P1_cat.lmer1 = lmer(mean_ROI_P1 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1 + Nov_Rep||ID) +
                            (1 + Nov_Rep||Stim_Type),
                          data = P1_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_P1_cat.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_P1_cat.lmer1),comp = &quot;Variance&quot;)

## Likelihood-ratio testing

# ID
  mod_P1_cat.lmer2 = lmer(mean_ROI_P1 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1 | ID) +
                            (1 + Nov_Rep||Stim_Type),
                          data = P1_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P1_cat.lmer1, mod_P1_cat.lmer2)

# Stim_Type
  mod_P1_cat.lmer3 = lmer(mean_ROI_P1 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1 + Nov_Rep|| ID) +
                            (1 |Stim_Type),
                          data = P1_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P1_cat.lmer1, mod_P1_cat.lmer3)


# Final model
  mod_P1_cat.lmer4 = lmer(mean_ROI_P1 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1|ID) +
                            (1|Stim_Type),
                          data = P1_Cat,
                          control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID) + (1 | ,     Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals-1" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<pre class="r"><code>## Check properties of DV / residuals 
  P1_Cat$Trans_P1 = P1_Cat$mean_ROI_P1 + 1 - min(P1_Cat$mean_ROI_P1)

# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(P1_Cat$Trans_P1 ~ P1_Cat$Group_pcic)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_box-1.png" width="576" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_P1_Cat = lm(Trans_P1 ~ Group_pcic, data=P1_Cat)
  res.mod_P1_Cat = residuals(mod_P1_Cat)

  par(mfrow=c(1,2))
  qqpl_mod_P1_Cat = qqPlot(res.mod_P1_Cat, main=&quot;QQplot before transformation&quot;)    
  norm_mod_P1_Cat = plot(density(res.mod_P1_Cat), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm_p1-homoscedasticity-1" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_P1_cat.lmer4), residuals(mod_P1_cat.lmer4))
  abline(0, 0)     </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure-1" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<pre class="r"><code># Select targets
  N170_Cat = subset(ERP_data, Group_pt == 2) 

# Select correct responses
  N170_Cat = subset(N170_Cat, Response == 1)    

# Define novel vs repeated trials
  N170_Cat[N170_Cat$Group_pcic==2,]$Group_pcic = &quot;repeated&quot;
  N170_Cat[N170_Cat$Group_pcic==3,]$Group_pcic = &quot;novel&quot;

# Separate data in left and right hemisphere
  N170_Cat = gather (N170_Cat, Elect_site, N170_Amplitude, mean_ROI_N170l:mean_ROI_N170r, factor_key = TRUE)
  N170_Cat$Elect_site = as.character(N170_Cat$Elect_site)

# Add variable name
  N170_Cat$Elect_site[N170_Cat$Elect_site == &quot;mean_ROI_N170l&quot;] = &#39;left&#39;
  N170_Cat$Elect_site[N170_Cat$Elect_site == &quot;mean_ROI_N170r&quot;] = &quot;right&quot;

# Set contrast for elect site
  N170_Cat$Elect_site = factor(N170_Cat$Elect_site)
  contrasts(N170_Cat$Elect_site) = contr.sum(2)/2

# Factor random factors 
  N170_Cat$ID = as.factor(N170_Cat$ID)
  N170_Cat$Stim_Type = as.factor(N170_Cat$Stim_Type)

# Create factor, get neutral as baseline
  N170_Cat$Group_pcic = factor(N170_Cat$Group_pcic, levels=c(&quot;novel&quot;,&quot;repeated&quot;))

# Set treatment contrast
  contrasts(N170_Cat$Group_pcic) = contr.sum(2)/2

# Add contrast columns
  mm_N170_Cat =  model.matrix( ~ Group_pcic + Elect_site + Group_pcic*Elect_site, N170_Cat) 

# Attach to dataframe
  N170_Cat[,(ncol(N170_Cat)+1):(ncol(N170_Cat)+4)] = mm_N170_Cat
  names(N170_Cat)[(ncol(N170_Cat)-3):ncol(N170_Cat)] = c(&quot;Mean&quot;,&quot;Nov_Rep&quot;,&quot;Elect_site&quot;,&quot;Nov_RepxElect_site&quot;) 

# Get model 
  mod_N170_cat.lmer1 = lmer(N170_Amplitude ~ 
                              Nov_Rep + Nov_RepxElect_site + Elect_site + scale(Age) + scale(WM) + 
                              (1 + Nov_Rep + Nov_RepxElect_site + Elect_site||ID) +
                              (1 + Nov_Rep + Nov_RepxElect_site + Elect_site||Stim_Type),
                            data = N170_Cat,
                            control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_N170_cat.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_N170_cat.lmer1),comp = &quot;Variance&quot;)

# Improved model 
  mod_N170_cat.lmer2 = lmer(N170_Amplitude ~ 
                              Nov_Rep + Nov_RepxElect_site + Elect_site + scale(Age) + scale(WM) + 
                              (1 + Elect_site||ID),
                            data = N170_Cat,
                            control=lmerControl(calc.derivs = FALSE))

# Re-check variances
  summary(rePCA(mod_N170_cat.lmer2))
  print(VarCorr(mod_N170_cat.lmer2),comp = &quot;Variance&quot;)

## Likelihood ratio testing 

# ID
  mod_N170_cat.lmer3 = lmer(N170_Amplitude ~ 
                              Nov_Rep + Nov_RepxElect_site + Elect_site + scale(Age) + scale(WM) + 
                              (1 |ID),
                            data = N170_Cat,
                            control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_N170_cat.lmer2 ,mod_N170_cat.lmer3 )

# Final model
  mod_N170_cat.lmer4 = lmer(N170_Amplitude ~ 
                              Nov_Rep + Nov_RepxElect_site + Elect_site + scale(Age) + scale(WM) + 
                              (1 + Elect_site||ID),
                            data = N170_Cat,
                            control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions. For the N170, we also added a scaled sum contrast for Hemisphere (<code>ROI</code>) and the interaction of novelty with hemisphere (<code>NvsR x ROI</code>).The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Nov_Rep + Nov_RepxElect_site + Elect_site + ,     scale(Age) + scale(WM) + ((1 | ID) + (0 + Elect_site | ID))</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals-1" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<pre class="r"><code>## Check properties of DV / residuals 
  N170_Cat$Trans_N170 = N170_Cat$N170_Amplitude + 1 - min(N170_Cat$N170_Amplitude)
  
# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(N170_Cat$Trans_N170 ~ N170_Cat$Group_pcic)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_box-1.png" width="576" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_N170_Cat = lm(Trans_N170 ~ Group_pcic, data=N170_Cat)
  res.mod_N170_Cat = residuals(mod_N170_Cat)

  par(mfrow=c(1,2))
  qqpl_mod_N170_Cat = qqPlot(res.mod_N170_Cat, main=&quot;QQplot before transformation&quot;)    
  norm_mod_N170_Cat = plot(density(res.mod_N170_Cat), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))  </code></pre>
<hr />
</div>
<div id="lmm_n170-homoscedasticity-1" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_N170_cat.lmer4), residuals(mod_N170_cat.lmer4))
  abline(0, 0)         </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure-1" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<pre class="r"><code># Correct responses
  P3_Cat = subset(ERP_data, Response == 1)

# Factor random factors 
  P3_Cat$ID = as.factor(P3_Cat$ID)
  P3_Cat$Stim_Type = as.factor(P3_Cat$Stim_Type)

# Select targets
  P3_Cat = subset(P3_Cat,Group_pt == 2) 

# Define novel vs repeated trials
  P3_Cat[P3_Cat$Group_pcic==2,]$Group_pcic = &quot;repeated&quot;
  P3_Cat[P3_Cat$Group_pcic==3,]$Group_pcic = &quot;novel&quot;

# Create factor, get neutral as baseline
  P3_Cat$Group_pcic = factor(P3_Cat$Group_pcic, levels=c(&quot;novel&quot;,&quot;repeated&quot;))

# Set treatment contrast
  contrasts(P3_Cat$Group_pcic) = contr.sum(2)/2

           
# Add contrast columns
  mm_P3_Cat =  model.matrix( ~ Group_pcic, P3_Cat) 

# Attach to dataframe
  P3_Cat[,(ncol(P3_Cat)+1):(ncol(P3_Cat)+2)] = mm_P3_Cat
  names(P3_Cat)[(ncol(P3_Cat)-1):ncol(P3_Cat)] = c(&quot;Mean&quot;,&quot;Nov_Rep&quot;) 

# Get model 
  mod_P3_cat.lmer1 = lmer(mean_ROI_P3 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1 + Nov_Rep||ID) +
                            (1 + Nov_Rep||Stim_Type),
                          data = P3_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# 1st: check how many zero variance terms you got in random effects
  summary(rePCA(mod_P3_cat.lmer1))

# 2nd: check which random terms explain the least variance
  print(VarCorr(mod_P3_cat.lmer1),comp = &quot;Variance&quot;)

# Improved model
  mod_P3_cat.lmer2 = lmer(mean_ROI_P3 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1 + Nov_Rep||ID) +
                            (0 + Nov_Rep|Stim_Type),
                          data = P3_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# Re-check the model  
  summary(rePCA(mod_P3_cat.lmer2))
  print(VarCorr(mod_P3_cat.lmer2),comp = &quot;Variance&quot;)

## Likelhood ratio testing

# ID
  mod_P3_cat.lmer3 = lmer(mean_ROI_P3 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1|ID) +
                            (0 + Nov_Rep|Stim_Type),
                          data = P3_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P3_cat.lmer2,mod_P3_cat.lmer3)

# Stim_Type
  mod_P3_cat.lmer4 = lmer(mean_ROI_P3 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1|ID) +
                            (1|Stim_Type),
                          data = P3_Cat,
                          control=lmerControl(calc.derivs = FALSE))

# Calculate ANOVA
  anova(mod_P3_cat.lmer2,mod_P3_cat.lmer4)


# Final model
  mod_P3_cat.lmer4 = lmer(mean_ROI_P3 ~ 
                            Nov_Rep + scale(Age) + scale(WM) + 
                            (1|ID) +
                            (0 + Nov_Rep|Stim_Type),
                          data = P3_Cat,
                          control=lmerControl(calc.derivs = FALSE))</code></pre>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID) + (0 + ,     Nov_Rep | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals-1" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<pre class="r"><code>## Check properties of DV / residuals 
  P3_Cat$Trans_P3 = P3_Cat$mean_ROI_P3 + 1 - min(P3_Cat$mean_ROI_P3)

# To make sure residuals follow ND: Calculate box-cox plot
  boxcox(P3_Cat$Trans_P3 ~ P3_Cat$Group_pcic)   </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_box-1.png" width="576" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<pre class="r"><code># Visualize normality assumption of residuals (without log transform)
  mod_P3_Cat = lm(Trans_P3 ~ Group_pcic, data=P3_Cat)
  res.mod_P3_Cat = residuals(mod_P3_Cat)

  par(mfrow=c(1,2))
  qqpl_mod_P3_Cat = qqPlot(res.mod_P3_Cat, main=&quot;QQplot before transformation&quot;)    
  norm_mod_P3_Cat = plot(density(res.mod_P3_Cat), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_plot-1.png" width="576" /></p>
<pre class="r"><code>  par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm_p3-homoscedasticity-1" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<pre class="r"><code># Check homoscedasticity  
  plot(fitted(mod_P3_cat.lmer4), residuals(mod_P3_cat.lmer4))
  abline(0, 0)  </code></pre>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_homosk-1.png" width="576" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results-1" class="section level4">
<h4><strong>Results</strong></h4>
<p>In contrast to our hypothesis, we did not find P1 amplitude difference between trials with novel in contrast to repeated emotions. We also failed to find a significant effect of novelty for N170 amplitudes. Neither the main effect of hemisphere nor the interaction of hemisphere with novelty was significant. P3 amplitudes did not differ for novelty either.</p>
<pre class="r"><code># Define labels
  labels = c(&quot;Intercept&quot;,&quot;Novel vs Repeated&quot;, &quot;Age&quot;, &quot;Working Memory&quot;,&quot;NvsR X ROI&quot;, &quot;ROI&quot;)

# Create table
  tab_model(mod_P1_cat.lmer4, mod_N170_cat.lmer4, mod_P3_cat.lmer4, 
            pred.labels=labels,
            string.est = &quot;b&quot;,
            show.se=TRUE, string.se = &quot;SE&quot;,
            show.stat=TRUE, string.stat = &quot;t&quot;,
            show.ci = FALSE, 
            show.re.var = TRUE, show.obs = TRUE,
            emph.p = TRUE, dv.labels=c(&quot;P1 Amplitudes&quot;,&quot;N170 Amplitudes&quot;,&quot;P3 Amplitudes&quot;),
            show.icc = TRUE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
16.83
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
15.42
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-6.80
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-10.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
10.95
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
8.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.54
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.076
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.738
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.925
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.084
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.282
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.176
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.728
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.383
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.953
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
NvsR X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.779
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.224
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
180.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
147.48
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
231.64
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.48 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28.36 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
11.89 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
38.39 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>11</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
13.85 <sub>ID.1.Elect_siteright</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ρ<sub>01</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.41 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
40 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
40 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1170
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2340
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1170
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.025 / NA
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.006 / 0.006
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.011 / 0.152
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
<p><br></p>
</div>
</div>
<div id="session-info" class="section level3">
<h3>Session info</h3>
<!-- Provide session info  -->
<pre class="r"><code># Get session info 
  sessionInfo()</code></pre>
<pre><code>## R version 3.6.2 (2019-12-12)
## Platform: x86_64-w64-mingw32/x64 (64-bit)
## Running under: Windows 10 x64 (build 16299)
## 
## Matrix products: default
## 
## locale:
## [1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
## [3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
## [5] LC_TIME=German_Germany.1252    
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] gvlma_1.0.0.3        eegUtils_0.5.0       akima_0.6-2         
##  [4] forcats_0.5.0        stringr_1.4.0        purrr_0.3.4         
##  [7] readr_1.3.1          tidyr_1.0.2          tibble_3.0.1        
## [10] tidyverse_1.3.0      sjlabelled_1.1.3     sjmisc_2.8.4        
## [13] sjPlot_2.8.3         Rmisc_1.5            plyr_1.8.6          
## [16] reshape2_1.4.4       psych_1.9.12.31      MASS_7.3-51.5       
## [19] lmerTest_3.1-2       lme4_1.1-23          Matrix_1.2-18       
## [22] Hmisc_4.4-0          Formula_1.2-3        survival_3.1-8      
## [25] lattice_0.20-38      ggstatsplot_0.4.0    ez_4.4-0            
## [28] EnvStats_2.3.1       eeptools_1.2.2       ggplot2_3.3.0       
## [31] dplyr_0.8.5          cowplot_1.0.0        table1_1.2          
## [34] miceadds_3.9-14      mice_3.9.0           XLConnectJars_0.2-15
## [37] XLConnect_1.0.1      kableExtra_1.1.0    
## 
## loaded via a namespace (and not attached):
##   [1] estimability_1.3          R.methodsS3_1.8.0        
##   [3] coda_0.19-3               acepack_1.4.1            
##   [5] knitr_1.28                R.utils_2.9.2            
##   [7] multcomp_1.4-13           data.table_1.12.8        
##   [9] rpart_4.1-15              inline_0.3.15            
##  [11] generics_0.0.2            callr_3.4.3              
##  [13] TH.data_1.0-10            future_1.17.0            
##  [15] correlation_0.2.0         lubridate_1.7.8          
##  [17] webshot_0.5.2             xml2_1.3.1               
##  [19] httpuv_1.5.2              StanHeaders_2.21.0-1     
##  [21] assertthat_0.2.1          viridis_0.5.1            
##  [23] WRS2_1.0-0                xfun_0.13                
##  [25] hms_0.5.3                 rJava_0.9-12             
##  [27] evaluate_0.14             promises_1.1.0           
##  [29] tidyBF_0.2.0              fansi_0.4.1              
##  [31] dbplyr_1.4.3              readxl_1.3.1             
##  [33] DBI_1.1.0                 htmlwidgets_1.5.1        
##  [35] reshape_0.8.8             stats4_3.6.2             
##  [37] paletteer_1.1.0           ellipsis_0.3.0           
##  [39] rcompanion_2.3.25         backports_1.1.6          
##  [41] signal_0.7-6              insight_0.8.3            
##  [43] ggcorrplot_0.1.3          libcoin_1.0-5            
##  [45] jmvcore_1.2.5             vctrs_0.2.4              
##  [47] abind_1.4-5               withr_2.2.0              
##  [49] metaBMA_0.6.2             bdsmatrix_1.3-4          
##  [51] checkmate_2.0.0           emmeans_1.4.6            
##  [53] vcd_1.4-7                 prettyunits_1.1.1        
##  [55] mnormt_1.5-6              fastGHQuad_1.0           
##  [57] cluster_2.1.0             lazyeval_0.2.2           
##  [59] crayon_1.3.4              labeling_0.3             
##  [61] pkgconfig_2.0.3           nlme_3.1-147             
##  [63] statsExpressions_0.4.1    palr_0.2.0               
##  [65] nnet_7.3-12               pals_1.6                 
##  [67] globals_0.12.5            rlang_0.4.5              
##  [69] lifecycle_0.2.0           miniUI_0.1.1.1           
##  [71] groupedstats_0.2.2        skimr_2.1.1              
##  [73] LaplacesDemon_16.1.4      MatrixModels_0.4-1       
##  [75] sandwich_2.5-1            EMT_1.1                  
##  [77] modelr_0.1.6              dichromat_2.0-0          
##  [79] cellranger_1.1.0          matrixStats_0.56.0       
##  [81] broomExtra_4.0.0          lmtest_0.9-37            
##  [83] loo_2.2.0                 mc2d_0.1-18              
##  [85] carData_3.0-3             boot_1.3-23              
##  [87] zoo_1.8-7                 reprex_0.3.0             
##  [89] base64enc_0.1-3           processx_3.4.2           
##  [91] png_0.1-7                 viridisLite_0.3.0        
##  [93] rjson_0.2.20              ini_0.3.1                
##  [95] oompaBase_3.2.9           shinydashboard_0.7.1     
##  [97] parameters_0.6.1          R.oo_1.23.0              
##  [99] ggExtra_0.9               multcompView_0.1-8       
## [101] maptools_0.9-9            coin_1.3-1               
## [103] arm_1.10-1                jpeg_0.1-8.1             
## [105] ggeffects_0.14.3          ggsignif_0.6.0           
## [107] scales_1.1.0              magrittr_1.5             
## [109] compiler_3.6.2            rstantools_2.0.0         
## [111] bbmle_1.0.23.1            RColorBrewer_1.1-2       
## [113] edfReader_1.2.1           cli_2.0.2                
## [115] listenv_0.8.0             pbapply_1.4-2            
## [117] ps_1.3.2                  TMB_1.7.16               
## [119] Brobdingnag_1.2-6         htmlTable_1.13.3         
## [121] mgcv_1.8-31               tidyselect_1.0.0         
## [123] stringi_1.4.6             highr_0.8                
## [125] mitools_2.4               yaml_2.2.1               
## [127] latticeExtra_0.6-29       ggrepel_0.8.2            
## [129] bridgesampling_1.0-0      grid_3.6.2               
## [131] tools_3.6.2               future.apply_1.5.0       
## [133] parallel_3.6.2            rio_0.5.16               
## [135] rstudioapi_0.11           foreign_0.8-72           
## [137] gridExtra_2.3             ipmisc_2.0.0             
## [139] pairwiseComparisons_0.3.0 farver_2.0.3             
## [141] digest_0.6.23             pracma_2.2.9             
## [143] shiny_1.4.0.2             nortest_1.0-4            
## [145] jmv_1.2.5                 Rcpp_1.0.3               
## [147] car_3.0-7                 broom_0.5.6              
## [149] metafor_2.4-0             BayesFactor_0.9.12-4.2   
## [151] performance_0.4.5         metaplus_0.7-11          
## [153] later_1.0.0               httr_1.4.1               
## [155] effectsize_0.3.0          sjstats_0.17.9           
## [157] colorspace_1.4-1          fs_1.4.1                 
## [159] rvest_0.3.5               splines_3.6.2            
## [161] statmod_1.4.34            rematch2_2.1.1           
## [163] expm_0.999-4              sp_1.4-1                 
## [165] mapproj_1.2.7             plotly_4.9.2.1           
## [167] jcolors_0.0.4             xtable_1.8-4             
## [169] jsonlite_1.6.1            nloptr_1.2.2.1           
## [171] rstan_2.19.3              zeallot_0.1.0            
## [173] modeltools_0.2-23         scico_1.1.0              
## [175] R6_2.4.1                  broom.mixed_0.2.5        
## [177] pillar_1.4.3              htmltools_0.4.0          
## [179] mime_0.9                  glue_1.4.0               
## [181] fastmap_1.0.1             minqa_1.2.4              
## [183] codetools_0.2-16          maps_3.3.0               
## [185] pkgbuild_1.0.6            mvtnorm_1.1-0            
## [187] numDeriv_2016.8-1.1       curl_4.3                 
## [189] DescTools_0.99.34         gtools_3.8.2             
## [191] logspline_2.1.15          zip_2.0.4                
## [193] openxlsx_4.1.4            rmarkdown_2.1            
## [195] repr_1.1.0                munsell_0.5.0            
## [197] R.matlab_3.6.2            haven_2.2.0              
## [199] gtable_0.3.0              bayestestR_0.6.0</code></pre>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
