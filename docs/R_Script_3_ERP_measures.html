<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>ERP measures</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/header-attrs-2.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    background-color: #ffffff;
    color: #a0a0a0;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #a0a0a0;  padding-left: 4px; }
div.sourceCode
  { color: #1f1c1b; background-color: #ffffff; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span { color: #1f1c1b; } /* Normal */
code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
code span.an { color: #ca60ca; } /* Annotation */
code span.at { color: #0057ae; } /* Attribute */
code span.bn { color: #b08000; } /* BaseN */
code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code span.ch { color: #924c9d; } /* Char */
code span.cn { color: #aa5500; } /* Constant */
code span.co { color: #898887; } /* Comment */
code span.cv { color: #0095ff; } /* CommentVar */
code span.do { color: #607880; } /* Documentation */
code span.dt { color: #0057ae; } /* DataType */
code span.dv { color: #b08000; } /* DecVal */
code span.er { color: #bf0303; text-decoration: underline; } /* Error */
code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code span.fl { color: #b08000; } /* Float */
code span.fu { color: #644a9b; } /* Function */
code span.im { color: #ff5500; } /* Import */
code span.in { color: #b08000; } /* Information */
code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code span.op { color: #1f1c1b; } /* Operator */
code span.ot { color: #006e28; } /* Other */
code span.pp { color: #006e28; } /* Preprocessor */
code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
code span.sc { color: #3daee9; } /* SpecialChar */
code span.ss { color: #ff5500; } /* SpecialString */
code span.st { color: #bf0303; } /* String */
code span.va { color: #0057ae; } /* Variable */
code span.vs { color: #bf0303; } /* VerbatimString */
code span.wa { color: #bf0303; } /* Warning */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">ERP measures</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#task-description">Task description</a></li>
        <li><a href="#valence-effects">Valence effects</a></li>
        <li><a href="#repetition-effects">Repetition effects</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Del. matched-to-sample task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load data set -->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>We developed a novel paradigm to examine ERP responses to novel and repeated emotional faces. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the emotional expression displayed (happy, fearful or neutral).</p>
<p>We calculated linear mixed models (LMM) separately for each ERP component. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all linear mixed model analyses to control for cognitive abilities of the children as well as potential age differences.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
</div>
<div id="valence-effects" class="section level1">
<h1>Valence effects</h1>
<p>We predicted that ERP amplitudes of sensory (P1, N170) and higher-order (P3) components would be larger for emotional compared to neutral facial expressions. We examined this hypothesis in response to Face 1.</p>
<p><br></p>
<div id="descriptive-statistics" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true"></a><span class="co">## P1/P3 trajectories</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true"></a>Face1_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true"></a>Face1_data =<span class="st"> </span>Face1_data[<span class="kw">with</span>(Face1_data, <span class="op">!</span>(Face1_data<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true"></a><span class="co"># Select time window</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true"></a>Face1_data =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), ]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true"></a><span class="co"># Rename conditions</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true"></a>Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true"></a></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true"></a><span class="co"># Select conditions of interest</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true"></a>Face1_data_all_emo_sep =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true"></a>Face1_data_all_emo_sep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true"></a></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true"></a><span class="co"># Plot data</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true"></a>P1_P3_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_data_all_emo_sep, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, </span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true"></a>    <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>), <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.6</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>, </span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true"></a>    mu, <span class="st">&quot;V]&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true"></a>    <span class="dv">16</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">16</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">110</span>, </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="dv">14</span>, <span class="dt">label =</span> <span class="st">&quot;P1&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">350</span>, <span class="dt">y =</span> <span class="dv">14</span>, </span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true"></a>    <span class="dt">label =</span> <span class="st">&quot;P3&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>)</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true"></a></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true"></a></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true"></a><span class="co">## N170 trajectories</span></span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true"></a></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true"></a><span class="co"># Load data</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/left_ROI_N170_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/right_ROI_N170_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true"></a></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), </span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true"></a>    ]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>) <span class="op">&amp;</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>), </span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true"></a>    ]</span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true"></a></span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true"></a>Face1_data_l =<span class="st"> </span>Face1_data_l[<span class="kw">with</span>(Face1_data_l, <span class="op">!</span>(Face1_data_l<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true"></a>Face1_data_r =<span class="st"> </span>Face1_data_r[<span class="kw">with</span>(Face1_data_r, <span class="op">!</span>(Face1_data_r<span class="op">$</span>ID <span class="op">==</span><span class="st"> &quot;05&quot;</span>)), ]</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true"></a></span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true"></a><span class="co"># Rename conditions</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true"></a>Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true"></a></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true"></a>Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true"></a></span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true"></a><span class="co"># Select conditions of interest</span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true"></a>Face1_data_all_emo_sep_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true"></a></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true"></a>Face1_data_all_emo_sep_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;happy&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span></span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true"></a><span class="st">    &quot;angry&quot;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &quot;neutral&quot;</span>), ]</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true"></a><span class="co"># Factor and level emotion</span></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true"></a>Face1_data_all_emo_sep_l<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_l<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true"></a></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true"></a>Face1_data_all_emo_sep_r<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_r<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, </span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true"></a>    <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true"></a></span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true"></a><span class="co"># Average N170 trajectories for left and right hemisphere</span></span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true"></a>Face1_N170 =<span class="st"> </span>(Face1_data_all_emo_sep_l <span class="op">+</span><span class="st"> </span>Face1_data_all_emo_sep_r)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true"></a>Face1_N170<span class="op">$</span>Condition =<span class="st"> </span>Face1_data_all_emo_sep_l<span class="op">$</span>Condition</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true"></a></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true"></a><span class="co"># Plot N170 trajectory</span></span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true"></a>N170_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_N170, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, </span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true"></a>        <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">7</span>), </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true"></a>    <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>), <span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.6</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, </span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true"></a>    <span class="dv">6</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">200</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_text</span>(<span class="dt">x =</span> <span class="dv">200</span>, </span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true"></a>    <span class="dt">y =</span> <span class="fl">-5.2</span>, <span class="dt">label =</span> <span class="st">&quot;N170&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>)</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true"></a></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true"></a><span class="co"># Load topography information</span></span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file =</span> <span class="st">&quot;./data/ERPs_Topo_Face1.csv&quot;</span>, <span class="dt">header =</span> <span class="ot">TRUE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true"></a><span class="co"># Exclude participant</span></span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span>Topo_Emo[<span class="kw">with</span>(Topo_Emo, <span class="op">!</span>(Topo_Emo<span class="op">$</span>ID <span class="op">==</span><span class="st"> </span><span class="dv">5</span>)), ]</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true"></a></span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb1-111"><a href="#cb1-111" aria-hidden="true"></a>Topo_Emo =<span class="st"> </span><span class="kw">gather</span>(Topo_Emo, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb1-112"><a href="#cb1-112" aria-hidden="true"></a></span>
<span id="cb1-113"><a href="#cb1-113" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb1-114"><a href="#cb1-114" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb1-115"><a href="#cb1-115" aria-hidden="true"></a><span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb1-116"><a href="#cb1-116" aria-hidden="true"></a></span>
<span id="cb1-117"><a href="#cb1-117" aria-hidden="true"></a><span class="co"># Plot topoplots for happy</span></span>
<span id="cb1-118"><a href="#cb1-118" aria-hidden="true"></a>Topo_Emo_Hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb1-119"><a href="#cb1-119" aria-hidden="true"></a></span>
<span id="cb1-120"><a href="#cb1-120" aria-hidden="true"></a><span class="co"># Plot topoplots for neutral</span></span>
<span id="cb1-121"><a href="#cb1-121" aria-hidden="true"></a>Topo_Emo_Neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb1-122"><a href="#cb1-122" aria-hidden="true"></a></span>
<span id="cb1-123"><a href="#cb1-123" aria-hidden="true"></a><span class="co"># Plot topoplots for angry</span></span>
<span id="cb1-124"><a href="#cb1-124" aria-hidden="true"></a>Topo_Emo_Ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)</span>
<span id="cb1-125"><a href="#cb1-125" aria-hidden="true"></a></span>
<span id="cb1-126"><a href="#cb1-126" aria-hidden="true"></a><span class="co"># Calculate difference score angry-neutral</span></span>
<span id="cb1-127"><a href="#cb1-127" aria-hidden="true"></a>Topo_Diff_Ang_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">3</span>], </span>
<span id="cb1-128"><a href="#cb1-128" aria-hidden="true"></a>    <span class="dt">electrode =</span> Topo_Emo_Hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
<span id="cb1-129"><a href="#cb1-129" aria-hidden="true"></a></span>
<span id="cb1-130"><a href="#cb1-130" aria-hidden="true"></a></span>
<span id="cb1-131"><a href="#cb1-131" aria-hidden="true"></a><span class="co"># Calculate difference score happy-neutral</span></span>
<span id="cb1-132"><a href="#cb1-132" aria-hidden="true"></a>Topo_Diff_Hap_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[, <span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[, <span class="dv">3</span>], </span>
<span id="cb1-133"><a href="#cb1-133" aria-hidden="true"></a>    <span class="dt">electrode =</span> Topo_Emo_Hap[, <span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)</span>
<span id="cb1-134"><a href="#cb1-134" aria-hidden="true"></a></span>
<span id="cb1-135"><a href="#cb1-135" aria-hidden="true"></a><span class="co">## P1s</span></span>
<span id="cb1-136"><a href="#cb1-136" aria-hidden="true"></a></span>
<span id="cb1-137"><a href="#cb1-137" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb1-138"><a href="#cb1-138" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)</span>
<span id="cb1-139"><a href="#cb1-139" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)</span>
<span id="cb1-140"><a href="#cb1-140" aria-hidden="true"></a></span>
<span id="cb1-141"><a href="#cb1-141" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb1-142"><a href="#cb1-142" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-143"><a href="#cb1-143" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-144"><a href="#cb1-144" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-145"><a href="#cb1-145" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-146"><a href="#cb1-146" aria-hidden="true"></a></span>
<span id="cb1-147"><a href="#cb1-147" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-148"><a href="#cb1-148" aria-hidden="true"></a>topo_diff_ang_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-149"><a href="#cb1-149" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb1-150"><a href="#cb1-150" aria-hidden="true"></a>    <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb1-151"><a href="#cb1-151" aria-hidden="true"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, </span>
<span id="cb1-152"><a href="#cb1-152" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-153"><a href="#cb1-153" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">6</span>))</span>
<span id="cb1-154"><a href="#cb1-154" aria-hidden="true"></a></span>
<span id="cb1-155"><a href="#cb1-155" aria-hidden="true"></a></span>
<span id="cb1-156"><a href="#cb1-156" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-157"><a href="#cb1-157" aria-hidden="true"></a>topo_diff_hap_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-158"><a href="#cb1-158" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb1-159"><a href="#cb1-159" aria-hidden="true"></a>    <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb1-160"><a href="#cb1-160" aria-hidden="true"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, </span>
<span id="cb1-161"><a href="#cb1-161" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-162"><a href="#cb1-162" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb1-163"><a href="#cb1-163" aria-hidden="true"></a></span>
<span id="cb1-164"><a href="#cb1-164" aria-hidden="true"></a><span class="co">## N170s</span></span>
<span id="cb1-165"><a href="#cb1-165" aria-hidden="true"></a></span>
<span id="cb1-166"><a href="#cb1-166" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb1-167"><a href="#cb1-167" aria-hidden="true"></a>Topo_Diff_Ang_Neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)</span>
<span id="cb1-168"><a href="#cb1-168" aria-hidden="true"></a>Topo_Diff_Hap_Neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)</span>
<span id="cb1-169"><a href="#cb1-169" aria-hidden="true"></a></span>
<span id="cb1-170"><a href="#cb1-170" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb1-171"><a href="#cb1-171" aria-hidden="true"></a>Topo_Diff_Ang_Neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-172"><a href="#cb1-172" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-173"><a href="#cb1-173" aria-hidden="true"></a>Topo_Diff_Hap_Neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-174"><a href="#cb1-174" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-175"><a href="#cb1-175" aria-hidden="true"></a></span>
<span id="cb1-176"><a href="#cb1-176" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-177"><a href="#cb1-177" aria-hidden="true"></a>topo_diff_ang_neu_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-178"><a href="#cb1-178" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (180-220 ms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb1-179"><a href="#cb1-179" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-180"><a href="#cb1-180" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-181"><a href="#cb1-181" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb1-182"><a href="#cb1-182" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">6</span>))</span>
<span id="cb1-183"><a href="#cb1-183" aria-hidden="true"></a></span>
<span id="cb1-184"><a href="#cb1-184" aria-hidden="true"></a></span>
<span id="cb1-185"><a href="#cb1-185" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-186"><a href="#cb1-186" aria-hidden="true"></a>topo_diff_hap_neu_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-187"><a href="#cb1-187" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb1-188"><a href="#cb1-188" aria-hidden="true"></a>    <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb1-189"><a href="#cb1-189" aria-hidden="true"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, </span>
<span id="cb1-190"><a href="#cb1-190" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-191"><a href="#cb1-191" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb1-192"><a href="#cb1-192" aria-hidden="true"></a></span>
<span id="cb1-193"><a href="#cb1-193" aria-hidden="true"></a><span class="co">## P3s</span></span>
<span id="cb1-194"><a href="#cb1-194" aria-hidden="true"></a></span>
<span id="cb1-195"><a href="#cb1-195" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb1-196"><a href="#cb1-196" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)</span>
<span id="cb1-197"><a href="#cb1-197" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)</span>
<span id="cb1-198"><a href="#cb1-198" aria-hidden="true"></a></span>
<span id="cb1-199"><a href="#cb1-199" aria-hidden="true"></a><span class="co"># Add electrode information</span></span>
<span id="cb1-200"><a href="#cb1-200" aria-hidden="true"></a>Topo_Diff_Ang_Neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-201"><a href="#cb1-201" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-202"><a href="#cb1-202" aria-hidden="true"></a>Topo_Diff_Hap_Neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>, </span>
<span id="cb1-203"><a href="#cb1-203" aria-hidden="true"></a>    <span class="dt">drop =</span> <span class="ot">FALSE</span>, <span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb1-204"><a href="#cb1-204" aria-hidden="true"></a></span>
<span id="cb1-205"><a href="#cb1-205" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-206"><a href="#cb1-206" aria-hidden="true"></a>topo_diff_ang_neu_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-207"><a href="#cb1-207" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-500 ms)&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, </span>
<span id="cb1-208"><a href="#cb1-208" aria-hidden="true"></a>    <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-209"><a href="#cb1-209" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-210"><a href="#cb1-210" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, </span>
<span id="cb1-211"><a href="#cb1-211" aria-hidden="true"></a>    <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">6</span>))</span>
<span id="cb1-212"><a href="#cb1-212" aria-hidden="true"></a></span>
<span id="cb1-213"><a href="#cb1-213" aria-hidden="true"></a></span>
<span id="cb1-214"><a href="#cb1-214" aria-hidden="true"></a><span class="co"># Draw topographies</span></span>
<span id="cb1-215"><a href="#cb1-215" aria-hidden="true"></a>topo_diff_hap_neu_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-216"><a href="#cb1-216" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb1-217"><a href="#cb1-217" aria-hidden="true"></a>    <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.5</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb1-218"><a href="#cb1-218" aria-hidden="true"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, </span>
<span id="cb1-219"><a href="#cb1-219" aria-hidden="true"></a>    mu, <span class="st">&quot;V)&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, </span>
<span id="cb1-220"><a href="#cb1-220" aria-hidden="true"></a>    <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb1-221"><a href="#cb1-221" aria-hidden="true"></a></span>
<span id="cb1-222"><a href="#cb1-222" aria-hidden="true"></a></span>
<span id="cb1-223"><a href="#cb1-223" aria-hidden="true"></a><span class="co"># Get legend for trajectories</span></span>
<span id="cb1-224"><a href="#cb1-224" aria-hidden="true"></a>traj_emo =<span class="st"> </span><span class="kw">ggplot</span>(Face1_N170, <span class="kw">aes</span>(Time, ROI_Average)) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-225"><a href="#cb1-225" aria-hidden="true"></a>    <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill =</span> <span class="ot">NA</span>, <span class="dt">size =</span> <span class="dv">2</span>), <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, </span>
<span id="cb1-226"><a href="#cb1-226" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, </span>
<span id="cb1-227"><a href="#cb1-227" aria-hidden="true"></a>        <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)), <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>), <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-228"><a href="#cb1-228" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour =</span> Condition)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-229"><a href="#cb1-229" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-230"><a href="#cb1-230" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>, <span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)), <span class="dt">colour =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>, </span>
<span id="cb1-231"><a href="#cb1-231" aria-hidden="true"></a>    <span class="dv">6</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>, <span class="dv">600</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>, <span class="dv">6</span>, <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>, </span>
<span id="cb1-232"><a href="#cb1-232" aria-hidden="true"></a>    <span class="dv">600</span>, <span class="dv">100</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-233"><a href="#cb1-233" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb1-234"><a href="#cb1-234" aria-hidden="true"></a></span>
<span id="cb1-235"><a href="#cb1-235" aria-hidden="true"></a>traj_leg_emo =<span class="st"> </span><span class="kw">get_legend</span>(traj_emo)</span>
<span id="cb1-236"><a href="#cb1-236" aria-hidden="true"></a></span>
<span id="cb1-237"><a href="#cb1-237" aria-hidden="true"></a><span class="co"># Get legend for topos</span></span>
<span id="cb1-238"><a href="#cb1-238" aria-hidden="true"></a>topo_leg_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-239"><a href="#cb1-239" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb1-240"><a href="#cb1-240" aria-hidden="true"></a>    <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, </span>
<span id="cb1-241"><a href="#cb1-241" aria-hidden="true"></a>    <span class="dv">2</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-242"><a href="#cb1-242" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>)</span>
<span id="cb1-243"><a href="#cb1-243" aria-hidden="true"></a></span>
<span id="cb1-244"><a href="#cb1-244" aria-hidden="true"></a>topo_leg_P1 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_P1)</span>
<span id="cb1-245"><a href="#cb1-245" aria-hidden="true"></a></span>
<span id="cb1-246"><a href="#cb1-246" aria-hidden="true"></a></span>
<span id="cb1-247"><a href="#cb1-247" aria-hidden="true"></a>topo_leg_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, </span>
<span id="cb1-248"><a href="#cb1-248" aria-hidden="true"></a>    <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, </span>
<span id="cb1-249"><a href="#cb1-249" aria-hidden="true"></a>    <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, </span>
<span id="cb1-250"><a href="#cb1-250" aria-hidden="true"></a>    <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">3</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, </span>
<span id="cb1-251"><a href="#cb1-251" aria-hidden="true"></a>    mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>)</span>
<span id="cb1-252"><a href="#cb1-252" aria-hidden="true"></a></span>
<span id="cb1-253"><a href="#cb1-253" aria-hidden="true"></a></span>
<span id="cb1-254"><a href="#cb1-254" aria-hidden="true"></a>topo_leg_N170 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_N170)</span>
<span id="cb1-255"><a href="#cb1-255" aria-hidden="true"></a></span>
<span id="cb1-256"><a href="#cb1-256" aria-hidden="true"></a></span>
<span id="cb1-257"><a href="#cb1-257" aria-hidden="true"></a>topo_leg_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-258"><a href="#cb1-258" aria-hidden="true"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, </span>
<span id="cb1-259"><a href="#cb1-259" aria-hidden="true"></a>    <span class="dt">chan_size =</span> <span class="dv">2</span>, <span class="dt">head_size =</span> <span class="fl">0.9</span>) <span class="op">+</span><span class="st"> </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span>, <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, </span>
<span id="cb1-260"><a href="#cb1-260" aria-hidden="true"></a>    <span class="dv">4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_equal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, mu, <span class="st">&quot;V&quot;</span>))) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-261"><a href="#cb1-261" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>)</span>
<span id="cb1-262"><a href="#cb1-262" aria-hidden="true"></a></span>
<span id="cb1-263"><a href="#cb1-263" aria-hidden="true"></a>topo_leg_P3 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_P3)</span>
<span id="cb1-264"><a href="#cb1-264" aria-hidden="true"></a></span>
<span id="cb1-265"><a href="#cb1-265" aria-hidden="true"></a></span>
<span id="cb1-266"><a href="#cb1-266" aria-hidden="true"></a><span class="co"># Get difference labels</span></span>
<span id="cb1-267"><a href="#cb1-267" aria-hidden="true"></a>text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Angry-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Neutral</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-268"><a href="#cb1-268" aria-hidden="true"></a></span>
<span id="cb1-269"><a href="#cb1-269" aria-hidden="true"></a>ang_neu_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-270"><a href="#cb1-270" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-271"><a href="#cb1-271" aria-hidden="true"></a>    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>), <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-272"><a href="#cb1-272" aria-hidden="true"></a>    <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-273"><a href="#cb1-273" aria-hidden="true"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>), <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</span>
<span id="cb1-274"><a href="#cb1-274" aria-hidden="true"></a></span>
<span id="cb1-275"><a href="#cb1-275" aria-hidden="true"></a>text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Happy-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Neutral</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-276"><a href="#cb1-276" aria-hidden="true"></a></span>
<span id="cb1-277"><a href="#cb1-277" aria-hidden="true"></a>hap_neu_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size =</span> <span class="dv">4</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-278"><a href="#cb1-278" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-279"><a href="#cb1-279" aria-hidden="true"></a>    <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>), <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-280"><a href="#cb1-280" aria-hidden="true"></a>    <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(), <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(), </span>
<span id="cb1-281"><a href="#cb1-281" aria-hidden="true"></a>    <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>), <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</span>
<span id="cb1-282"><a href="#cb1-282" aria-hidden="true"></a></span>
<span id="cb1-283"><a href="#cb1-283" aria-hidden="true"></a><span class="co"># Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)</span></span>
<span id="cb1-284"><a href="#cb1-284" aria-hidden="true"></a><span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.4</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(P1_P3_val_traj, <span class="fl">0.05</span>, <span class="fl">0.7</span>, </span>
<span id="cb1-285"><a href="#cb1-285" aria-hidden="true"></a>    <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(N170_val_traj, <span class="fl">0.55</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(traj_leg_emo, </span>
<span id="cb1-286"><a href="#cb1-286" aria-hidden="true"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(ang_neu_text, <span class="fl">-0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(hap_neu_text, </span>
<span id="cb1-287"><a href="#cb1-287" aria-hidden="true"></a>    <span class="fl">-0.05</span>, <span class="fl">-0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_P1, <span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-288"><a href="#cb1-288" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_P1, <span class="fl">0.12</span>, <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_leg_P1, <span class="fl">0.37</span>, </span>
<span id="cb1-289"><a href="#cb1-289" aria-hidden="true"></a>    <span class="fl">0.25</span>, <span class="fl">0.14</span>, <span class="fl">0.14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_N170, <span class="fl">0.47</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-290"><a href="#cb1-290" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_N170, <span class="fl">0.47</span>, <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_leg_N170, </span>
<span id="cb1-291"><a href="#cb1-291" aria-hidden="true"></a>    <span class="fl">0.72</span>, <span class="fl">0.25</span>, <span class="fl">0.14</span>, <span class="fl">0.14</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_P3, <span class="fl">0.82</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb1-292"><a href="#cb1-292" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_P3, <span class="fl">0.82</span>, <span class="dv">0</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span><span class="kw">draw_plot</span>(topo_leg_P3, <span class="fl">1.07</span>, </span>
<span id="cb1-293"><a href="#cb1-293" aria-hidden="true"></a>    <span class="fl">0.25</span>, <span class="fl">0.14</span>, <span class="fl">0.14</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_val_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br><br></p>
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills"><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true"></a><span class="co"># Select Face 1</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true"></a>P1_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true"></a>P1_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>ID)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true"></a>P1_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>Stim_Type)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true"></a><span class="co"># Re-code emotion condition</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true"></a><span class="co"># Create factor &amp; set neutral as baseline</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true"></a>P1_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Val<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true"></a>mm_P1_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition, P1_Val)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true"></a>P1_Val[, (<span class="kw">ncol</span>(P1_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Val) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_P1_Val</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true"></a><span class="kw">names</span>(P1_Val)[(<span class="kw">ncol</span>(P1_Val) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true"></a>mod_P1_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true"></a></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer1))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true"></a><span class="co"># Remove intercepts/slopes based on variance check</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true"></a>mod_P1_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true"></a></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer2))</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true"></a><span class="co"># Likelihood ratio testing</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true"></a></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true"></a><span class="co"># For ID</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true"></a>mod_P1_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true"></a></span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_val.lmer2, mod_P1_val.lmer3)</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true"></a></span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true"></a>mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true"></a></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_val.lmer2, mod_P1_val.lmer4)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true"></a></span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true"></a></span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true"></a>mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> P1_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true"></a>P1_Val<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Val<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Val<span class="op">$</span>mean_ROI_P1)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Val<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Val<span class="op">$</span>Condition)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true"></a>mod_P1_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> P1_Val)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true"></a>res.mod_P1_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_val)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true"></a>qqpl_mod_P1_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true"></a>norm_mod_P1_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_p1-homoscedasticity" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_val.lmer4), <span class="kw">residuals</span>(mod_P1_val.lmer4))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true"></a><span class="co"># Transform dataset so that left/right hemisphere are accounted for</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true"></a>N170_Val =<span class="st"> </span><span class="kw">gather</span>(ERP_data, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true"></a>    <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true"></a><span class="co"># Add variable name</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Val<span class="op">$</span>Elect_site)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &quot;left&quot;</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true"></a>N170_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>ID)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true"></a>N170_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>Stim_Type)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true"></a>N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Elect_site)</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true"></a><span class="co"># Select primes</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true"></a>N170_Val =<span class="st"> </span><span class="kw">subset</span>(N170_Val, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true"></a><span class="co"># Re-code values for emotion variable</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true"></a>N170_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true"></a><span class="co"># Set contrast for hemisphere</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Elect_site) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true"></a></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true"></a></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true"></a>mm_N170_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>Condition <span class="op">*</span><span class="st"> </span>Elect_site, N170_Val)</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true"></a></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true"></a>N170_Val[, (<span class="kw">ncol</span>(N170_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Val) <span class="op">+</span><span class="st"> </span><span class="dv">6</span>)] =<span class="st"> </span>mm_N170_Val</span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true"></a><span class="kw">names</span>(N170_Val)[(<span class="kw">ncol</span>(N170_Val) <span class="op">-</span><span class="st"> </span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>, </span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true"></a>    <span class="st">&quot;Elect_site&quot;</span>, <span class="st">&quot;Hap_NeuxElect_site&quot;</span>, <span class="st">&quot;Ang_NeuxElect_site&quot;</span>)</span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true"></a></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true"></a><span class="co"># Get model</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true"></a>mod_N170_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true"></a><span class="st">    </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true"></a><span class="st">    </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true"></a><span class="st">    </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true"></a></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer1))</span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true"></a></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true"></a></span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true"></a><span class="co"># Improved model</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true"></a>mod_N170_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true"></a><span class="st">    </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), <span class="dt">data =</span> N170_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer2))</span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). For the N170, we also included a scaled sum contrast for hemisphere (<code>Elect_site</code>) as well as an interaction of emotional facial expressions with hemisphere. The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + ,     scale(Age) + scale(WM) + (1 | ID)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true"></a>N170_Val<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Val<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Val<span class="op">$</span>N170_Amplitude)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Val<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Val<span class="op">$</span>Condition)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true"></a>mod_N170_val =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> N170_Val)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true"></a>res.mod_N170_val =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_val)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true"></a>qqpl_mod_N170_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true"></a>norm_mod_N170_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_n170-homoscedasticity" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_val.lmer2), <span class="kw">residuals</span>(mod_N170_val.lmer2))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true"></a><span class="co"># Select primes</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true"></a>P3_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true"></a>P3_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>ID)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true"></a>P3_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>Stim_Type)</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true"></a><span class="co"># Re-Name values of emotion condition</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true"></a>P3_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Val<span class="op">$</span>Condition, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>, <span class="st">&quot;happy&quot;</span>, <span class="st">&quot;angry&quot;</span>))</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true"></a>mm_P3_Val =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Condition, P3_Val)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true"></a>P3_Val[, (<span class="kw">ncol</span>(P3_Val) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Val) <span class="op">+</span><span class="st"> </span><span class="dv">3</span>)] =<span class="st"> </span>mm_P3_Val</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true"></a><span class="kw">names</span>(P3_Val)[(<span class="kw">ncol</span>(P3_Val) <span class="op">-</span><span class="st"> </span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true"></a><span class="co"># Get model</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true"></a>mod_P3_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, </span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true"></a></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer1))</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true"></a></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true"></a><span class="co"># Improved model</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true"></a>mod_P3_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true"></a></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer2))</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true"></a></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true"></a></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true"></a><span class="co"># Likelihood ratio testing</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true"></a></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true"></a><span class="co"># Stimulus type</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true"></a>mod_P3_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true"></a></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_val.lmer2, mod_P3_val.lmer3)</span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true"></a></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true"></a></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true"></a>mod_P3_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Val, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true"></a>P3_Val<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Val<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Val<span class="op">$</span>mean_ROI_P3)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Val<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Val<span class="op">$</span>Condition)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true"></a>mod_P3_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data =</span> P3_Val)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true"></a>res.mod_P3_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_val)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true"></a>qqpl_mod_P3_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_val, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true"></a>norm_mod_P3_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_val), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_p3-homoscedasticity" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_val.lmer4), <span class="kw">residuals</span>(mod_P3_val.lmer4))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Present ERP valence effects -->
<p>P1 amplitudes at Face 1 were significantly larger for angry in comparison to neutral facial expressions. No difference was found for the contrast of happy vs. neutral faces. None of the covariates reached significance. In contrast to our hypothesis, no N170 amplitude differences between emotional in contrast to neutral faces were detected. Neither the main effect of hemisphere, the interaction of hemisphere with emotion, nor covariates reached significance. In line with our hypothesis, angry faces elicited larger P3 amplitudes compared to neutral faces. No difference, however, was found between happy and neutral faces. Covariates yielded no significant results.</p>
<div align="center">


<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Happy vs Neutral&quot;</span>, <span class="st">&quot;Angry vs Neutral&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;HvsN X ROI&quot;</span>, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true"></a>    <span class="st">&quot;AvsN X ROI&quot;</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_val.lmer4, mod_N170_val.lmer2, mod_P3_val.lmer4, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitudes&quot;</span>, <span class="st">&quot;N170 Amplitudes&quot;</span>, <span class="st">&quot;P3 Amplitudes&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.99
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.121
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.843
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.349
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.014</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.164
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.030</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.239
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.998
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.070
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.922
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.867
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.852
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
HvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.371
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.59
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.372
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
198.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
156.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
277.65
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
25.12 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.09 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.38 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
29.41 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.008 / 0.119
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.001 / 0.061
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.014 / 0.110
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="repetition-effects" class="section level1">
<h1>Repetition effects</h1>
<p>We hypothesized that ERP amplitudes for Face 2 would decrease in response to an identical Face 1.</p>
<p><br></p>
<div id="descriptive-statistics-1" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true"></a><span class="co">## P1 and P3</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true"></a><span class="co"># Load Face 2 data</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true"></a>  Face2_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true"></a>  Face2_data =<span class="st"> </span>Face2_data[<span class="kw">with</span>(Face2_data, <span class="op">!</span>(Face2_data<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true"></a><span class="co"># Select time window of interest</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true"></a>  Face2_data =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>),]</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true"></a><span class="co"># Rename values of Face2 condition</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true"></a>  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true"></a><span class="co"># Plot ERP trajectory for P1/P3</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true"></a>  Face2_data_icc =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true"></a>  </span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true"></a>  P1_cat_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_icc,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">15</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true"></a>          <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>))<span class="op">+</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.6</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span></span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> nov_col)<span class="op">+</span></span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true"></a><span class="st">    </span><span class="co">#ggtitle(&quot;P1 &amp; P3&quot;) +</span></span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">      </span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span></span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">18</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">120</span>, <span class="dt">y=</span><span class="fl">16.8</span>, <span class="dt">label =</span> <span class="st">&quot;P1&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>)<span class="op">+</span></span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">350</span>, <span class="dt">y=</span><span class="fl">14.8</span>, <span class="dt">label =</span> <span class="st">&quot;P3&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>)</span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true"></a></span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true"></a><span class="co">## N170</span></span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true"></a>  Face2_data_l =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/left_ROI_N170_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true"></a>  Face2_data_r =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/right_ROI_N170_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)</span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true"></a></span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true"></a><span class="co"># De-select participants</span></span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true"></a>  Face2_data_l =<span class="st"> </span>Face2_data_l[<span class="kw">with</span>(Face2_data_l, <span class="op">!</span>(Face2_data_l<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]</span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true"></a>  Face2_data_r =<span class="st"> </span>Face2_data_r[<span class="kw">with</span>(Face2_data_r, <span class="op">!</span>(Face2_data_r<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true"></a></span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true"></a><span class="co"># Select time window of interest</span></span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true"></a>  Face2_data_l =<span class="st"> </span>Face2_data_l[(Face2_data_l<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data_l<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>),]</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true"></a>  Face2_data_r =<span class="st"> </span>Face2_data_r[(Face2_data_r<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">-200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data_r<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>),]</span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true"></a></span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true"></a><span class="co"># Rename conditions</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;</span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;</span>
<span id="cb18-59"><a href="#cb18-59" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;</span>
<span id="cb18-60"><a href="#cb18-60" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;</span>
<span id="cb18-61"><a href="#cb18-61" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;</span>
<span id="cb18-62"><a href="#cb18-62" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;</span>
<span id="cb18-63"><a href="#cb18-63" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;</span>
<span id="cb18-64"><a href="#cb18-64" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;</span>
<span id="cb18-65"><a href="#cb18-65" aria-hidden="true"></a>  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;</span>
<span id="cb18-66"><a href="#cb18-66" aria-hidden="true"></a></span>
<span id="cb18-67"><a href="#cb18-67" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;</span>
<span id="cb18-68"><a href="#cb18-68" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;</span>
<span id="cb18-69"><a href="#cb18-69" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;</span>
<span id="cb18-70"><a href="#cb18-70" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;</span>
<span id="cb18-71"><a href="#cb18-71" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;</span>
<span id="cb18-72"><a href="#cb18-72" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;</span>
<span id="cb18-73"><a href="#cb18-73" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;</span>
<span id="cb18-74"><a href="#cb18-74" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;</span>
<span id="cb18-75"><a href="#cb18-75" aria-hidden="true"></a>  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;</span>
<span id="cb18-76"><a href="#cb18-76" aria-hidden="true"></a></span>
<span id="cb18-77"><a href="#cb18-77" aria-hidden="true"></a><span class="co"># Select conditions of interest</span></span>
<span id="cb18-78"><a href="#cb18-78" aria-hidden="true"></a>  Face2_data_icc_l =<span class="st"> </span>Face2_data_l[(Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]</span>
<span id="cb18-79"><a href="#cb18-79" aria-hidden="true"></a>  Face2_data_icc_r =<span class="st"> </span>Face2_data_r[(Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]</span>
<span id="cb18-80"><a href="#cb18-80" aria-hidden="true"></a>  </span>
<span id="cb18-81"><a href="#cb18-81" aria-hidden="true"></a>  Face2_data_icc_l<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">as.factor</span>(Face2_data_icc_l<span class="op">$</span>Condition)</span>
<span id="cb18-82"><a href="#cb18-82" aria-hidden="true"></a>  Face2_data_icc_r<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">as.factor</span>(Face2_data_icc_r<span class="op">$</span>Condition)</span>
<span id="cb18-83"><a href="#cb18-83" aria-hidden="true"></a>  </span>
<span id="cb18-84"><a href="#cb18-84" aria-hidden="true"></a><span class="co"># Average N170 trajectories for left and right hemisphere  </span></span>
<span id="cb18-85"><a href="#cb18-85" aria-hidden="true"></a>  Face2_N170 =<span class="st"> </span>(Face2_data_icc_l <span class="op">+</span><span class="st"> </span>Face2_data_icc_r)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb18-86"><a href="#cb18-86" aria-hidden="true"></a>  Face2_N170<span class="op">$</span>Condition =<span class="st"> </span>Face2_data_icc_l<span class="op">$</span>Condition  </span>
<span id="cb18-87"><a href="#cb18-87" aria-hidden="true"></a>  </span>
<span id="cb18-88"><a href="#cb18-88" aria-hidden="true"></a><span class="co"># Plot N170 trajectory</span></span>
<span id="cb18-89"><a href="#cb18-89" aria-hidden="true"></a>  N170_cat_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_N170,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span></span>
<span id="cb18-90"><a href="#cb18-90" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb18-91"><a href="#cb18-91" aria-hidden="true"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-92"><a href="#cb18-92" aria-hidden="true"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">11</span>, <span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-93"><a href="#cb18-93" aria-hidden="true"></a>          <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>))<span class="op">+</span></span>
<span id="cb18-94"><a href="#cb18-94" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>,<span class="dt">size =</span> <span class="fl">0.6</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span></span>
<span id="cb18-95"><a href="#cb18-95" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span>  nov_col)<span class="op">+</span></span>
<span id="cb18-96"><a href="#cb18-96" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">          </span><span class="co"># turn off legend</span></span>
<span id="cb18-97"><a href="#cb18-97" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">Time [ms]&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb18-98"><a href="#cb18-98" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span></span>
<span id="cb18-99"><a href="#cb18-99" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">4</span>))<span class="op">+</span></span>
<span id="cb18-100"><a href="#cb18-100" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">200</span>))<span class="op">+</span></span>
<span id="cb18-101"><a href="#cb18-101" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb18-102"><a href="#cb18-102" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></span>
<span id="cb18-103"><a href="#cb18-103" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">200</span>, <span class="dt">y=</span><span class="op">-</span><span class="dv">5</span>, <span class="dt">label =</span> <span class="st">&quot;N170&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">2</span>)</span>
<span id="cb18-104"><a href="#cb18-104" aria-hidden="true"></a> </span>
<span id="cb18-105"><a href="#cb18-105" aria-hidden="true"></a>  </span>
<span id="cb18-106"><a href="#cb18-106" aria-hidden="true"></a><span class="co"># Load topography information</span></span>
<span id="cb18-107"><a href="#cb18-107" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb18-108"><a href="#cb18-108" aria-hidden="true"></a></span>
<span id="cb18-109"><a href="#cb18-109" aria-hidden="true"></a><span class="co"># Remove participant 5</span></span>
<span id="cb18-110"><a href="#cb18-110" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID<span class="op">==</span><span class="dv">5</span>)), ]</span>
<span id="cb18-111"><a href="#cb18-111" aria-hidden="true"></a></span>
<span id="cb18-112"><a href="#cb18-112" aria-hidden="true"></a><span class="co"># Re-name to fit topoplot function</span></span>
<span id="cb18-113"><a href="#cb18-113" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span></span>
<span id="cb18-114"><a href="#cb18-114" aria-hidden="true"></a></span>
<span id="cb18-115"><a href="#cb18-115" aria-hidden="true"></a><span class="co"># Change from wide to long format for electrodes</span></span>
<span id="cb18-116"><a href="#cb18-116" aria-hidden="true"></a>  Topo_Cat =<span class="st"> </span><span class="kw">gather</span>(Topo_Cat, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key=</span><span class="ot">TRUE</span>)</span>
<span id="cb18-117"><a href="#cb18-117" aria-hidden="true"></a></span>
<span id="cb18-118"><a href="#cb18-118" aria-hidden="true"></a><span class="co"># Rename A1/A2</span></span>
<span id="cb18-119"><a href="#cb18-119" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span></span>
<span id="cb18-120"><a href="#cb18-120" aria-hidden="true"></a>  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span></span>
<span id="cb18-121"><a href="#cb18-121" aria-hidden="true"></a></span>
<span id="cb18-122"><a href="#cb18-122" aria-hidden="true"></a><span class="co"># Plot topoplots for repeated trials</span></span>
<span id="cb18-123"><a href="#cb18-123" aria-hidden="true"></a>  Topo_Cat_Rep =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)</span>
<span id="cb18-124"><a href="#cb18-124" aria-hidden="true"></a></span>
<span id="cb18-125"><a href="#cb18-125" aria-hidden="true"></a><span class="co"># Plot topoplots for novel trials</span></span>
<span id="cb18-126"><a href="#cb18-126" aria-hidden="true"></a>  Topo_Cat_Nov =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">11</span>)</span>
<span id="cb18-127"><a href="#cb18-127" aria-hidden="true"></a>  </span>
<span id="cb18-128"><a href="#cb18-128" aria-hidden="true"></a>  </span>
<span id="cb18-129"><a href="#cb18-129" aria-hidden="true"></a><span class="co"># Calculate difference score novel-repeated</span></span>
<span id="cb18-130"><a href="#cb18-130" aria-hidden="true"></a>  Topo_Diff_Nov_Rep =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_Rep[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_Rep[,<span class="dv">3</span>],</span>
<span id="cb18-131"><a href="#cb18-131" aria-hidden="true"></a>                                  <span class="dt">electrode =</span> Topo_Cat_Rep[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_Nov<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Cat_Rep<span class="op">$</span>amplitude)  </span>
<span id="cb18-132"><a href="#cb18-132" aria-hidden="true"></a>  </span>
<span id="cb18-133"><a href="#cb18-133" aria-hidden="true"></a><span class="co">## P1</span></span>
<span id="cb18-134"><a href="#cb18-134" aria-hidden="true"></a></span>
<span id="cb18-135"><a href="#cb18-135" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb18-136"><a href="#cb18-136" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)</span>
<span id="cb18-137"><a href="#cb18-137" aria-hidden="true"></a></span>
<span id="cb18-138"><a href="#cb18-138" aria-hidden="true"></a><span class="co"># Add electrode information  </span></span>
<span id="cb18-139"><a href="#cb18-139" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb18-140"><a href="#cb18-140" aria-hidden="true"></a></span>
<span id="cb18-141"><a href="#cb18-141" aria-hidden="true"></a>  topo_diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-142"><a href="#cb18-142" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-143"><a href="#cb18-143" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb18-144"><a href="#cb18-144" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-145"><a href="#cb18-145" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-146"><a href="#cb18-146" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-147"><a href="#cb18-147" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-148"><a href="#cb18-148" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-149"><a href="#cb18-149" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">7</span>, <span class="dt">hjust =</span> <span class="fl">0.6</span>))</span>
<span id="cb18-150"><a href="#cb18-150" aria-hidden="true"></a>  </span>
<span id="cb18-151"><a href="#cb18-151" aria-hidden="true"></a>  </span>
<span id="cb18-152"><a href="#cb18-152" aria-hidden="true"></a><span class="co">## N170</span></span>
<span id="cb18-153"><a href="#cb18-153" aria-hidden="true"></a>  </span>
<span id="cb18-154"><a href="#cb18-154" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb18-155"><a href="#cb18-155" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)</span>
<span id="cb18-156"><a href="#cb18-156" aria-hidden="true"></a></span>
<span id="cb18-157"><a href="#cb18-157" aria-hidden="true"></a><span class="co"># Add electrode information  </span></span>
<span id="cb18-158"><a href="#cb18-158" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb18-159"><a href="#cb18-159" aria-hidden="true"></a></span>
<span id="cb18-160"><a href="#cb18-160" aria-hidden="true"></a>  </span>
<span id="cb18-161"><a href="#cb18-161" aria-hidden="true"></a>  topo_diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-162"><a href="#cb18-162" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (180-220 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-163"><a href="#cb18-163" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb18-164"><a href="#cb18-164" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-165"><a href="#cb18-165" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-166"><a href="#cb18-166" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-167"><a href="#cb18-167" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-168"><a href="#cb18-168" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-169"><a href="#cb18-169" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">7</span>, <span class="dt">hjust =</span> <span class="fl">0.6</span>))</span>
<span id="cb18-170"><a href="#cb18-170" aria-hidden="true"></a>  </span>
<span id="cb18-171"><a href="#cb18-171" aria-hidden="true"></a><span class="co">## P3</span></span>
<span id="cb18-172"><a href="#cb18-172" aria-hidden="true"></a>  </span>
<span id="cb18-173"><a href="#cb18-173" aria-hidden="true"></a><span class="co"># Select time windows</span></span>
<span id="cb18-174"><a href="#cb18-174" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)</span>
<span id="cb18-175"><a href="#cb18-175" aria-hidden="true"></a></span>
<span id="cb18-176"><a href="#cb18-176" aria-hidden="true"></a><span class="co"># Add electrode information  </span></span>
<span id="cb18-177"><a href="#cb18-177" aria-hidden="true"></a>  Topo_Diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)</span>
<span id="cb18-178"><a href="#cb18-178" aria-hidden="true"></a></span>
<span id="cb18-179"><a href="#cb18-179" aria-hidden="true"></a>  </span>
<span id="cb18-180"><a href="#cb18-180" aria-hidden="true"></a>  topo_diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-181"><a href="#cb18-181" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-500 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-182"><a href="#cb18-182" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.6</span>,</span>
<span id="cb18-183"><a href="#cb18-183" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-184"><a href="#cb18-184" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-185"><a href="#cb18-185" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-186"><a href="#cb18-186" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-187"><a href="#cb18-187" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-188"><a href="#cb18-188" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="dt">vjust =</span> <span class="dv">7</span>, <span class="dt">hjust =</span> <span class="fl">0.6</span>))</span>
<span id="cb18-189"><a href="#cb18-189" aria-hidden="true"></a></span>
<span id="cb18-190"><a href="#cb18-190" aria-hidden="true"></a></span>
<span id="cb18-191"><a href="#cb18-191" aria-hidden="true"></a><span class="co"># Get legend for trajectories</span></span>
<span id="cb18-192"><a href="#cb18-192" aria-hidden="true"></a>  traj_leg_cat =<span class="kw">ggplot</span>(Face2_data_icc,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span></span>
<span id="cb18-193"><a href="#cb18-193" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),</span>
<span id="cb18-194"><a href="#cb18-194" aria-hidden="true"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-195"><a href="#cb18-195" aria-hidden="true"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">-5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),</span>
<span id="cb18-196"><a href="#cb18-196" aria-hidden="true"></a>         <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span></span>
<span id="cb18-197"><a href="#cb18-197" aria-hidden="true"></a><span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span></span>
<span id="cb18-198"><a href="#cb18-198" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> nov_col)<span class="op">+</span></span>
<span id="cb18-199"><a href="#cb18-199" aria-hidden="true"></a><span class="st">    </span><span class="co">#ggtitle(&quot;P1 &amp; P3&quot;) +</span></span>
<span id="cb18-200"><a href="#cb18-200" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span><span class="st">      </span></span>
<span id="cb18-201"><a href="#cb18-201" aria-hidden="true"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span></span>
<span id="cb18-202"><a href="#cb18-202" aria-hidden="true"></a><span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">17</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span></span>
<span id="cb18-203"><a href="#cb18-203" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">17</span>,<span class="dv">2</span>))<span class="op">+</span></span>
<span id="cb18-204"><a href="#cb18-204" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span></span>
<span id="cb18-205"><a href="#cb18-205" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span></span>
<span id="cb18-206"><a href="#cb18-206" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)</span>
<span id="cb18-207"><a href="#cb18-207" aria-hidden="true"></a></span>
<span id="cb18-208"><a href="#cb18-208" aria-hidden="true"></a>  traj_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(traj_leg_cat)</span>
<span id="cb18-209"><a href="#cb18-209" aria-hidden="true"></a></span>
<span id="cb18-210"><a href="#cb18-210" aria-hidden="true"></a><span class="co"># Get legend for topos</span></span>
<span id="cb18-211"><a href="#cb18-211" aria-hidden="true"></a>  topo_P1_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-212"><a href="#cb18-212" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-213"><a href="#cb18-213" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.7</span>,</span>
<span id="cb18-214"><a href="#cb18-214" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb18-215"><a href="#cb18-215" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-216"><a href="#cb18-216" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-217"><a href="#cb18-217" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-218"><a href="#cb18-218" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-219"><a href="#cb18-219" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb18-220"><a href="#cb18-220" aria-hidden="true"></a>  </span>
<span id="cb18-221"><a href="#cb18-221" aria-hidden="true"></a>  topo_P1_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_P1_leg_cat)</span>
<span id="cb18-222"><a href="#cb18-222" aria-hidden="true"></a>  </span>
<span id="cb18-223"><a href="#cb18-223" aria-hidden="true"></a>  topo_N170_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-224"><a href="#cb18-224" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (180-220 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-225"><a href="#cb18-225" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.7</span>,</span>
<span id="cb18-226"><a href="#cb18-226" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb18-227"><a href="#cb18-227" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-228"><a href="#cb18-228" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-229"><a href="#cb18-229" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-230"><a href="#cb18-230" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-231"><a href="#cb18-231" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb18-232"><a href="#cb18-232" aria-hidden="true"></a>  </span>
<span id="cb18-233"><a href="#cb18-233" aria-hidden="true"></a>  topo_N170_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_N170_leg_cat)</span>
<span id="cb18-234"><a href="#cb18-234" aria-hidden="true"></a>  </span>
<span id="cb18-235"><a href="#cb18-235" aria-hidden="true"></a>  topo_P3_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span></span>
<span id="cb18-236"><a href="#cb18-236" aria-hidden="true"></a><span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-500 ms)&quot;</span>)<span class="op">+</span></span>
<span id="cb18-237"><a href="#cb18-237" aria-hidden="true"></a><span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="fl">0.7</span>,</span>
<span id="cb18-238"><a href="#cb18-238" aria-hidden="true"></a>                              <span class="dt">head_size =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb18-239"><a href="#cb18-239" aria-hidden="true"></a><span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb18-240"><a href="#cb18-240" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span></span>
<span id="cb18-241"><a href="#cb18-241" aria-hidden="true"></a><span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span></span>
<span id="cb18-242"><a href="#cb18-242" aria-hidden="true"></a><span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span></span>
<span id="cb18-243"><a href="#cb18-243" aria-hidden="true"></a><span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">legend.text.align =</span> <span class="dv">1</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">8</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</span>
<span id="cb18-244"><a href="#cb18-244" aria-hidden="true"></a>    </span>
<span id="cb18-245"><a href="#cb18-245" aria-hidden="true"></a>    </span>
<span id="cb18-246"><a href="#cb18-246" aria-hidden="true"></a>  topo_P3_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_P3_leg_cat)</span>
<span id="cb18-247"><a href="#cb18-247" aria-hidden="true"></a></span>
<span id="cb18-248"><a href="#cb18-248" aria-hidden="true"></a></span>
<span id="cb18-249"><a href="#cb18-249" aria-hidden="true"></a><span class="co"># Get difference label</span></span>
<span id="cb18-250"><a href="#cb18-250" aria-hidden="true"></a>  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Novel-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Repeated</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb18-251"><a href="#cb18-251" aria-hidden="true"></a>  </span>
<span id="cb18-252"><a href="#cb18-252" aria-hidden="true"></a>  nov_rep_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-253"><a href="#cb18-253" aria-hidden="true"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">label =</span> text, <span class="dt">hjust =</span> <span class="dv">0</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-254"><a href="#cb18-254" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span></span>
<span id="cb18-255"><a href="#cb18-255" aria-hidden="true"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),</span>
<span id="cb18-256"><a href="#cb18-256" aria-hidden="true"></a>          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),</span>
<span id="cb18-257"><a href="#cb18-257" aria-hidden="true"></a>          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb18-258"><a href="#cb18-258" aria-hidden="true"></a>          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb18-259"><a href="#cb18-259" aria-hidden="true"></a>          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb18-260"><a href="#cb18-260" aria-hidden="true"></a>          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),</span>
<span id="cb18-261"><a href="#cb18-261" aria-hidden="true"></a>          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),</span>
<span id="cb18-262"><a href="#cb18-262" aria-hidden="true"></a>          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())</span>
<span id="cb18-263"><a href="#cb18-263" aria-hidden="true"></a>  </span>
<span id="cb18-264"><a href="#cb18-264" aria-hidden="true"></a><span class="co"># Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)</span></span>
<span id="cb18-265"><a href="#cb18-265" aria-hidden="true"></a>  <span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.4</span>)) <span class="op">+</span></span>
<span id="cb18-266"><a href="#cb18-266" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(P1_cat_traj, <span class="fl">0.05</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb18-267"><a href="#cb18-267" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(N170_cat_traj, <span class="fl">0.63</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span></span>
<span id="cb18-268"><a href="#cb18-268" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(traj_leg_cat, <span class="fl">0.45</span>, <span class="fl">0.57</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>) <span class="op">+</span></span>
<span id="cb18-269"><a href="#cb18-269" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(nov_rep_text, <span class="fl">-0.102</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span></span>
<span id="cb18-270"><a href="#cb18-270" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_P1, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-271"><a href="#cb18-271" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_P1_leg_cat, <span class="fl">0.26</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-272"><a href="#cb18-272" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_N170, <span class="fl">0.43</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-273"><a href="#cb18-273" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_N170_leg_cat, <span class="fl">0.59</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-274"><a href="#cb18-274" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_P3, <span class="fl">0.75</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb18-275"><a href="#cb18-275" aria-hidden="true"></a><span class="st">    </span><span class="kw">draw_plot</span>(topo_P3_leg_cat, <span class="fl">0.91</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) </span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_cat_plot-1.png" width="768" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="model-specification-1" class="section level4 tabset tabset-pills">
<h4 class="tabset tabset-pills"><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure-1" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(P1_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true"></a><span class="co"># Select targets</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true"></a>P1_Cat =<span class="st"> </span><span class="kw">subset</span>(P1_Cat, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true"></a><span class="co"># Prepare fixed factors</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true"></a>P1_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>ID)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>Stim_Type)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true"></a>P1_Cat[P1_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true"></a>P1_Cat[P1_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true"></a></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(P1_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>, <span class="st">&quot;repeated&quot;</span>))</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true"></a></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true"></a><span class="kw">contrasts</span>(P1_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true"></a>mm_P1_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Group_pcic, P1_Cat)</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true"></a></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true"></a>P1_Cat[, (<span class="kw">ncol</span>(P1_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)] =<span class="st"> </span>mm_P1_Cat</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true"></a><span class="kw">names</span>(P1_Cat)[(<span class="kw">ncol</span>(P1_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Nov_Rep&quot;</span>)</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true"></a></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true"></a><span class="co"># Build model</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true"></a>mod_P1_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true"></a></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_cat.lmer1))</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true"></a></span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true"></a></span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true"></a>mod_P1_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true"></a></span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true"></a><span class="co">## Likelihood-ratio testing</span></span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true"></a></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true"></a><span class="co"># Stim_Type</span></span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true"></a>mod_P1_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true"></a></span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true"></a><span class="kw">anova</span>(mod_P1_cat.lmer2, mod_P1_cat.lmer3)</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true"></a></span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true"></a></span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true"></a>mod_P1_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID), </span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true"></a>    <span class="dt">data =</span> P1_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals-1" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true"></a>P1_Cat<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Cat<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Cat<span class="op">$</span>mean_ROI_P1)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P1_Cat<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true"></a>mod_P1_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P1_Cat)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true"></a>res.mod_P1_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_Cat)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true"></a>qqpl_mod_P1_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true"></a>norm_mod_P1_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_p1-homoscedasticity-1" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_cat.lmer4), <span class="kw">residuals</span>(mod_P1_cat.lmer4))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure-1" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true"></a><span class="co"># Select targets</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(N170_Cat, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">subset</span>(N170_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true"></a><span class="st">    </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true"></a>N170_Cat[N170_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true"></a>N170_Cat[N170_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true"></a><span class="co"># Separate data in left and right hemisphere</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true"></a>N170_Cat =<span class="st"> </span><span class="kw">gather</span>(N170_Cat, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, </span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true"></a>    <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Cat<span class="op">$</span>Elect_site)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true"></a><span class="co"># Add variable name</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &quot;left&quot;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true"></a></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true"></a><span class="co"># Set contrast for elect site</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>Elect_site)</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>Elect_site) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true"></a><span class="co"># Factor random factors</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true"></a>N170_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>ID)</span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>Stim_Type)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>, <span class="st">&quot;repeated&quot;</span>))</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true"></a></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true"></a><span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true"></a></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true"></a>mm_N170_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Group_pcic <span class="op">+</span><span class="st"> </span>Group_pcic <span class="op">*</span><span class="st"> </span>Elect_site, N170_Cat)</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true"></a></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true"></a><span class="kw">nrow</span>(N170_Cat)</span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true"></a>N170_Cat[, (<span class="kw">ncol</span>(N170_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">4</span>)] =<span class="st"> </span>mm_N170_Cat</span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true"></a><span class="kw">names</span>(N170_Cat)[(<span class="kw">ncol</span>(N170_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">3</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Nov_Rep&quot;</span>, <span class="st">&quot;Elect_site&quot;</span>, </span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true"></a>    <span class="st">&quot;Nov_RepxElect_site&quot;</span>)</span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true"></a><span class="co"># Get model</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true"></a>mod_N170_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Cat, </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true"></a>    <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true"></a></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer1))</span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true"></a></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true"></a></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true"></a><span class="co"># Improved model</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true"></a>mod_N170_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true"></a><span class="st">    </span>Nov_RepxElect_site <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true"></a></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true"></a><span class="co"># Re-check variances</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer2))</span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true"></a></span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true"></a><span class="co">## Likelihood ratio testing</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true"></a></span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true"></a>mod_N170_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">||</span><span class="st"> </span>Stim_Type), </span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true"></a>    <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true"></a></span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true"></a><span class="co"># Stim Type</span></span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true"></a>mod_N170_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), </span>
<span id="cb24-77"><a href="#cb24-77" aria-hidden="true"></a>    <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb24-78"><a href="#cb24-78" aria-hidden="true"></a></span>
<span id="cb24-79"><a href="#cb24-79" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb24-80"><a href="#cb24-80" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_cat.lmer2, mod_N170_cat.lmer3)</span>
<span id="cb24-81"><a href="#cb24-81" aria-hidden="true"></a><span class="kw">anova</span>(mod_N170_cat.lmer2, mod_N170_cat.lmer4)</span>
<span id="cb24-82"><a href="#cb24-82" aria-hidden="true"></a></span>
<span id="cb24-83"><a href="#cb24-83" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb24-84"><a href="#cb24-84" aria-hidden="true"></a>mod_N170_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span></span>
<span id="cb24-85"><a href="#cb24-85" aria-hidden="true"></a><span class="st">    </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">||</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), </span>
<span id="cb24-86"><a href="#cb24-86" aria-hidden="true"></a>    <span class="dt">data =</span> N170_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions. For the N170, we also added a scaled sum contrast for Hemisphere (<code>ROI</code>) and the interaction of novelty with hemisphere (<code>NvsR x ROI</code>).The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Nov_Rep + Nov_RepxElect_site + Elect_site + ,     scale(Age) + scale(WM) + ((1 | ID) + (0 + Nov_Rep | ID) + ,     (0 + Nov_RepxElect_site | ID)) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals-1" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true"></a>N170_Cat<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Cat<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Cat<span class="op">$</span>N170_Amplitude)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true"></a><span class="kw">boxcox</span>(N170_Cat<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true"></a>mod_N170_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> N170_Cat)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true"></a>res.mod_N170_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_Cat)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true"></a>qqpl_mod_N170_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true"></a>norm_mod_N170_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_n170-homoscedasticity-1" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_cat.lmer4), <span class="kw">residuals</span>(mod_N170_cat.lmer4))</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure-1" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true"></a><span class="co"># Select correct responses and outlier-free data</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(P3_Cat, Exclude_smaller_250ms <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span>Exclude_larger_7s <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span> <span class="op">&amp;</span><span class="st"> </span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true"></a><span class="st">    </span>Exclude_MAD <span class="op">==</span><span class="st"> </span><span class="ot">FALSE</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true"></a><span class="co"># Factor random factors</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true"></a>P3_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>ID)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>Stim_Type)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true"></a><span class="co"># Select targets</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true"></a>P3_Cat =<span class="st"> </span><span class="kw">subset</span>(P3_Cat, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)</span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true"></a></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true"></a><span class="co"># Define novel vs repeated trials</span></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true"></a>P3_Cat[P3_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">2</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true"></a>P3_Cat[P3_Cat<span class="op">$</span>Group_pcic <span class="op">==</span><span class="st"> </span><span class="dv">3</span>, ]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true"></a></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true"></a><span class="co"># Create factor, get neutral as baseline</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(P3_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>, <span class="st">&quot;repeated&quot;</span>))</span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true"></a></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true"></a><span class="co"># Set treatment contrast</span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true"></a><span class="kw">contrasts</span>(P3_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true"></a><span class="co"># Add contrast columns</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true"></a>mm_P3_Cat =<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span>Group_pcic, P3_Cat)</span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true"></a></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true"></a><span class="co"># Attach to dataframe</span></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true"></a>P3_Cat[, (<span class="kw">ncol</span>(P3_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Cat) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)] =<span class="st"> </span>mm_P3_Cat</span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true"></a><span class="kw">names</span>(P3_Cat)[(<span class="kw">ncol</span>(P3_Cat) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Nov_Rep&quot;</span>)</span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true"></a></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true"></a><span class="co"># Get model</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true"></a>mod_P3_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true"></a></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true"></a><span class="co"># 1st: check how many zero variance terms you got in random effects</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer1))</span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true"></a></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true"></a><span class="co"># 2nd: check which random terms explain the least variance</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer1), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true"></a></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true"></a><span class="co"># Improved model</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true"></a>mod_P3_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">||</span><span class="st"> </span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true"></a><span class="st">    </span>ID) <span class="op">+</span><span class="st"> </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true"></a></span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true"></a><span class="co"># Re-check the model</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true"></a><span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer2))</span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true"></a><span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer2), <span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true"></a></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true"></a><span class="co">## Likelhood ratio testing</span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true"></a></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true"></a><span class="co"># ID</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true"></a>mod_P3_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true"></a></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_cat.lmer2, mod_P3_cat.lmer3)</span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true"></a></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true"></a><span class="co"># Stim_Type</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true"></a>mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true"></a><span class="co"># Calculate ANOVA</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true"></a><span class="kw">anova</span>(mod_P3_cat.lmer2, mod_P3_cat.lmer4)</span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true"></a></span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true"></a></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true"></a><span class="co"># Final model</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true"></a>mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span><span class="st"> </span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true"></a><span class="st">    </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">|</span><span class="st"> </span>Stim_Type), <span class="dt">data =</span> P3_Cat, <span class="dt">control =</span> <span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID) + (0 + ,     Nov_Rep | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals-1" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true"></a><span class="co">## Check properties of DV / residuals</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true"></a>P3_Cat<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Cat<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Cat<span class="op">$</span>mean_ROI_P3)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true"></a></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true"></a><span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true"></a><span class="kw">boxcox</span>(P3_Cat<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Cat<span class="op">$</span>Group_pcic)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true"></a><span class="co"># Visualize normality assumption of residuals (without log transform)</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true"></a>mod_P3_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data =</span> P3_Cat)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true"></a>res.mod_P3_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_Cat)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true"></a>qqpl_mod_P3_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_Cat, <span class="dt">main =</span> <span class="st">&quot;QQplot before transformation&quot;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true"></a>norm_mod_P3_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_Cat), <span class="dt">main =</span> <span class="st">&quot;Density plot before transformation&quot;</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true"></a><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</span></code></pre></div>
<hr />
</div>
<div id="lmm_p3-homoscedasticity-1" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true"></a><span class="co"># Check homoscedasticity</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_cat.lmer4), <span class="kw">residuals</span>(mod_P3_cat.lmer4))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true"></a><span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)</span></code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results-1" class="section level4">
<h4><strong>Results</strong></h4>
<p>In contrast to our hypothesis, we did not find a difference between P1 amplitudes in trials with novel in contrast to repeated facial expressions. None of the covariates reached significance. In contrast to our hypothesis, we did not find a significant effect of novelty. We detected a significant main effect of hemisphere, with amplitudes being larger in the right compared to the left hemisphere. The interaction of hemisphere with novelty was not significant. Age or working memory as covariates did not reach significance. We did not find an effect of novelty, nor did any of the covariates reach significance.</p>
<div align="center">


<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true"></a><span class="co"># Define labels</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true"></a>labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Novel vs Repeated&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>, <span class="st">&quot;NvsR X ROI&quot;</span>, <span class="st">&quot;ROI&quot;</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true"></a></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true"></a><span class="co"># Create table</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true"></a><span class="kw">tab_model</span>(mod_P1_cat.lmer4, mod_N170_cat.lmer4, mod_P3_cat.lmer4, <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true"></a>    <span class="dt">pred.labels =</span> labels, <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">show.se =</span> <span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>, <span class="dt">show.stat =</span> <span class="ot">TRUE</span>, </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true"></a>    <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>, <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">FALSE</span>, <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, </span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true"></a>    <span class="dt">dv.labels =</span> <span class="kw">c</span>(<span class="st">&quot;P1 Amplitudes&quot;</span>, <span class="st">&quot;N170 Amplitudes&quot;</span>, <span class="st">&quot;P3 Amplitudes&quot;</span>), <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.34
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.181
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.712
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.30
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.786
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.100
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.357
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.26
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.186
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.725
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.68
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.451
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.947
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
NvsR X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.47
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
1.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.32
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.749
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
2.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.004</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
179.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
147.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
238.51
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28.09 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.16 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
1.88 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
24.73 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
37.23 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
5.70 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.04 <sub>ID.2</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.02
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
37 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
37 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.019 / 0.152
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.008 / 0.026
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.010 / 0.145
</td>
</tr>
</table>
</div>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true"></a><span class="co"># Get session info</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true"></a><span class="kw">sessionInfo</span>()</span></code></pre></div>
<pre><code>R version 4.0.2 (2020-06-22)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 18362)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gvlma_1.0.0.3      eegUtils_0.5.0     akima_0.6-2.1      forcats_0.5.0     
 [5] stringr_1.4.0      purrr_0.3.4        readr_1.3.1        tidyr_1.1.1       
 [9] tibble_3.0.3       tidyverse_1.3.0    sjlabelled_1.1.6   sjmisc_2.8.5      
[13] sjPlot_2.8.4       Rmisc_1.5          plyr_1.8.6         reshape2_1.4.4    
[17] psych_2.0.7        MASS_7.3-51.6      lmerTest_3.1-2     lme4_1.1-23       
[21] Matrix_1.2-18      Hmisc_4.4-1        Formula_1.2-3      survival_3.1-12   
[25] lattice_0.20-41    ggstatsplot_0.5.0  ez_4.4-0           EnvStats_2.3.1    
[29] eeptools_1.2.4     ggplot2_3.3.2      dplyr_1.0.1        cowplot_1.0.0     
[33] summarytools_0.9.6 miceadds_3.10-28   mice_3.11.0        rmdformats_0.3.7  
[37] XLConnect_1.0.1    kableExtra_1.1.0  

loaded via a namespace (and not attached):
 [1] vcd_1.4-7            ps_1.3.4             lmtest_0.9-37       
 [4] crayon_1.3.4         V8_3.2.0             PMCMRplus_1.4.4     
 [7] nlme_3.1-148         backports_1.1.8      metafor_2.4-0       
[10] reprex_0.3.0         ggcorrplot_0.1.3     rlang_0.4.7         
[13] readxl_1.3.1         performance_0.4.8    nloptr_1.2.2.2      
[16] callr_3.4.3          glue_1.4.1           loo_2.3.1           
[19] rstan_2.21.2         parallel_4.0.2       processx_3.4.3      
[22] shinydashboard_0.7.1 tcltk_4.0.2          haven_2.3.1         
[25] tidyselect_1.1.0     rio_0.5.16           zoo_1.8-8           
[28] SuppDists_1.1-9.5    mc2d_0.1-18          xtable_1.8-4        
[31] MatrixModels_0.4-1   magrittr_1.5         evaluate_0.14       
[34] cli_2.0.2            rstudioapi_0.11      miniUI_0.1.1.1      
[37] sp_1.4-2             rpart_4.1-15         shiny_1.5.0         
[40] xfun_0.16            parameters_0.8.2     groupedstats_1.0.1  
[43] inline_0.3.15        pkgbuild_1.1.0       cluster_2.1.0       
[46] bridgesampling_1.0-0 WRS2_1.1-0           expm_0.999-5        
[49] Brobdingnag_1.2-6    ggrepel_0.8.2        listenv_0.8.0       
[52] png_0.1-7            reshape_0.8.8        future_1.18.0       
[55] zeallot_0.1.0        withr_2.2.0          rcompanion_2.3.25   
[58] cellranger_1.1.0     pracma_2.2.9         coda_0.19-3         
[61] pillar_1.4.6         RcppParallel_5.0.2   Rmpfr_0.8-1         
[64] multcomp_1.4-13      fs_1.5.0             paletteer_1.2.0     
[67] vctrs_0.3.2          ellipsis_0.3.1       generics_0.0.2      
[70] nortest_1.0-4        tools_4.0.2          foreign_0.8-80      
[73] munsell_0.5.0        emmeans_1.5.0        fastmap_1.0.1       
 [ reached getOption(&quot;max.print&quot;) -- omitted 133 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
