<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>ERP measures</title>
<!-- Material Design fonts -->
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.7/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/magnific-popup-1.1.0/magnific-popup.css" rel="stylesheet" />
<script src="site_libs/magnific-popup-1.1.0/jquery.magnific-popup.min.js"></script>
<link href="site_libs/bootstrap_material-0.1/bootstrap-material-design.min.css" rel="stylesheet" />
<link href="site_libs/bootstrap_material-0.1/ripples.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap_material-0.1/material.min.js"></script>
<script src="site_libs/bootstrap_material-0.1/ripples.min.js"></script>
<link href="site_libs/material-0.1/material.css" rel="stylesheet" />
<script src="site_libs/material-0.1/material.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #ffffff; color: #1f1c1b; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; background-color: #ffffff; color: #a0a0a0; border-right: 1px solid #a0a0a0; }
td.sourceCode { padding-left: 5px; }
pre, code { color: #1f1c1b; background-color: #ffffff; }
code > span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
code > span.dt { color: #0057ae; } /* DataType */
code > span.dv { color: #b08000; } /* DecVal */
code > span.bn { color: #b08000; } /* BaseN */
code > span.fl { color: #b08000; } /* Float */
code > span.cn { color: #aa5500; } /* Constant */
code > span.ch { color: #924c9d; } /* Char */
code > span.sc { color: #3daee9; } /* SpecialChar */
code > span.st { color: #bf0303; } /* String */
code > span.vs { color: #bf0303; } /* VerbatimString */
code > span.ss { color: #ff5500; } /* SpecialString */
code > span.im { color: #ff5500; } /* Import */
code > span.co { color: #898887; } /* Comment */
code > span.do { color: #607880; } /* Documentation */
code > span.an { color: #ca60ca; } /* Annotation */
code > span.cv { color: #0095ff; } /* CommentVar */
code > span.ot { color: #006e28; } /* Other */
code > span.fu { color: #644a9b; } /* Function */
code > span.va { color: #0057ae; } /* Variable */
code > span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
code > span.op { color: #1f1c1b; } /* Operator */
code > span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
code > span.ex { color: #0095ff; font-weight: bold; } /* Extension */
code > span.pp { color: #006e28; } /* Preprocessor */
code > span.at { color: #0057ae; } /* Attribute */
code > span.re { color: #0057ae; } /* RegionMarker */
code > span.in { color: #b08000; } /* Information */
code > span.wa { color: #bf0303; } /* Warning */
code > span.al { color: #bf0303; font-weight: bold; } /* Alert */
code > span.er { color: #bf0303; text-decoration: underline; } /* Error */
code > span. { color: #1f1c1b; } /* Normal */
</style>

<link rel="stylesheet" href="web_style.css" type="text/css" />

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("toc");
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

</head>

<body>

<div class="header-panel shadow z-2">
    <div class="container-fluid">
        <div class="row">
            <div class="col-xs-3">
        <div id="header">
    <h1 class="title">ERP measures</h1>
                </div>
    </div>
</div>
</div>
</div>


<div class="container-fluid main-container">
    <div class="row">
      <nav class="col-xs-3 menu">
        <div id="toc">
        <ul>
        <li><a href="#task-description">Task description</a></li>
        <li><a href="#valence-effects">Valence effects</a></li>
        <li><a href="#categorization-effects">Categorization effects</a></li>
        <li><a href="#session-info">Session info</a></li>
        </ul>
        </div>
        
        
        
      </nav>
     <div class="pages col-xs-9">
     <div class="row">
       <div class="col-xs-10">


<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Data description
  </a>
</li>
<li>
  <a href="R_Script_1_Sample_descr.html">
    <span class="glyphicon glyphicon-user"></span>
     
    Sample description
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    Same-different matching task
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-flash"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://osf.io/nas48/">
    <span class="ai ai ai ai-osf ai-lg"></span>
     
  </a>
</li>
<li>
  <a href="mailto:sandra.naumann@hu-berlin.de">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
<link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">


<!-- Set up workspace -->
<!-- Load data set -->
<div id="task-description" class="section level1">
<h1>Task description</h1>
<p>We developed a novel paradigm to examine ERP responses to novel and repeated emotional faces. In particular, EEG was recorded while preschoolers observed pairs of faces presented sequentially. In some trials, the two sequential facial stimuli (hereafter: ‘Face 1’ and ‘Face 2’) were identical, while in other trials they differed with regards to the emotional expression displayed (happy, fearful or neutral).</p>
<p>We calculated linear mixed models (LMM) separately for each ERP component. Fixed effects are defined for each model individually. Chronological age and working memory were entered as scaled covariates in all linear mixed model analyses to control for cognitive abilities of the children as well as potential age differences.</p>
<p>The random effects structure included random intercepts for participants <code>(1|ID)</code> and stimulus <code>(1|Stim_Type)</code>. For each model, we commenced with the maximal random effect structure. Random intercepts were defined for participants and stimuli. Random slopes were defined for all predictors, but not covariates. We set correlations of random terms to zero and performed a principal component analysis on the random-effects variance-covariance estimates to determine the number of components supported by the data. We removed random effects explaining zero variance, in order to prevent over-parametrization. Afterwards, we checked whether all random intercepts improved the model using likelihood-ratio-testing.</p>
</div>
<div id="valence-effects" class="section level1">
<h1>Valence effects</h1>
<p>We predicted that ERP amplitudes of sensory (P1, N170) and higher-order (P3) components would be larger for emotional compared to neutral facial expressions. We examined this hypothesis in response to Face 1.</p>
<p><br></p>
<div id="descriptive-statistics" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## P1/P3 trajectories

<span class="co"># Load data</span>
  Face1_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face1.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)

<span class="co"># De-select participants</span>
  Face1_data =<span class="st"> </span>Face1_data[<span class="kw">with</span>(Face1_data, <span class="op">!</span>(Face1_data<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]

<span class="co"># Select time window</span>
  Face1_data =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face1_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>),]

<span class="co"># Rename conditions</span>
  Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;happy&#39;</span>;
  Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;neutral&#39;</span>;
  Face1_data<span class="op">$</span>Condition[Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;angry&#39;</span>;

<span class="co"># Select conditions of interest</span>
  Face1_data_all_emo_sep =<span class="st"> </span>Face1_data[(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;happy&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;angry&#39;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;neutral&#39;</span>),]
  
  
<span class="co"># Factor and level emotion</span>
  Face1_data_all_emo_sep<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))


<span class="co"># Plot data</span>
  P1_P3_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_data_all_emo_sep,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),
          <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_color_discrete</span>(<span class="dt">guide =</span> <span class="kw">guide_legend</span>(<span class="dt">override.aes =</span> <span class="kw">list</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>)))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">16</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">16</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">110</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">label =</span> <span class="st">&quot;P1&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">350</span>, <span class="dt">y=</span><span class="dv">14</span>, <span class="dt">label =</span> <span class="st">&quot;P3&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)


## N170 trajectories

<span class="co"># Load data</span>
  Face1_data_l =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/left_ROI_N170_Face1.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)
  Face1_data_r =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/right_ROI_N170_Face1.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)

<span class="co"># Select time windows</span>
  Face1_data_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>),]
  Face1_data_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>),]

<span class="co"># De-select participants</span>
  Face1_data_l =<span class="st"> </span>Face1_data_l[<span class="kw">with</span>(Face1_data_l, <span class="op">!</span>(Face1_data_l<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]
  Face1_data_r =<span class="st"> </span>Face1_data_r[<span class="kw">with</span>(Face1_data_r, <span class="op">!</span>(Face1_data_r<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]

<span class="co"># Rename conditions</span>
  Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;happy&#39;</span>;
  Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;neutral&#39;</span>;
  Face1_data_l<span class="op">$</span>Condition[Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;angry&#39;</span>;
  
  Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;happy&#39;</span>;
  Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;neutral&#39;</span>;
  Face1_data_r<span class="op">$</span>Condition[Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;angry&#39;</span>;

<span class="co"># Select conditions of interest</span>
  Face1_data_all_emo_sep_l =<span class="st"> </span>Face1_data_l[(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;happy&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;angry&#39;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;neutral&#39;</span>),]
  
  Face1_data_all_emo_sep_r =<span class="st"> </span>Face1_data_r[(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;happy&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;angry&#39;</span>) <span class="op">|</span><span class="st"> </span>(Face1_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;neutral&#39;</span>),]
  
<span class="co"># Factor and level emotion</span>
  Face1_data_all_emo_sep_l<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_l<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

    Face1_data_all_emo_sep_r<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(Face1_data_all_emo_sep_r<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Average N170 trajectories for left and right hemisphere  </span>
  Face1_N170 =<span class="st"> </span>(Face1_data_all_emo_sep_l <span class="op">+</span><span class="st"> </span>Face1_data_all_emo_sep_r)<span class="op">/</span><span class="dv">2</span>
  Face1_N170<span class="op">$</span>Condition =<span class="st"> </span>Face1_data_all_emo_sep_l<span class="op">$</span>Condition
  
<span class="co"># Plot N170 trajectory   </span>
   N170_val_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face1_N170,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
            <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
            <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
            <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">7</span>),
            <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>,<span class="dt">size =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">      </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col)<span class="op">+</span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">      </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">      </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">200</span>, <span class="dt">y=</span><span class="op">-</span><span class="fl">5.2</span>, <span class="dt">label =</span> <span class="st">&quot;N170&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size =</span> <span class="dv">3</span>)

<span class="co"># Load topography information</span>
  Topo_Emo =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/ERPs_Topo_Face1.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)

<span class="co"># Exclude participant</span>
  Topo_Emo =<span class="st"> </span>Topo_Emo[<span class="kw">with</span>(Topo_Emo, <span class="op">!</span>(Topo_Emo<span class="op">$</span>ID<span class="op">==</span><span class="dv">5</span>)), ]

<span class="co"># Re-name to fit topoplot function</span>
  <span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span>

<span class="co"># Change from wide to long format for electrodes</span>
  Topo_Emo =<span class="st"> </span><span class="kw">gather</span>(Topo_Emo, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key=</span><span class="ot">TRUE</span>)

<span class="co"># Rename A1/A2</span>
  <span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span>
  <span class="kw">names</span>(Topo_Emo)[<span class="kw">names</span>(Topo_Emo) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span>

<span class="co"># Plot topoplots for happy</span>
  Topo_Emo_Hap =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)
  
<span class="co"># Plot topoplots for neutral</span>
  Topo_Emo_Neu =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)

<span class="co"># Plot topoplots for angry</span>
  Topo_Emo_Ang =<span class="st"> </span><span class="kw">subset</span>(Topo_Emo, Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>)
  
<span class="co"># Calculate difference score angry-neutral</span>
  Topo_Diff_Ang_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[,<span class="dv">3</span>],
                                  <span class="dt">electrode =</span> Topo_Emo_Hap[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Ang<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)
  
  
<span class="co"># Calculate difference score happy-neutral</span>
  Topo_Diff_Hap_Neu =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Emo_Hap[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_Emo_Hap[,<span class="dv">3</span>],
                                  <span class="dt">electrode =</span> Topo_Emo_Hap[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Emo_Hap<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Emo_Neu<span class="op">$</span>amplitude)  
  
## P1s   

<span class="co"># Select time windows</span>
  Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)
  Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Ang_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)
  Topo_Diff_Hap_Neu_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

<span class="co"># Draw topographies</span>
  topo_diff_ang_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  

<span class="co"># Draw topographies</span>
  topo_diff_hap_neu_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                   </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))  

## N170s 

<span class="co"># Select time windows</span>
  Topo_Diff_Ang_Neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)
  Topo_Diff_Hap_Neu_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Ang_Neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)
  Topo_Diff_Hap_Neu_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

<span class="co"># Draw topographies</span>
  topo_diff_ang_neu_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (170-230 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  

<span class="co"># Draw topographies</span>
  topo_diff_hap_neu_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))  
  
## P3s   

<span class="co"># Select time windows</span>
  Topo_Diff_Ang_Neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Ang_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)
  Topo_Diff_Hap_Neu_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Hap_Neu, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Ang_Neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Ang_Neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)
  Topo_Diff_Hap_Neu_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Hap_Neu_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

<span class="co"># Draw topographies</span>
  topo_diff_ang_neu_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-600 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  

<span class="co"># Draw topographies</span>
  topo_diff_hap_neu_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Hap_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))  </code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get legend for trajectories</span>
  traj_emo =<span class="st"> </span><span class="kw">ggplot</span>(Face1_N170,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
            <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
            <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
            <span class="dt">legend.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>),
            <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean, <span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>, <span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">      </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> emotion_col)<span class="op">+</span>
<span class="st">      </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;right&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">      </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">      </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">      </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">      </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)

  traj_leg_emo =<span class="st"> </span><span class="kw">get_legend</span>(traj_emo)

<span class="co"># Get legend for topos</span>
  topo_leg_P1 =<span class="st">  </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>)<span class="op">+</span>
<span class="st">                      </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>,
                                <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                      </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;right&quot;</span>)
  
  topo_leg_P1 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_P1)


  topo_leg_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>)<span class="op">+</span>
<span class="st">                      </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>,
                                <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                      </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">3</span>)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>)
 
  
  topo_leg_N170 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_N170)
  
  
  topo_leg_P3 =<span class="st">  </span><span class="kw">ggplot</span>(Topo_Diff_Ang_Neu_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">ggtitle</span>(<span class="st">&quot;Angry-Neutral&quot;</span>)<span class="op">+</span>
<span class="st">                      </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">2</span>,
                                <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                      </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>,<span class="dv">4</span>)) <span class="op">+</span>
<span class="st">                      </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                      </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot; &quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                      </span><span class="kw">theme</span>(<span class="dt">legend.position  =</span> <span class="st">&quot;right&quot;</span>)
  
  topo_leg_P3 =<span class="st"> </span><span class="kw">get_legend</span>(topo_leg_P3)  

  
<span class="co"># Get difference labels</span>
  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Angry-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Neutral</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  ang_neu_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),
          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())

  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Happy-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Neutral</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  hap_neu_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),
          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>()) 
  
<span class="co"># Get capital letters</span>
  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> A</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> B</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  first_plot =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),
          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>()) 
  
<span class="co"># Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)</span>
  <span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.4</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(first_plot, <span class="op">-</span><span class="fl">0.68</span>, <span class="fl">0.25</span>, <span class="fl">1.4</span>, <span class="fl">1.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(P1_P3_val_traj, <span class="fl">0.05</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">draw_plot</span>(N170_val_traj, <span class="fl">0.55</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(traj_leg_emo, <span class="dv">1</span>, <span class="dv">1</span>, <span class="fl">0.25</span>, <span class="fl">0.25</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(ang_neu_text, <span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.25</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(hap_neu_text, <span class="op">-</span><span class="fl">0.05</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_P1, <span class="fl">0.12</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_P1, <span class="fl">0.12</span>, <span class="fl">0.00</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_leg_P1, <span class="fl">0.37</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_N170, <span class="fl">0.47</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_N170, <span class="fl">0.47</span>, <span class="fl">0.00</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_leg_N170, <span class="fl">0.72</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_ang_neu_P3, <span class="fl">0.82</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_hap_neu_P3, <span class="fl">0.82</span>, <span class="fl">0.00</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_leg_P3, <span class="fl">1.07</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>)</code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_val_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br><br></p>
</div>
<div id="model-specification" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select Face 1</span>
  P1_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data,Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) 

<span class="co"># Prepare fixed factors </span>
  P1_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>ID)
  P1_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Val<span class="op">$</span>Stim_Type)

<span class="co"># Re-code emotion condition</span>
  P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span>
  P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span>
  P1_Val<span class="op">$</span>Condition[P1_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span>

<span class="co"># Create factor &amp; set neutral as baseline</span>
  P1_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P1_Val<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Add contrast columns</span>
  mm_P1_Val =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Condition, P1_Val) 

<span class="co"># Attach to dataframe</span>
  P1_Val[,(<span class="kw">ncol</span>(P1_Val)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Val)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_P1_Val
  <span class="kw">names</span>(P1_Val)[(<span class="kw">ncol</span>(P1_Val)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>) 

<span class="co"># Build model </span>
  mod_P1_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P1_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Remove intercepts/slopes based on variance check </span>
  mod_P1_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P1_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Re-check the model</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_val.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_val.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Likelihood ratio testing</span>

<span class="co"># For ID</span>
  mod_P1_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P1_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_P1_val.lmer2,mod_P1_val.lmer3)

<span class="co"># Stimulus type</span>
  mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P1_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_P1_val.lmer2,mod_P1_val.lmer4)


<span class="co"># Final model</span>
  mod_P1_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID),
                          <span class="dt">data =</span> P1_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(P1_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)

## Check properties of DV / residuals 
  P1_Val<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Val<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Val<span class="op">$</span>mean_ROI_P1)

<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(P1_Val<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Val<span class="op">$</span>Condition)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_P1_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data=</span>P1_Val)
  res.mod_P1_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_val)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_P1_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_val, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_P1_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_val), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm_p1-homoscedasticity" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_val.lmer4), <span class="kw">residuals</span>(mod_P1_val.lmer4))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Transform dataset so that left/right hemisphere are accounted for </span>
  N170_Val =<span class="st"> </span><span class="kw">gather</span> (ERP_data, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)

<span class="co"># Add variable name</span>
  N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Val<span class="op">$</span>Elect_site)
  N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &#39;left&#39;</span>
  N170_Val<span class="op">$</span>Elect_site[N170_Val<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span>

<span class="co"># Prepare fixed factors </span>
  N170_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>ID)
  N170_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Val<span class="op">$</span>Stim_Type)
  N170_Val<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Elect_site)

<span class="co"># Select primes</span>
  N170_Val =<span class="st"> </span><span class="kw">subset</span>(N170_Val,Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) 

<span class="co"># Re-code values for emotion variable</span>
  N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span>
  N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span>
  N170_Val<span class="op">$</span>Condition[N170_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span>

<span class="co"># Create factor, get neutral as baseline</span>
  N170_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(N170_Val<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)

<span class="co"># Set contrast for hemisphere</span>
  <span class="kw">contrasts</span>(N170_Val<span class="op">$</span>Elect_site) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>



<span class="co"># Add contrast columns</span>
  mm_N170_Val =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Condition <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>Condition<span class="op">*</span>Elect_site, N170_Val) 

<span class="co"># Attach to dataframe</span>
  N170_Val[,(<span class="kw">ncol</span>(N170_Val)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Val)<span class="op">+</span><span class="dv">6</span>)] =<span class="st"> </span>mm_N170_Val
  <span class="kw">names</span>(N170_Val)[(<span class="kw">ncol</span>(N170_Val)<span class="op">-</span><span class="dv">5</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>, <span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>, <span class="st">&quot;Elect_site&quot;</span>, <span class="st">&quot;Hap_NeuxElect_site&quot;</span>, <span class="st">&quot;Ang_NeuxElect_site&quot;</span>) 

<span class="co"># Get model</span>
  mod_N170_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>Stim_Type),
                            <span class="dt">data =</span> N170_Val,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Improved model</span>
  mod_N170_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span>Hap_NeuxElect_site <span class="op">+</span><span class="st"> </span>Ang_NeuxElect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">|</span>ID),
                            <span class="dt">data =</span> N170_Val,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))
<span class="co"># Re-check the model</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_val.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_val.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). For the N170, we also included a scaled sum contrast for hemisphere (<code>Elect_site</code>) as well as an interaction of emotional facial expressions with hemisphere. The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Hap_Neu + Ang_Neu + Hap_NeuxElect_site + Ang_NeuxElect_site + ,     scale(Age) + scale(WM) + (1 | ID)</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 
  N170_Val<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Val<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Val<span class="op">$</span>N170_Amplitude)

<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(N170_Val<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Val<span class="op">$</span>Condition)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_N170_val =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data=</span>N170_Val)
  res.mod_N170_val =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_val)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_N170_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_val, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_N170_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_val), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  </code></pre></div>
<hr />
</div>
<div id="lmm_n170-homoscedasticity" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_val.lmer2), <span class="kw">residuals</span>(mod_N170_val.lmer2))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>) </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select primes</span>
  P3_Val =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">1</span>) 

<span class="co"># Prepare fixed factors </span>
  P3_Val<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>ID)
  P3_Val<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Val<span class="op">$</span>Stim_Type)

<span class="co"># Re-Name values of emotion condition</span>
  P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">1</span>] =<span class="st"> &quot;happy&quot;</span>
  P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">2</span>] =<span class="st"> &quot;neutral&quot;</span>
  P3_Val<span class="op">$</span>Condition[P3_Val<span class="op">$</span>Condition<span class="op">==</span><span class="dv">3</span>] =<span class="st"> &quot;angry&quot;</span>

<span class="co"># Create factor, get neutral as baseline</span>
  P3_Val<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">factor</span>(P3_Val<span class="op">$</span>Condition, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;neutral&quot;</span>,<span class="st">&quot;happy&quot;</span>,<span class="st">&quot;angry&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(P3_Val<span class="op">$</span>Condition) =<span class="st"> </span><span class="kw">contr.treatment</span>(<span class="dv">3</span>)


<span class="co"># Add contrast columns</span>
  mm_P3_Val =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Condition, P3_Val) 

<span class="co"># Attach to dataframe</span>
  P3_Val[,(<span class="kw">ncol</span>(P3_Val)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Val)<span class="op">+</span><span class="dv">3</span>)] =<span class="st"> </span>mm_P3_Val
  <span class="kw">names</span>(P3_Val)[(<span class="kw">ncol</span>(P3_Val)<span class="op">-</span><span class="dv">2</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Val)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Hap_Neu&quot;</span>, <span class="st">&quot;Ang_Neu&quot;</span>) 

<span class="co"># Get model </span>
  mod_P3_val.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P3_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Improved model</span>
  mod_P3_val.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Ang_Neu<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P3_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Re-check the model</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_val.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_val.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)


<span class="co"># Likelihood ratio testing </span>

<span class="co"># Stimulus type </span>
  mod_P3_val.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA </span>
  <span class="kw">anova</span>(mod_P3_val.lmer2, mod_P3_val.lmer3)


<span class="co"># Final model</span>
  mod_P3_val.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Hap_Neu <span class="op">+</span><span class="st"> </span>Ang_Neu <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Val,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was emotion of Face 1. We applied a treatment contrast comparing neutral vs happy and neutral vs angry emotional facial expressions (<code>Neutral vs Happy</code>, <code>Neutral vs Angry</code>). The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ,     ID) + (1 | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 
  P3_Val<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Val<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Val<span class="op">$</span>mean_ROI_P3)

<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(P3_Val<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Val<span class="op">$</span>Condition)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_P3_val =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Condition, <span class="dt">data=</span>P3_Val)
  res.mod_P3_val =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_val)
  
  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_P3_val =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_val, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_P3_val =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_val), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm_p3-homoscedasticity" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_val.lmer4), <span class="kw">residuals</span>(mod_P3_val.lmer4))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)    </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_val_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results" class="section level4">
<h4><strong>Results</strong></h4>
<!-- Present ERP valence effects -->
<p>P1 Amplitudes at Face 1 were significantly larger for angry in comparison to neutral facial expressions. No difference was found for the contrast of happy vs neutral faces. In contrast to our hypothesis, no differences N170 amplitde difference between happy or angry faces compared to neutral faces were detected. None of the interactions of hemisphere with the emotion contrasts reached significance. In line with our hypothesis, angry faces elicited larger amplitudes compared to neutral faces. No difference, however, was found between happy and neutral faces.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define labels </span>
labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Happy vs Neutral&quot;</span>, <span class="st">&quot;Angry vs Neutral&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>,<span class="st">&quot;HvsN X ROI&quot;</span>, <span class="st">&quot;AvsN X ROI&quot;</span>)

<span class="co"># Create table</span>
  <span class="kw">tab_model</span>(mod_P1_val.lmer4, mod_N170_val.lmer2, mod_P3_val.lmer4,
          <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>,
          <span class="dt">pred.labels=</span>labels,
          <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>,
          <span class="dt">show.se=</span><span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,
          <span class="dt">show.stat=</span><span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>,
          <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, 
          <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">TRUE</span>,
          <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;P1 Amplitudes&quot;</span>,<span class="st">&quot;N170 Amplitudes&quot;</span>,<span class="st">&quot;P3 Amplitudes&quot;</span>),
          <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.99
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.121
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.40
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.843
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.349
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.60
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.65
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.46
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>0.014</strong>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.41
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.164
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
0.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
2.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
<strong>0.030</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.239
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.998
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.94
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.070
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.922
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.867
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.20
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.852
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
HvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.57
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.371
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
AvsN X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.52
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.59
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.372
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
198.92
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
156.55
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
277.65
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
25.12 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
10.09 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.38 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
29.41 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.10
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2859
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
5718
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2859
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.008 / 0.119
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.001 / 0.061
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.014 / 0.110
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="categorization-effects" class="section level1">
<h1>Categorization effects</h1>
<p>We hypothesized that ERP amplitudes for Face 2 would decrease in response to an identical Face 1.</p>
<p><br></p>
<div id="descriptive-statistics-1" class="section level4">
<h4><strong>Descriptive statistics</strong></h4>
<!-- Plot ERP morphology and topography -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## P1 and P3

<span class="co"># Load Face 2 data</span>
  Face2_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/ROI_P1_P3_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)

<span class="co"># De-select participants</span>
  Face2_data =<span class="st"> </span>Face2_data[<span class="kw">with</span>(Face2_data, <span class="op">!</span>(Face2_data<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]

<span class="co"># Select time window of interest</span>
  Face2_data =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>),]

<span class="co"># Rename values of Face2 condition</span>
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;
  Face2_data<span class="op">$</span>Condition[Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;

<span class="co"># Plot ERP trajectory for P1/P3</span>
  Face2_data_icc =<span class="st"> </span>Face2_data[(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face2_data<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]
  
  P1_cat_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_data_icc,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">5</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">axis.text=</span><span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="fl">0.8</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> nov_col)<span class="op">+</span>
<span class="st">    </span><span class="co">#ggtitle(&quot;P1 &amp; P3&quot;) +</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">      </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">18</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">18</span>,<span class="dv">4</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">120</span>, <span class="dt">y=</span><span class="fl">16.8</span>, <span class="dt">label =</span> <span class="st">&quot;P1&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">350</span>, <span class="dt">y=</span><span class="fl">14.8</span>, <span class="dt">label =</span> <span class="st">&quot;P3&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)

## N170
  Face2_data_l =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/left_ROI_N170_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)
  Face2_data_r =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;./data/right_ROI_N170_Face2.csv&quot;</span>,<span class="dt">header =</span> <span class="ot">TRUE</span>)

<span class="co"># De-select participants</span>
  Face2_data_l =<span class="st"> </span>Face2_data_l[<span class="kw">with</span>(Face2_data_l, <span class="op">!</span>(Face2_data_l<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]
  Face2_data_r =<span class="st"> </span>Face2_data_r[<span class="kw">with</span>(Face2_data_r, <span class="op">!</span>(Face2_data_r<span class="op">$</span>ID<span class="op">==</span><span class="st">&quot;05&quot;</span>)), ]

<span class="co"># Select time window of interest</span>
  Face2_data_l =<span class="st"> </span>Face2_data_l[(Face2_data_l<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data_l<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>),]
  Face2_data_r =<span class="st"> </span>Face2_data_r[(Face2_data_r<span class="op">$</span>Time <span class="op">&gt;=</span><span class="st"> </span><span class="op">-</span><span class="dv">200</span>)<span class="op">&amp;</span><span class="st"> </span>(Face2_data_r<span class="op">$</span>Time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">1000</span>),]

<span class="co"># Rename conditions</span>
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;
  Face2_data_l<span class="op">$</span>Condition[Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;

  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">1</span>]=<span class="st">&#39;repeated&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">2</span>]=<span class="st">&#39;novel&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">3</span>]=<span class="st">&#39;prime&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">4</span>]=<span class="st">&#39;c_happy&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">5</span>]=<span class="st">&#39;c_neutral&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">6</span>]=<span class="st">&#39;c_angry&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">7</span>]=<span class="st">&#39;ic_happy&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">8</span>]=<span class="st">&#39;ic_neutral&#39;</span>;
  Face2_data_r<span class="op">$</span>Condition[Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> </span><span class="dv">9</span>]=<span class="st">&#39;ic_angry&#39;</span>;

<span class="co"># Select conditions of interest</span>
  Face2_data_icc_l =<span class="st"> </span>Face2_data_l[(Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>)  <span class="op">|</span><span class="st"> </span>(Face2_data_l<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]
  Face2_data_icc_r =<span class="st"> </span>Face2_data_r[(Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;repeated&#39;</span>) <span class="op">|</span><span class="st"> </span>(Face2_data_r<span class="op">$</span>Condition <span class="op">==</span><span class="st"> &#39;novel&#39;</span>),]
  
  Face2_data_icc_l<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">as.factor</span>(Face2_data_icc_l<span class="op">$</span>Condition)
  Face2_data_icc_r<span class="op">$</span>Condition =<span class="st"> </span><span class="kw">as.factor</span>(Face2_data_icc_r<span class="op">$</span>Condition)
  
<span class="co"># Average N170 trajectories for left and right hemisphere  </span>
  Face2_N170 =<span class="st"> </span>(Face2_data_icc_l <span class="op">+</span><span class="st"> </span>Face2_data_icc_r)<span class="op">/</span><span class="dv">2</span>
  Face2_N170<span class="op">$</span>Condition =<span class="st"> </span>Face2_data_icc_l<span class="op">$</span>Condition  
  
<span class="co"># Plot N170 trajectory</span>
  N170_cat_traj =<span class="st"> </span><span class="kw">ggplot</span>(Face2_N170,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">20</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)))<span class="op">+</span>
<span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>,<span class="dt">size =</span> <span class="fl">0.8</span> ,<span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span>  nov_col)<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>)<span class="op">+</span><span class="st">          </span><span class="co"># turn off legend</span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_text</span>(<span class="dt">x=</span><span class="dv">200</span>, <span class="dt">y=</span><span class="op">-</span><span class="dv">5</span>, <span class="dt">label =</span> <span class="st">&quot;N170&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="dv">3</span>)
  
<span class="co"># Load topography information</span>
  Topo_Cat =<span class="st"> </span><span class="kw">read.csv</span>(<span class="dt">file=</span><span class="st">&quot;./data/ERPs_Topo_Face2.csv&quot;</span>, <span class="dt">header=</span><span class="ot">TRUE</span>, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)

<span class="co"># Remove participant 5</span>
  Topo_Cat =<span class="st"> </span>Topo_Cat[<span class="kw">with</span>(Topo_Cat, <span class="op">!</span>(Topo_Cat<span class="op">$</span>ID<span class="op">==</span><span class="dv">5</span>)), ]

<span class="co"># Re-name to fit topoplot function</span>
  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;Time&quot;</span>] =<span class="st"> &quot;time&quot;</span>

<span class="co"># Change from wide to long format for electrodes</span>
  Topo_Cat =<span class="st"> </span><span class="kw">gather</span>(Topo_Cat, electrode, amplitude, Fp1<span class="op">:</span>Oz, <span class="dt">factor_key=</span><span class="ot">TRUE</span>)

<span class="co"># Rename A1/A2</span>
  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A1&quot;</span>] &lt;-<span class="st"> &quot;TP9&quot;</span>
  <span class="kw">names</span>(Topo_Cat)[<span class="kw">names</span>(Topo_Cat) <span class="op">==</span><span class="st"> &quot;A2&quot;</span>] &lt;-<span class="st"> &quot;TP10&quot;</span>

<span class="co"># Plot topoplots for repeated trials</span>
  Topo_Cat_Rep =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">10</span>)

<span class="co"># Plot topoplots for novel trials</span>
  Topo_Cat_Nov =<span class="st"> </span><span class="kw">subset</span>(Topo_Cat, Condition <span class="op">==</span><span class="st"> </span><span class="dv">11</span>)
  
  
<span class="co"># Calculate difference score novel-repeated</span>
  Topo_Diff_Nov_Rep =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">ID =</span> Topo_Cat_Rep[,<span class="dv">1</span>], <span class="dt">time =</span> Topo_Cat_Rep[,<span class="dv">3</span>],
                                  <span class="dt">electrode =</span> Topo_Cat_Rep[,<span class="dv">4</span>], <span class="dt">amplitude =</span> Topo_Cat_Nov<span class="op">$</span>amplitude <span class="op">-</span><span class="st"> </span>Topo_Cat_Rep<span class="op">$</span>amplitude)  
  
## P1

<span class="co"># Select time windows</span>
  Topo_Diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">80</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">120</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_P1, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

  topo_diff_Nov_Rep_P1 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  
  
## N170
  
<span class="co"># Select time windows</span>
  Topo_Diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">170</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">230</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_N170, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

  
  topo_diff_Nov_Rep_N170 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (170-230 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  
## P3
  
<span class="co"># Select time windows</span>
  Topo_Diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">subset</span>(Topo_Diff_Nov_Rep, time <span class="op">&gt;=</span><span class="st"> </span><span class="dv">300</span> <span class="op">&amp;</span><span class="st"> </span>time <span class="op">&lt;=</span><span class="st"> </span><span class="dv">600</span>)

<span class="co"># Add electrode information  </span>
  Topo_Diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">electrode_locations</span>(Topo_Diff_Nov_Rep_P3, <span class="dt">electrode =</span> <span class="st">&quot;electrode&quot;</span>,  <span class="dt">drop =</span> <span class="ot">FALSE</span>,<span class="dt">montage =</span> <span class="ot">NULL</span>)

  
  topo_diff_Nov_Rep_P3 =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-600 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Amplitude (&quot;</span>, mu,<span class="st">&quot;V)&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get legend for trajectories</span>
  traj_leg_cat =<span class="kw">ggplot</span>(Face2_data_icc,<span class="kw">aes</span>(Time,ROI_Average))<span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(),<span class="dt">panel.border =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">fill=</span><span class="ot">NA</span>, <span class="dt">size=</span><span class="dv">2</span>),
          <span class="dt">axis.title.y =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="dv">0</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
          <span class="dt">axis.title.x =</span> <span class="kw">element_text</span>(<span class="dt">margin =</span> <span class="kw">margin</span>(<span class="dt">t =</span> <span class="op">-</span><span class="dv">5</span>, <span class="dt">r =</span> <span class="dv">10</span>, <span class="dt">b =</span> <span class="dv">0</span>, <span class="dt">l =</span> <span class="dv">0</span>)),
         <span class="dt">legend.key =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">&quot;white&quot;</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">stat_summary</span>(<span class="dt">fun.y =</span> mean,<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>,<span class="kw">aes</span>(<span class="dt">colour=</span> Condition))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_colour_manual</span>(<span class="dt">values =</span> nov_col)<span class="op">+</span>
<span class="st">    </span><span class="co">#ggtitle(&quot;P1 &amp; P3&quot;) +</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;bottom&quot;</span>)<span class="op">+</span><span class="st">      </span>
<span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">time (ms)&quot;</span>,<span class="dt">y =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;Mean ROI amplitude [&quot;</span>,mu,<span class="st">&quot;V]&quot;</span>)),<span class="dt">colour =</span> <span class="st">&quot;&quot;</span>)<span class="op">+</span>
<span class="st">    </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">17</span>),<span class="dt">xlim=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">17</span>,<span class="dv">2</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">100</span>,<span class="dv">600</span>,<span class="dv">100</span>))<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span> )<span class="op">+</span>
<span class="st">    </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>,<span class="dt">linetype =</span> <span class="st">&quot;dashed&quot;</span>,<span class="dt">colour=</span><span class="st">&quot;grey&quot;</span>)

  traj_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(traj_leg_cat)

<span class="co"># Get legend for topos</span>
  topo_P1_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P1, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P1 (80-120 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  
  topo_P1_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_P1_leg_cat)
  
  topo_N170_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_N170, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;N170 (170-230 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
  
  topo_N170_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_N170_leg_cat)
  
  topo_P3_leg_cat =<span class="st"> </span><span class="kw">ggplot</span>(Topo_Diff_Nov_Rep_P3, <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> amplitude, <span class="dt">label =</span> electrode)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">ggtitle</span>(<span class="st">&quot;P3 (300-600 ms)&quot;</span>)<span class="op">+</span>
<span class="st">                    </span><span class="kw">geom_topo</span>(<span class="dt">grid_res =</span> <span class="dv">300</span>, <span class="dt">interp_limit =</span> <span class="st">&quot;head&quot;</span>, <span class="dt">chan_markers =</span> <span class="st">&quot;point&quot;</span>, <span class="dt">chan_size =</span> <span class="dv">1</span>,
                              <span class="dt">head_size =</span> <span class="fl">1.5</span>) <span class="op">+</span>
<span class="st">                    </span><span class="kw">scale_fill_distiller</span>(<span class="dt">palette =</span> <span class="st">&quot;RdBu&quot;</span> , <span class="dt">limits =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">2.5</span>,<span class="dv">2</span>)) <span class="op">+</span>
<span class="st">                    </span><span class="kw">theme_void</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">coord_equal</span>() <span class="op">+</span>
<span class="st">                    </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;&quot;</span>, mu,<span class="st">&quot;V&quot;</span>)))<span class="op">+</span>
<span class="st">                    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">10</span>, <span class="dt">face =</span> <span class="st">&quot;bold&quot;</span>))
    
    
  topo_P3_leg_cat =<span class="st"> </span><span class="kw">get_legend</span>(topo_P3_leg_cat)


<span class="co"># Get difference label</span>
  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Novel-</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;Repeated</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  nov_rep_text =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">4</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),
          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>())
  
<span class="co"># Get capital letters</span>
  text =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> A</span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> </span><span class="ch">\n</span><span class="st">&quot;</span>,<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> B</span><span class="ch">\n</span><span class="st">&quot;</span>)
  
  first_plot =<span class="st"> </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="dt">x =</span> <span class="dv">4</span>, <span class="dt">y =</span> <span class="dv">25</span>, <span class="dt">size=</span><span class="dv">5</span>, <span class="dt">label =</span> text) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">panel.grid.major=</span><span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor=</span><span class="kw">element_blank</span>(),
          <span class="dt">axis.line =</span> <span class="kw">element_line</span>(<span class="dt">color =</span> <span class="st">&quot;white&quot;</span>,<span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">linetype =</span> <span class="st">&quot;solid&quot;</span>),
          <span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.text.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.y =</span> <span class="kw">element_blank</span>(),
          <span class="dt">axis.title.x =</span> <span class="kw">element_blank</span>(),
          <span class="dt">panel.background =</span> <span class="kw">element_rect</span>(<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">size =</span> <span class="fl">0.5</span>),
          <span class="dt">axis.ticks =</span> <span class="kw">element_blank</span>()) 
  
<span class="co"># Explanation: draw_plot(plot, for position: x = 0, y = 0, width = 1, height = 1)</span>
  <span class="kw">ggdraw</span>(<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.2</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">1.4</span>)) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(first_plot, <span class="op">-</span><span class="fl">0.68</span>, <span class="fl">0.25</span>, <span class="fl">1.4</span>, <span class="fl">1.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(P1_cat_traj, <span class="fl">0.05</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">draw_plot</span>(N170_cat_traj, <span class="fl">0.55</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(traj_leg_cat, <span class="fl">0.45</span>, <span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.25</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(nov_rep_text, <span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_P1, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_P1_leg_cat, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_N170, <span class="fl">0.43</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_N170_leg_cat, <span class="fl">0.58</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_diff_Nov_Rep_P3, <span class="fl">0.75</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">draw_plot</span>(topo_P3_leg_cat, <span class="fl">0.9</span>, <span class="fl">0.15</span>, <span class="fl">0.4</span>, <span class="fl">0.4</span>) </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/ERP_cat_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<p><br></p>
</div>
<div id="model-specification-1" class="section level4 tabset tabset-pills">
<h4><strong>Model specification</strong></h4>
<p><br></p>
<!-- LMM Model specifications -->
<div id="lmm_p1-random-effect-structure-1" class="section level5">
<h5>LMM_P1: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select correct responses</span>
  P1_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)    

<span class="co"># Select targets</span>
  P1_Cat =<span class="st"> </span><span class="kw">subset</span>(P1_Cat,Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>)   

<span class="co"># Prepare fixed factors </span>
  P1_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>ID)
  P1_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P1_Cat<span class="op">$</span>Stim_Type)

<span class="co"># Define novel vs repeated trials</span>
  P1_Cat[P1_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">2</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span>
  P1_Cat[P1_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">3</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span>

<span class="co"># Create factor, get neutral as baseline</span>
  P1_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(P1_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>,<span class="st">&quot;repeated&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(P1_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span> 
           
<span class="co"># Add contrast columns</span>
  mm_P1_Cat =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Group_pcic, P1_Cat) 

<span class="co"># Attach to dataframe</span>
  P1_Cat[,(<span class="kw">ncol</span>(P1_Cat)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P1_Cat)<span class="op">+</span><span class="dv">2</span>)] =<span class="st"> </span>mm_P1_Cat
  <span class="kw">names</span>(P1_Cat)[(<span class="kw">ncol</span>(P1_Cat)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(P1_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Nov_Rep&quot;</span>) 

<span class="co"># Build model </span>
  mod_P1_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P1_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P1_cat.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P1_cat.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)
  
  mod_P1_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P1_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

## Likelihood-ratio testing

<span class="co"># Stim_Type</span>
  mod_P1_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P1_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_P1_cat.lmer2, mod_P1_cat.lmer3)


<span class="co"># Final model</span>
  mod_P1_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P1 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>ID),
                          <span class="dt">data =</span> P1_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P1 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID)</code></p>
<hr />
</div>
<div id="lmm_p1-normality-of-residuals-1" class="section level5">
<h5>LMM_P1: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 
  P1_Cat<span class="op">$</span>Trans_P1 =<span class="st"> </span>P1_Cat<span class="op">$</span>mean_ROI_P1 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P1_Cat<span class="op">$</span>mean_ROI_P1)

<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(P1_Cat<span class="op">$</span>Trans_P1 <span class="op">~</span><span class="st"> </span>P1_Cat<span class="op">$</span>Group_pcic)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P1 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_P1_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P1 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data=</span>P1_Cat)
  res.mod_P1_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P1_Cat)

  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_P1_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P1_Cat, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_P1_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P1_Cat), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm_p1-homoscedasticity-1" class="section level5">
<h5>LMM_P1: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P1_cat.lmer4), <span class="kw">residuals</span>(mod_P1_cat.lmer4))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)     </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P1_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_n170-random-effect-structure-1" class="section level5">
<h5>LMM_N170: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Select targets</span>
  N170_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) 

<span class="co"># Select correct responses</span>
  N170_Cat =<span class="st"> </span><span class="kw">subset</span>(N170_Cat, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)    

<span class="co"># Define novel vs repeated trials</span>
  N170_Cat[N170_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">2</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span>
  N170_Cat[N170_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">3</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span>

<span class="co"># Separate data in left and right hemisphere</span>
  N170_Cat =<span class="st"> </span><span class="kw">gather</span> (N170_Cat, Elect_site, N170_Amplitude, mean_ROI_N170l<span class="op">:</span>mean_ROI_N170r, <span class="dt">factor_key =</span> <span class="ot">TRUE</span>)
  N170_Cat<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">as.character</span>(N170_Cat<span class="op">$</span>Elect_site)

<span class="co"># Add variable name</span>
  N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170l&quot;</span>] =<span class="st"> &#39;left&#39;</span>
  N170_Cat<span class="op">$</span>Elect_site[N170_Cat<span class="op">$</span>Elect_site <span class="op">==</span><span class="st"> &quot;mean_ROI_N170r&quot;</span>] =<span class="st"> &quot;right&quot;</span>

<span class="co"># Set contrast for elect site</span>
  N170_Cat<span class="op">$</span>Elect_site =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>Elect_site)
  <span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>Elect_site) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

<span class="co"># Factor random factors </span>
  N170_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>ID)
  N170_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(N170_Cat<span class="op">$</span>Stim_Type)

<span class="co"># Create factor, get neutral as baseline</span>
  N170_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(N170_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>,<span class="st">&quot;repeated&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(N170_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

<span class="co"># Add contrast columns</span>
  mm_N170_Cat =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Group_pcic <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span>Group_pcic<span class="op">*</span>Elect_site, N170_Cat) 

<span class="co"># Attach to dataframe</span>
  N170_Cat[,(<span class="kw">ncol</span>(N170_Cat)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(N170_Cat)<span class="op">+</span><span class="dv">4</span>)] =<span class="st"> </span>mm_N170_Cat
  <span class="kw">names</span>(N170_Cat)[(<span class="kw">ncol</span>(N170_Cat)<span class="op">-</span><span class="dv">3</span>)<span class="op">:</span><span class="kw">ncol</span>(N170_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Nov_Rep&quot;</span>,<span class="st">&quot;Elect_site&quot;</span>,<span class="st">&quot;Nov_RepxElect_site&quot;</span>) 

<span class="co"># Get model </span>
  mod_N170_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>Stim_Type),
                            <span class="dt">data =</span> N170_Cat,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Improved model </span>
  mod_N170_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>ID),
                            <span class="dt">data =</span> N170_Cat,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Re-check variances</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_N170_cat.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_N170_cat.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

## Likelihood ratio testing 

<span class="co"># ID</span>
  mod_N170_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">|</span>ID),
                            <span class="dt">data =</span> N170_Cat,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_N170_cat.lmer2 ,mod_N170_cat.lmer3 )

<span class="co"># Final model</span>
  mod_N170_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(N170_Amplitude <span class="op">~</span><span class="st"> </span>
<span class="st">                              </span>Nov_Rep <span class="op">+</span><span class="st"> </span>Nov_RepxElect_site <span class="op">+</span><span class="st"> </span>Elect_site <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                              </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Elect_site<span class="op">||</span>ID),
                            <span class="dt">data =</span> N170_Cat,
                            <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions. For the N170, we also added a scaled sum contrast for Hemisphere (<code>ROI</code>) and the interaction of novelty with hemisphere (<code>NvsR x ROI</code>).The final model was comprised of:</p>
<p><code>N170_Amplitude ~ Nov_Rep + Nov_RepxElect_site + Elect_site + ,     scale(Age) + scale(WM) + ((1 | ID) + (0 + Elect_site | ID))</code></p>
<hr />
</div>
<div id="lmm_n170-normality-of-residuals-1" class="section level5">
<h5>LMM_N170: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 
  N170_Cat<span class="op">$</span>Trans_N170 =<span class="st"> </span>N170_Cat<span class="op">$</span>N170_Amplitude <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(N170_Cat<span class="op">$</span>N170_Amplitude)
  
<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(N170_Cat<span class="op">$</span>Trans_N170 <span class="op">~</span><span class="st"> </span>N170_Cat<span class="op">$</span>Group_pcic)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>N170 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_N170_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_N170 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data=</span>N170_Cat)
  res.mod_N170_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_N170_Cat)

  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_N170_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_N170_Cat, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_N170_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_N170_Cat), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))  </code></pre></div>
<hr />
</div>
<div id="lmm_n170-homoscedasticity-1" class="section level5">
<h5>LMM_N170: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_N170_cat.lmer4), <span class="kw">residuals</span>(mod_N170_cat.lmer4))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)         </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/N170_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
<div id="lmm_p3-random-effect-structure-1" class="section level5">
<h5>LMM_P3: Random effect structure</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Correct responses</span>
  P3_Cat =<span class="st"> </span><span class="kw">subset</span>(ERP_data, Response <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)

<span class="co"># Factor random factors </span>
  P3_Cat<span class="op">$</span>ID =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>ID)
  P3_Cat<span class="op">$</span>Stim_Type =<span class="st"> </span><span class="kw">as.factor</span>(P3_Cat<span class="op">$</span>Stim_Type)

<span class="co"># Select targets</span>
  P3_Cat =<span class="st"> </span><span class="kw">subset</span>(P3_Cat,Group_pt <span class="op">==</span><span class="st"> </span><span class="dv">2</span>) 

<span class="co"># Define novel vs repeated trials</span>
  P3_Cat[P3_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">2</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;repeated&quot;</span>
  P3_Cat[P3_Cat<span class="op">$</span>Group_pcic<span class="op">==</span><span class="dv">3</span>,]<span class="op">$</span>Group_pcic =<span class="st"> &quot;novel&quot;</span>

<span class="co"># Create factor, get neutral as baseline</span>
  P3_Cat<span class="op">$</span>Group_pcic =<span class="st"> </span><span class="kw">factor</span>(P3_Cat<span class="op">$</span>Group_pcic, <span class="dt">levels=</span><span class="kw">c</span>(<span class="st">&quot;novel&quot;</span>,<span class="st">&quot;repeated&quot;</span>))

<span class="co"># Set treatment contrast</span>
  <span class="kw">contrasts</span>(P3_Cat<span class="op">$</span>Group_pcic) =<span class="st"> </span><span class="kw">contr.sum</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>

           
<span class="co"># Add contrast columns</span>
  mm_P3_Cat =<span class="st">  </span><span class="kw">model.matrix</span>( <span class="op">~</span><span class="st"> </span>Group_pcic, P3_Cat) 

<span class="co"># Attach to dataframe</span>
  P3_Cat[,(<span class="kw">ncol</span>(P3_Cat)<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="kw">ncol</span>(P3_Cat)<span class="op">+</span><span class="dv">2</span>)] =<span class="st"> </span>mm_P3_Cat
  <span class="kw">names</span>(P3_Cat)[(<span class="kw">ncol</span>(P3_Cat)<span class="op">-</span><span class="dv">1</span>)<span class="op">:</span><span class="kw">ncol</span>(P3_Cat)] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Mean&quot;</span>,<span class="st">&quot;Nov_Rep&quot;</span>) 

<span class="co"># Get model </span>
  mod_P3_cat.lmer1 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>Stim_Type),
                          <span class="dt">data =</span> P3_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># 1st: check how many zero variance terms you got in random effects</span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer1))

<span class="co"># 2nd: check which random terms explain the least variance</span>
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer1),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

<span class="co"># Improved model</span>
  mod_P3_cat.lmer2 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">||</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Re-check the model  </span>
  <span class="kw">summary</span>(<span class="kw">rePCA</span>(mod_P3_cat.lmer2))
  <span class="kw">print</span>(<span class="kw">VarCorr</span>(mod_P3_cat.lmer2),<span class="dt">comp =</span> <span class="st">&quot;Variance&quot;</span>)

## Likelhood ratio testing

<span class="co"># ID</span>
  mod_P3_cat.lmer3 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_P3_cat.lmer2,mod_P3_cat.lmer3)

<span class="co"># Stim_Type</span>
  mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))

<span class="co"># Calculate ANOVA</span>
  <span class="kw">anova</span>(mod_P3_cat.lmer2,mod_P3_cat.lmer4)


<span class="co"># Final model</span>
  mod_P3_cat.lmer4 =<span class="st"> </span><span class="kw">lmer</span>(mean_ROI_P3 <span class="op">~</span><span class="st"> </span>
<span class="st">                            </span>Nov_Rep <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(Age) <span class="op">+</span><span class="st"> </span><span class="kw">scale</span>(WM) <span class="op">+</span><span class="st"> </span>
<span class="st">                            </span>(<span class="dv">1</span><span class="op">|</span>ID) <span class="op">+</span>
<span class="st">                            </span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>Nov_Rep<span class="op">|</span>Stim_Type),
                          <span class="dt">data =</span> P3_Cat,
                          <span class="dt">control=</span><span class="kw">lmerControl</span>(<span class="dt">calc.derivs =</span> <span class="ot">FALSE</span>))</code></pre></div>
<p>According to our hypothesis, the main fixed effects of interest was novelty of Face 2. We applied a scaled sum contrast to compare trials with novel vs repeated emotional facial expressions (<code>Novel vs Repeated</code>. The final model was comprised of:</p>
<p><code>mean_ROI_P3 ~ Nov_Rep + scale(Age) + scale(WM) + (1 | ID) + (0 + ,     Nov_Rep | Stim_Type)</code></p>
<hr />
</div>
<div id="lmm_p3-normality-of-residuals-1" class="section level5">
<h5>LMM_P3: Normality of residuals</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Check properties of DV / residuals 
  P3_Cat<span class="op">$</span>Trans_P3 =<span class="st"> </span>P3_Cat<span class="op">$</span>mean_ROI_P3 <span class="op">+</span><span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(P3_Cat<span class="op">$</span>mean_ROI_P3)

<span class="co"># To make sure residuals follow ND: Calculate box-cox plot</span>
  <span class="kw">boxcox</span>(P3_Cat<span class="op">$</span>Trans_P3 <span class="op">~</span><span class="st"> </span>P3_Cat<span class="op">$</span>Group_pcic)   </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_box-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>P3 amplitudes met the assumption of normally distributed residuals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Visualize normality assumption of residuals (without log transform)</span>
  mod_P3_Cat =<span class="st"> </span><span class="kw">lm</span>(Trans_P3 <span class="op">~</span><span class="st"> </span>Group_pcic, <span class="dt">data=</span>P3_Cat)
  res.mod_P3_Cat =<span class="st"> </span><span class="kw">residuals</span>(mod_P3_Cat)

  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))
  qqpl_mod_P3_Cat =<span class="st"> </span><span class="kw">qqPlot</span>(res.mod_P3_Cat, <span class="dt">main=</span><span class="st">&quot;QQplot before transformation&quot;</span>)    
  norm_mod_P3_Cat =<span class="st"> </span><span class="kw">plot</span>(<span class="kw">density</span>(res.mod_P3_Cat), <span class="dt">main=</span><span class="st">&quot;Density plot before transformation&quot;</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_res_plot-1.png" width="576" style="display: block; margin: auto;" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">  <span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<hr />
</div>
<div id="lmm_p3-homoscedasticity-1" class="section level5">
<h5>LMM_P3: Homoscedasticity</h5>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Check homoscedasticity  </span>
  <span class="kw">plot</span>(<span class="kw">fitted</span>(mod_P3_cat.lmer4), <span class="kw">residuals</span>(mod_P3_cat.lmer4))
  <span class="kw">abline</span>(<span class="dv">0</span>, <span class="dv">0</span>)  </code></pre></div>
<p><img src="R_Script_3_ERP_measures_files/figure-html/P3_cat_homosk-1.png" width="576" style="display: block; margin: auto;" /></p>
<p>Based on visual inspection, we assumed homoscedasticity.</p>
<hr />
</div>
</div>
<div id="results-1" class="section level4">
<h4><strong>Results</strong></h4>
<p>In contrast to our hypothesis, we did not find P1 amplitude difference between trials with novel in contrast to repeated emotions. We also failed to find a significant effect of novelty for N170 amplitudes. Neither the main effect of hemisphere nor the interaction of hemisphere with novelty was significant. P3 amplitudes did not differ for novelty either.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Define labels</span>
  labels =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Novel vs Repeated&quot;</span>, <span class="st">&quot;Age&quot;</span>, <span class="st">&quot;Working Memory&quot;</span>,<span class="st">&quot;NvsR X ROI&quot;</span>, <span class="st">&quot;ROI&quot;</span>)

<span class="co"># Create table</span>
  <span class="kw">tab_model</span>(mod_P1_cat.lmer4, mod_N170_cat.lmer4, mod_P3_cat.lmer4, 
            <span class="dt">show.intercept =</span> <span class="ot">FALSE</span>,
            <span class="dt">pred.labels=</span>labels,
            <span class="dt">string.est =</span> <span class="st">&quot;b&quot;</span>,
            <span class="dt">show.se=</span><span class="ot">TRUE</span>, <span class="dt">string.se =</span> <span class="st">&quot;SE&quot;</span>,
            <span class="dt">show.stat=</span><span class="ot">TRUE</span>, <span class="dt">string.stat =</span> <span class="st">&quot;t&quot;</span>,
            <span class="dt">show.ci =</span> <span class="ot">FALSE</span>, 
            <span class="dt">show.re.var =</span> <span class="ot">TRUE</span>, <span class="dt">show.obs =</span> <span class="ot">TRUE</span>,
            <span class="dt">emph.p =</span> <span class="ot">TRUE</span>, <span class="dt">dv.labels=</span><span class="kw">c</span>(<span class="st">&quot;P1 Amplitudes&quot;</span>,<span class="st">&quot;N170 Amplitudes&quot;</span>,<span class="st">&quot;P3 Amplitudes&quot;</span>),
            <span class="dt">show.icc =</span> <span class="ot">TRUE</span>)</code></pre></div>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P1 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
N170 Amplitudes
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
P3 Amplitudes
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  0">
b
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  1">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  2">
t
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  3">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.54
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.77
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.076
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.19
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.738
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.925
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.89
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.73
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.084
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.67
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.63
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.282
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
1.71
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.27
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
1.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.176
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working Memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.35
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.728
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.56
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.64
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.383
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
1.29
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
0.953
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
NvsR X ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.31
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.779
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
ROI
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.224
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  0">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  1">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  2">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  3">
</td>
</tr>
<tr>
<td colspan="13" style="font-weight:bold; text-align:left; padding-top:.8em;">
Random Effects
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
σ<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
180.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
147.48
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
231.64
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>00</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28.36 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.48 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
11.89 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
38.39 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
τ<sub>11</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
13.85 <sub>ID.1.Elect_siteright</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ρ<sub>01</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.41 <sub>ID.1</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
ICC
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.14
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
 
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
40 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Observations
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1170
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
2340
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
1170
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.022 / 0.155
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.006 / 0.006
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
0.011 / 0.152
</td>
</tr>
</table>
<p><br></p>
<p><em>Note:</em> p-values for the fixed effects calculated using Wald-statistics approximation, uncorrected. <em>b</em>: unstandardized coefficient; <em>SE</em>: standard error; <em>t</em>: test statistic coefficient; <em>p</em>: p-value; <em>σ2</em>: within-group variance; <em>τ00</em>: between-group variance; <em>ICC</em>: interclass correlation (ratio of between-cluster variance to total variance); <em>N</em>: number of random effects.</p>
</div>
</div>
<div id="session-info" class="section level1">
<h1>Session info</h1>
<!-- Provide session info  -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Get session info </span>
  <span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>R version 3.6.2 (2019-12-12)
Platform: x86_64-w64-mingw32/x64 (64-bit)
Running under: Windows 10 x64 (build 16299)

Matrix products: default

locale:
[1] LC_COLLATE=German_Germany.1252  LC_CTYPE=German_Germany.1252   
[3] LC_MONETARY=German_Germany.1252 LC_NUMERIC=C                   
[5] LC_TIME=German_Germany.1252    

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] gvlma_1.0.0.3        eegUtils_0.5.0       akima_0.6-2         
 [4] forcats_0.5.0        stringr_1.4.0        purrr_0.3.4         
 [7] readr_1.3.1          tidyr_1.0.2          tibble_3.0.1        
[10] tidyverse_1.3.0      sjlabelled_1.1.3     sjmisc_2.8.4        
[13] sjPlot_2.8.3         Rmisc_1.5            plyr_1.8.6          
[16] reshape2_1.4.4       psych_1.9.12.31      MASS_7.3-51.5       
[19] lmerTest_3.1-2       lme4_1.1-23          Matrix_1.2-18       
[22] Hmisc_4.4-0          Formula_1.2-3        survival_3.1-8      
[25] lattice_0.20-38      ggstatsplot_0.4.0    ez_4.4-0            
[28] EnvStats_2.3.1       eeptools_1.2.2       ggplot2_3.3.0       
[31] dplyr_0.8.5          cowplot_1.0.0        table1_1.2          
[34] miceadds_3.9-14      mice_3.9.0           rmdformats_0.3.7    
[37] XLConnectJars_0.2-15 XLConnect_1.0.1      kableExtra_1.1.0    

loaded via a namespace (and not attached):
 [1] estimability_1.3       R.methodsS3_1.8.0      coda_0.19-3           
 [4] acepack_1.4.1          knitr_1.28             R.utils_2.9.2         
 [7] multcomp_1.4-13        data.table_1.12.8      rpart_4.1-15          
[10] inline_0.3.15          generics_0.0.2         callr_3.4.3           
[13] TH.data_1.0-10         future_1.17.0          correlation_0.2.0     
[16] lubridate_1.7.8        webshot_0.5.2          xml2_1.3.1            
[19] httpuv_1.5.2           StanHeaders_2.21.0-1   assertthat_0.2.1      
[22] viridis_0.5.1          WRS2_1.0-0             xfun_0.13             
[25] hms_0.5.3              rJava_0.9-12           evaluate_0.14         
[28] promises_1.1.0         tidyBF_0.2.0           fansi_0.4.1           
[31] dbplyr_1.4.3           readxl_1.3.1           htmlwidgets_1.5.1     
[34] DBI_1.1.0              reshape_0.8.8          stats4_3.6.2          
[37] paletteer_1.1.0        ellipsis_0.3.0         rcompanion_2.3.25     
[40] backports_1.1.6        signal_0.7-6           bookdown_0.18         
[43] insight_0.8.3          ggcorrplot_0.1.3       libcoin_1.0-5         
[46] jmvcore_1.2.5          vctrs_0.2.4            abind_1.4-5           
[49] withr_2.2.0            metaBMA_0.6.2          checkmate_2.0.0       
[52] bdsmatrix_1.3-4        emmeans_1.4.6          vcd_1.4-7             
[55] prettyunits_1.1.1      mnormt_1.5-6           fastGHQuad_1.0        
[58] cluster_2.1.0          lazyeval_0.2.2         crayon_1.3.4          
[61] labeling_0.3           pkgconfig_2.0.3        nlme_3.1-147          
[64] statsExpressions_0.4.1 palr_0.2.0             nnet_7.3-12           
[67] pals_1.6               globals_0.12.5         rlang_0.4.5           
[70] lifecycle_0.2.0        miniUI_0.1.1.1         groupedstats_0.2.2    
[73] skimr_2.1.1            LaplacesDemon_16.1.4   MatrixModels_0.4-1    
 [ reached getOption(&quot;max.print&quot;) -- omitted 126 entries ]</code></pre>
</div>

    </div>
    <div class="col-xs-2">
        <div class="btn-toolbar">
    <div class="btn-group">
    <a href="#" class="btn btn-raised btn-sm dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="text-muted">Code</span> <span class="text-muted caret"></span></a>
    <ul class="dropdown-menu" style="min-width: 50px;">
    <li><a id="rmd-show-all-code" href="#">Show All</a></li>
    <li><a id="rmd-hide-all-code" href="#">Hide All</a></li>
    </ul>
    </div>
    </div>
        </div>
  </div>
  </div>
  </div>
  <div class="row">
    </div>
  </div>

<script>
$(document).ready(function () {
  // add bootstrap table styles to pandoc tables
  $('tr.header').parent('thead').parent('table').addClass('table table-striped table-hover');

  
    $('.pages img')
 	  .addClass("image-lb");
  $('.pages').magnificPopup({
	      type:'image',
	      closeOnContentClick: false,
	      closeBtnInside: false,
        delegate: 'img',
	      gallery: {enabled: true },
          removalDelay: 500,
          callbacks: {
              beforeOpen: function() {
                // just a hack that adds mfp-anim class to markup
                this.st.image.markup = this.st.image.markup.replace('mfp-figure', 'mfp-figure mfp-with-anim');
              }
          },
          mainClass: 'mfp-move-from-top',
	      image: {
	        verticalFit: true,
            titleSrc: 'alt'
	      }
 	    });
 	
    
    $('#toc ul li').first().addClass("active");
    $('#toc ul li').attr("data-target", function() {
        return($(this).children("a").attr("href"));
    })
    $('body .section.level1').first().addClass("active");
    $('body .section.level1').not('.active').hide();
    
    $('#toc a[href*="#"]').click(function() {

      var id = $(this).attr("href");
      if (id === "#") return;
      if (id.substring(0, 8) === "#dyntab-") return;
      toggle_page(id);

      // Menu
      var menu_entry = $(".menu li[data-target='"+id+"']");
      menu_entry.addClass("active");
      $(".menu li").not(menu_entry).removeClass("active"); 
      

    });

    function toggle_page(id) {
      $(".page").not(page).removeClass("active").hide();
      window.page = id;
      var page = $(window.page);
      window.location.hash = window.page;
      //$(this).addClass("active");

      page.show();

      var totop = setInterval(function () {
        $(".pages").animate({scrollTop: 0}, 0);
      }, 10);

      setTimeout(function () {
        page.addClass("active");
        setTimeout(function () {
          clearInterval(totop);
        }, 1000);
      }, 100);

      window.dispatchEvent(new Event('resize'));

    }


    $(".menu li").click(function () {

      toggle_page($(this).data("target"));

      // Menu
      if (!$(this).data("target")) return;
      if ($(this).is(".active")) return;
      $(".menu li").not($(this)).removeClass("active");
      $(this).addClass("active");

    });
  
    


    window.page = window.location.hash;
    if (window.page != "") {
      $(".menu").find("li[data-target=" + window.page + "]").trigger("click");
    }

    /* init material bootstrap js */
    $.material.init();
});
</script>




<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
