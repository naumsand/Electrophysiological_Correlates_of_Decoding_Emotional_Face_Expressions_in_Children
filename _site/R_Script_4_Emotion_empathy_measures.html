<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Emotion and empathy measures</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="R_Script_1_Method_Section.html">
    <span class="glyphicon glyphicon-wrench"></span>
     
    Method section
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    EEG task measures
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Emotion and empathy measures</h1>

</div>


<!-- Set up workspace -->
<!-- Load and prepare data sets -->
<pre class="r"><code>  # Concatenate EMT task data --------------------------------------
  
    # Load questionnaire data
      QN_data = readRDS(&quot;./data/QN_data.rds&quot;, refhook = NULL)
    
    # Get data file info
      files_emt = list.files(path=&quot;./data/EMT&quot;, pattern=&quot;*t_file.csv&quot;)
      nfiles = length(files_emt)
  
    # Get EMT task specifics
      
     # Picture order information
        Pic_data = readWorksheetFromFile(&quot;./data/EMT_task_specifics.xlsx&quot;, 
                                     sheet = &quot;Picture_order&quot;, 
                                     startCol = 1,
                                     endCol = 0)

    # Match ID format
        IDs = c(paste(&quot;0&quot;,c(1:2,4,6:9), sep=&quot;&quot;), paste(c(10:33), sep=&quot;&quot;))
        QN_data$ID = IDs
  
    # Set number of trials
        num_trials_emt = 72
    
    # Combine data   
      for (i in 1:nfiles) {
    
        # Get EEG file per subject
        if (i == 27) {
        EMT_Indiv = read.csv(file=paste(&quot;./data/EMT/&quot;,files_emt [i], sep = &quot;&quot;), stringsAsFactors=FALSE, header=TRUE, sep=&quot;;&quot;)
        
        } else{
        EMT_Indiv = read.csv(file=paste(&quot;./data/EMT/&quot;,files_emt [i], sep = &quot;&quot;), header=TRUE, sep=&quot;,&quot;,stringsAsFactors=FALSE)
        }
        
        # Add ID
          EMT_Indiv$ID = substr(files_emt [i],1,2)
        
        # Bring ID to the front
          EMT_Indiv=EMT_Indiv[, c(6,1:5)] 
        
        if (i==1) {
          
          EMT_All = EMT_Indiv # first round: create EMT_All data frame
          
        } else {
          
          EMT_All = rbind(EMT_All,EMT_Indiv) # add to EMT_All data frame 
          
        }
        
        # Clear previous
          remove(EMT_Indiv)
        
      }   
    
    # Add trial number  
      EMT_All$Trial = c(rep(1:num_trials_emt,32))
      
    # Add stimulus information
      EMT_All$Stim_Type = Pic_data$Stimulus[match(EMT_All$Image_1,Pic_data$Image_1,nomatch = NA)] 
      
    # Add age and working memory score 
      EMT_All$Age = QN_data$age[match(EMT_All$ID,QN_data$ID,nomatch = NA)]
      EMT_All$WM = QN_data$WM[match(EMT_All$ID,QN_data$ID,nomatch = NA)]   

  # RT inspection and cleaning ----------------------------------------------
    
    # Re-code RTs into numeric format
      EMT_All$RT_in_ms = as.numeric(EMT_All$RT_in_ms)
        
    # Transform reaction times from seconds to milliseconds 
      EMT_All$RT_in_ms = EMT_All$RT_in_ms*1000 
    
    # Create variables which capture RT outliers (TRUE = outlier, FALSE = kept for further analyses)
      EMT_All$Exclude_smaller_250ms = FALSE
      EMT_All$Exclude_larger_7s = FALSE
      EMT_All$Exclude_MAD = FALSE
    
    # Clean RT_in_ms for values &lt; 250 ms
      EMT_All$Exclude_smaller_250ms[EMT_All$RT_in_ms &lt;=250] = TRUE
    
    # Clean RT_in_ms for values &lt; 10 s
      EMT_All$Exclude_larger_7s[EMT_All$RT_in_ms &gt;=7000] = TRUE
    
    ## Calculate the median absolute deviation for each participant ##       
    
    # Define IDs
      IDs = c(paste(&quot;0&quot;,c(1,2,4:9), sep=&quot;&quot;), paste(c(10:33), sep=&quot;&quot;))
    
    # Set MAD cutoff
      MAD_cutoff = 2.5
    
    # Identify outliers +/- 2.5 times the MAD   
      for (m in 1:length(IDs)) {
        
        EMT_All_outl_ind = subset (EMT_All[EMT_All$Exclude_smaller_250ms==FALSE|EMT_All$Exclude_larger_7s==FALSE,], ID == IDs[m]) 

        MAD_ind = mad(EMT_All_outl_ind$RT_in_ms)
        
        EMT_All[EMT_All$ID==IDs[m],]$Exclude_MAD[EMT_All_outl_ind$RT_in_ms &lt; MAD_ind-MAD_cutoff*MAD_ind | EMT_All_outl_ind$RT_in_ms &gt; MAD_ind+MAD_cutoff*MAD_ind] = TRUE
        
      }
      

  # Save file as .rds -----------------------------------------------------
    
    # Remove image_1 / image_2
      EMT_All = subset(EMT_All, select = -c(2,3) )
      
    # De-select participant     
      EMT_All = EMT_All[with(EMT_All, !(EMT_All$ID==&quot;05&quot;)), ]
      
    # Save .rds file  
      saveRDS(EMT_All, file = &quot;./data/EMT.rds&quot;)</code></pre>
<div id="emotion--and-empathy-related-measures" class="section level3">
<h3>3.3 Emotion- and empathy-related measures</h3>
<p><br></p>
<div id="emotion-matching-task" class="section level4">
<h4>3.3.1 Emotion matching task</h4>
<p><br></p>
<div id="accuracy" class="section level5">
<h5>3.3.1.1 Accuracy</h5>
<hr />
</div>
<div id="assumption-checks" class="section level5 tabset tabset-pills">
<h5>Assumption Checks</h5>
<div id="glmm_emt-random-effect-structure" class="section level6">
<h6>GLMM_EMT: Random effect structure</h6>
<pre class="r"><code> # RT cleaning criteria
            EMT_Acc = subset(EMT_All,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
            
          # Factor random effects 
            EMT_Acc$ID = as.factor(EMT_Acc$ID)
            EMT_Acc$Stim_Type = as.factor(EMT_Acc$Stim_Type)
            
          # Create factor, define neutral as baseline
            EMT_Acc$emotion = factor(EMT_Acc$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))
            
          # Set treatment contrast
            contrasts(EMT_Acc$emotion) = contr.treatment(3)
            
 
        # 1) Construct full model
            
          # Add contrast columns
            mm_c =  model.matrix( ~ emotion, EMT_Acc) 
            
          # Attach to dataframe
            EMT_Acc[,(ncol(EMT_Acc)+1):(ncol(EMT_Acc)+3)] = mm_c
            names(EMT_Acc)[(ncol(EMT_Acc)-2):ncol(EMT_Acc)] = c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 
            
          # Construct model             
            mod_EMT_Acc.glmm1 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                        (1 + Hap_Neu + Ang_Neu ||ID) + 
                                        (1 + Hap_Neu + Ang_Neu ||Stim_Type),                   
                                      data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                      family = binomial)         
            
            
            # 1st: check how many zero variance terms you got in random effects
              summary(rePCA(mod_EMT_Acc.glmm1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                        [,1]  [,2]   [,3]
## Standard deviation     2.61 2.370 0.9531
## Proportion of Variance 0.51 0.422 0.0682
## Cumulative Proportion  0.51 0.932 1.0000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]   [,3]
## Standard deviation     0.844 0.812 0.3587
## Proportion of Variance 0.475 0.440 0.0857
## Cumulative Proportion  0.475 0.914 1.0000</code></pre>
<pre class="r"><code>            # 2nd: check which random terms explain the least variance
              print(VarCorr(mod_EMT_Acc.glmm1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance
##  Stim_Type   Ang_Neu     5.615   
##  Stim_Type.1 Hap_Neu     6.796   
##  Stim_Type.2 (Intercept) 0.908   
##  ID          Ang_Neu     0.713   
##  ID.1        Hap_Neu     0.129   
##  ID.2        (Intercept) 0.660</code></pre>
<pre class="r"><code>            # Likelihood ratio testing 
            
              # ID
                mod_EMT_Acc.glmm2 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1 |ID) + 
                                            (1 + Hap_Neu + Ang_Neu ||Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)    
                
  
                mod_EMT_Acc.glmm3 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1 + Hap_Neu|ID) + 
                                            (1 + Hap_Neu + Ang_Neu ||Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)  
                
                mod_EMT_Acc.glmm4 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1 + Ang_Neu|ID) + 
                                            (1 + Hap_Neu + Ang_Neu || Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)  
            
              # Calculate ANOVA
                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm2)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm2: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | ID) + 
## mod_EMT_Acc.glmm2:     (1 + Hap_Neu + Ang_Neu || Stim_Type)
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm2  9 1394 1441   -688     1376             
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370  5.43      2
##                   Pr(&gt;Chisq)  
## mod_EMT_Acc.glmm2             
## mod_EMT_Acc.glmm1      0.066 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm3)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
## mod_EMT_Acc.glmm3: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu | 
## mod_EMT_Acc.glmm3:     ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370             
## mod_EMT_Acc.glmm3 11 1396 1454   -687     1374     0      0
##                   Pr(&gt;Chisq)
## mod_EMT_Acc.glmm1           
## mod_EMT_Acc.glmm3          1</code></pre>
<pre class="r"><code>                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm4)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
## mod_EMT_Acc.glmm4: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Ang_Neu | 
## mod_EMT_Acc.glmm4:     ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370             
## mod_EMT_Acc.glmm4 11 1391 1449   -685     1369  1.36      0
##                            Pr(&gt;Chisq)    
## mod_EMT_Acc.glmm1                        
## mod_EMT_Acc.glmm4 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>              # Stimulus type 
            
                mod_EMT_Acc.glmm5 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1  + Hap_Neu + Ang_Neu ||ID) + 
                                            (1 + Hap_Neu |Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)    
                
                
                mod_EMT_Acc.glmm6 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1  + Hap_Neu + Ang_Neu ||ID) + 
                                            (1 + Ang_Neu|Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)    
              
                mod_EMT_Acc.glmm7 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                            (1  + Hap_Neu + Ang_Neu ||ID) + 
                                            (1 |Stim_Type),                   
                                          data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                          family = binomial)    
            
              # Calculate ANOVAs
                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm5)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
## mod_EMT_Acc.glmm5: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm5:     Ang_Neu || ID) + (1 + Hap_Neu | Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370             
## mod_EMT_Acc.glmm5 11 1421 1479   -700     1399     0      0
##                   Pr(&gt;Chisq)
## mod_EMT_Acc.glmm1           
## mod_EMT_Acc.glmm5          1</code></pre>
<pre class="r"><code>                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm6)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
## mod_EMT_Acc.glmm6: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm6:     Ang_Neu || ID) + (1 + Ang_Neu | Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370             
## mod_EMT_Acc.glmm6 11 1470 1528   -724     1448     0      0
##                   Pr(&gt;Chisq)
## mod_EMT_Acc.glmm1           
## mod_EMT_Acc.glmm6          1</code></pre>
<pre class="r"><code>                anova(mod_EMT_Acc.glmm1,mod_EMT_Acc.glmm7)</code></pre>
<pre><code>## Data: EMT_Acc
## Models:
## mod_EMT_Acc.glmm7: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm7:     Ang_Neu || ID) + (1 | Stim_Type)
## mod_EMT_Acc.glmm1: Answer ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 + Hap_Neu + 
## mod_EMT_Acc.glmm1:     Ang_Neu || ID) + (1 + Hap_Neu + Ang_Neu || Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_EMT_Acc.glmm7  9 1564 1611   -773     1546             
## mod_EMT_Acc.glmm1 11 1392 1451   -685     1370   175      2
##                            Pr(&gt;Chisq)    
## mod_EMT_Acc.glmm7                        
## mod_EMT_Acc.glmm1 &lt;0.0000000000000002 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>            # Final model
              mod_EMT_Acc.glmm8 = glmer(Answer~ Hap_Neu + Ang_Neu  + scale(Age) + scale(WM) + 
                                        (1 + Hap_Neu + Ang_Neu || ID) + 
                                        (1 + Hap_Neu + Ang_Neu || Stim_Type),                   
                                      data = EMT_Acc,control=glmerControl(calc.derivs = FALSE),
                                      
                                      family = binomial)  </code></pre>
<hr />
</div>
<div id="glmm_emt-overdispersion" class="section level6">
<h6>GLMM_EMT: Overdispersion</h6>
<p>If the p-value is &lt; 0.05, the data are overdispersed. Here p &gt; 0.05. Hence overdispersion is not a problem.</p>
<pre class="r"><code># 2) Assumption check: Appropriate estimation of variance (no overdispersion)
              
              overdisp_fun(mod_EMT_Acc.glmm8)</code></pre>
<pre><code>##   chisq   ratio     rdf       p 
##  958.10    0.66 1446.00    1.00</code></pre>
<hr />
</div>
</div>
<div id="section" class="section level5">
<h5></h5>
<!-- EMT accuracy text -->
<p>Within the analysis of accuracy of the EMT, we examined whether children would be more accurate to detect emotional vs neutral faces. Our final GLMM was comprised of random intercepts for participant and stimulus as well as a random slope for angry in contrast to neutral faces for participant and a random slope for both emotion contrasts for stimulus. We did not find a significant effect for happy in comparison to neutral faces (<span class="math inline">\(\hat{β}\)</span> = 0.41, <em>p</em> = 0.42, <em>OR</em> = 1.51 [95% CI:-0.97, 3.99]) or angry in comparison to neutral faces (<span class="math inline">\(\hat{β}\)</span> = 0.81, <em>p</em> = 0.11, <em>OR</em> = 2.25 [95% CI:-1.45, 5.96]; see <strong>Figure X A</strong>). None of the covariates reached significance (age: <span class="math inline">\(\hat{β}\)</span> = 0.24, <em>p</em> = 0.18, <em>OR</em> = 1.28 [95% CI:-0.82, 3.37]; working memory: <span class="math inline">\(\hat{β}\)</span> = 0.09, <em>p</em> = 0.61, <em>OR</em> = 1.1 [95% CI:-0.71, 2.9]).</p>
<p><br></p>
<!-- Plot EMT accuracy & reaction time -->
<pre class="r"><code> # Select RT inspected criteria
          EMT_Acc_Plot = subset(EMT_All,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
          
        # Select correct trials
          EMT_Acc_Plot = subset(EMT_Acc_Plot, Answer == 1)
        
        # Create factor, define neutral as baseline
          EMT_Acc_Plot$emotion = factor(EMT_Acc_Plot$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))
          
        # Get accuracy for novel and repeated condition 
          acc_all = data.frame(xtabs(~ID+emotion, EMT_Acc_Plot)) 
          
        # Recode to accuracy in percent
          # 24 trials per emotion condition (neutral, happy, angry)
          acc_all$Freq = (acc_all$Freq/24)*100
          
        # Calculate descriptives on accuracy
          stats_acc_all = summarySE(acc_all, measurevar=&quot;Freq&quot;, groupvars=c(&quot;emotion&quot;))
          
        # Plot accuracy
          EMT_Acc_bar = ggplot(stats_acc_all, aes(x=emotion, y=Freq, fill = emotion)) + 
            geom_bar(position=position_dodge(), stat=&quot;identity&quot;,colour=&quot;black&quot;, size=1,width=0.9) +
            geom_errorbar(aes(ymin=Freq-se, ymax=Freq+se), size=1, width=0.2, position=position_dodge(.9)) +
            labs (x= &quot;&quot;, y = &quot;Accuracy [%]&quot;) +
            ylim(0, 80) + 
            scale_fill_manual(values=c(&quot;#276CB3&quot;,&quot;grey20&quot;,&quot;#FF5B4F&quot;))+
            theme_minimal()+
            theme(axis.title.y = element_text(size = 20, margin = margin(t = 0, r = 20, b = 0, l = 0)),
                  text=element_text(size = 20, family = &quot;Segoe UI&quot;),
                  legend.position = &quot;none&quot;)      
      
        # Check whether plot accounts for colorblindness / desaturation
          # view_cvd(fig)

          
# Raincloud plot EMT RT

# Only examine clean data
             EMT_RT_Plot = subset(EMT_All,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)

           # Select correct responses
             EMT_RT_Plot = subset(EMT_RT_Plot, Answer == 1)

           # Create factor, define neutral as baseline
           EMT_RT_Plot$emotion = factor(EMT_RT_Plot$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

           # Set theme
           raincloud_theme = theme(
            text = element_text(size = 10, color = &quot;black&quot;),
            axis.title.x = element_text(size = 16, margin = margin(t = 20, r = 0, b = 0, l = 0)),
             axis.title.y = element_text(size = 16),
             axis.text = element_text(size = 14, color = &quot;black&quot;),
             axis.text.x = element_text(angle = 0, vjust = 0.5),
             legend.title=element_text(size=16),
             legend.text=element_text(size=16),
             legend.position = &quot;right&quot;,
             plot.title = element_text(lineheight=.8, face=&quot;bold&quot;, size = 16),
             panel.border = element_blank(),
             panel.grid.minor = element_blank(),
             panel.grid.major = element_blank(),
             axis.line.x = element_line(colour = &#39;black&#39;, size=0.5, linetype=&#39;solid&#39;),
             axis.line.y = element_line(colour = &#39;black&#39;, size=0.5, linetype=&#39;solid&#39;))

           # Calculate summary
             lb = function(x) mean(x) - sd(x)
             ub = function(x) mean(x) + sd(x)

             sumld = ddply(EMT_RT_Plot , ~ emotion, summarise,
                         mean = mean(RT_in_ms), median = median(RT_in_ms), lower = lb(RT_in_ms), upper = ub(RT_in_ms))

           # Plot rainclouds
            EMT_RT_rain = ggplot(data = EMT_RT_Plot, aes(y = RT_in_ms, x = emotion, fill = emotion))  +
               geom_flat_violin(position = position_nudge(x = .2, y = 0), alpha = 1, color=&quot;black&quot;) +
               ylab(&quot;Reaction time [ms]&quot;)+
               scale_y_continuous(name=&quot;Reaction time [ms]&quot;, breaks=seq(0,6500,1000), limits=c(0,6500))+
               xlab(&quot;&quot;)+
               geom_point(aes(y = RT_in_ms, color = emotion), shape = 19,
                          position = position_jitter(width = .15), size = .7, alpha = 1) +
               geom_point(data = sumld, aes(x = emotion, y = mean), position = position_nudge(x = 0.3), size = 2.5) +
               geom_errorbar(data = sumld, aes(ymin = lower, ymax = upper, y = mean), position = position_nudge(x = 0.3), width = 0) +
               expand_limits(x = 2.00) +
               guides(fill = FALSE) +
               guides(color = FALSE) +
               coord_flip() + # flip or not?
               scale_fill_manual(values=c(&quot;#276CB3&quot;,&quot;grey20&quot;,&quot;#FF5B4F&quot;)) +
               scale_color_manual(values=c(&quot;#276CB3&quot;,&quot;#000000&quot;,&quot;#FF5B4F&quot;))+
               theme_bw() +
               raincloud_theme
            
    # Combine plots
      combine_plots(EMT_Acc_bar, EMT_RT_rain,
                               ncol = 2, nrow=1,
                               labels = c(&quot;A&quot;, &quot;B&quot;),
                               caption.color = &quot;black&quot;,
                               caption.vjust = 0,
                               caption.hjust = 1.3,
                               caption.text = &quot;Figure XX: Accuracy and RT results of EMT task&quot;)   </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_acc_plot-1.png" width="1152" /></p>
<p><br></p>
</div>
<div id="reaction-time" class="section level5">
<h5>3.3.1.2 Reaction time</h5>
<hr />
</div>
<div id="assumption-checks-1" class="section level5 tabset tabset-pills">
<h5>Assumption Checks</h5>
<p><br></p>
<div id="lmm_emt-normality-of-residuals" class="section level6">
<h6>LMM_EMT: Normality of residuals</h6>
<pre class="r"><code># Correct responses
            EMT_RT = subset(EMT_All, Answer == 1)
        
          # RT cleaning criteria
            EMT_RT = subset(EMT_RT,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
        
          # Factor random effects 
            EMT_RT$ID = as.factor(EMT_RT$ID)
            EMT_RT$Stim_Type = as.factor(EMT_RT$Stim_Type)
        
          # Create factor, define neutral as baseline
            EMT_RT$emotion = factor(EMT_RT$emotion, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))
        
          # Set treatment contrast
            contrasts(EMT_RT$emotion) = contr.treatment(3)
            
      # 1) Check properties of DV / residuals 
  
        # Visualize normality assumption of residuals (without log transform)
          mod_RT_lmm_no_log = lm(RT_in_ms ~ emotion, data=EMT_RT)
          res.mod_RT_lmm_no_log = residuals(mod_RT_lmm_no_log)
          
          par(mfrow=c(1,2))
          
          
          qqpl_RT_lmm_no_log = qqPlot(res.mod_RT_lmm_no_log, main=&quot;QQplot before transformation&quot;)    
          norm_RT_lmm_no_log = plot(density(res.mod_RT_lmm_no_log), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-1.png" width="768" /></p>
<pre class="r"><code>          par(mfrow=c(1,1))
          
        # Check which transformation of DV is suitable
        
        # Calculate box-cox plot
          mod_RT_targ = lm(RT_in_ms ~ emotion, data=EMT_RT)
          boxcox(mod_RT_targ)   </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-2.png" width="768" /></p>
<pre class="r"><code>        # In that case: Decision to log transform!
          
        # Visualize normality assumption of residuals (with log transform)
          mod_RT_lmm_log = lm(log(RT_in_ms) ~ emotion, data=EMT_RT)
          res.mod_RT_lmm_log = residuals(mod_RT_lmm_log)
          
          par(mfrow=c(1,2))
          qqpl_RT_lmm_log = qqPlot(res.mod_RT_lmm_log, main=&quot;QQplot after transformation&quot;)    
          norm_RT_lmm_log = plot(density(res.mod_RT_lmm_log), main=&quot;Density plot after transformation&quot;)  </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_res-3.png" width="768" /></p>
<pre class="r"><code>          par(mfrow=c(1,1))            </code></pre>
<hr />
</div>
<div id="lmm_emt-random-effect-structure" class="section level6">
<h6>LMM_EMT: Random effect structure</h6>
<pre class="r"><code>      # 3) Construct full model       
                
        # Add contrast columns
          mm_c =  model.matrix( ~ emotion, EMT_RT) 
        
        # Attach to dataframe
          EMT_RT[,(ncol(EMT_RT)+1):(ncol(EMT_RT)+3)] = mm_c
          names(EMT_RT)[(ncol(EMT_RT)-2):ncol(EMT_RT)] =  c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;) 
        
        # Build model 
          mod_EMT_RT.lmer1 = lmer(log(RT_in_ms) ~ 
                               Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                               (1 + Hap_Neu + Ang_Neu||ID) +
                               (1 + Hap_Neu + Ang_Neu||Stim_Type),
                             data = EMT_RT,
                             control=lmerControl(calc.derivs = FALSE))
        
        # 1st: check how many zero variance terms you got in random effects
          summary(rePCA(mod_EMT_RT.lmer1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                          [,1]     [,2]    [,3]
## Standard deviation     0.0859 0.000226 0.00017
## Proportion of Variance 1.0000 0.000010 0.00000
## Cumulative Proportion  1.0000 1.000000 1.00000
## 
## $ID
## Importance of components:
##                         [,1]  [,2] [,3]
## Standard deviation     0.919 0.267    0
## Proportion of Variance 0.922 0.078    0
## Cumulative Proportion  0.922 1.000    1</code></pre>
<pre class="r"><code>        # 2nd: check which random terms explain the least variance
          print(VarCorr(mod_EMT_RT.lmer1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance     
##  Stim_Type   Ang_Neu     0.00000000586
##  Stim_Type.1 Hap_Neu     0.00000000333
##  Stim_Type.2 (Intercept) 0.00084987218
##  ID          Ang_Neu     0.00822557019
##  ID.1        Hap_Neu     0.00000000000
##  ID.2        (Intercept) 0.09720416779
##  Residual                0.11506785075</code></pre>
<pre class="r"><code>        # Improved model
          mod_EMT_RT.lmer2 = lmer(log(RT_in_ms) ~ 
                                 Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                 (1 + Ang_Neu||ID) +
                                 (0 + Ang_Neu||Stim_Type),
                               data = EMT_RT,
                               control=lmerControl(calc.derivs = FALSE))
        
        
        # Re-check the model
          summary(rePCA(mod_EMT_RT.lmer2))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                        [,1]
## Standard deviation        0
## Proportion of Variance  NaN
## Cumulative Proportion   NaN
## 
## $ID
## Importance of components:
##                         [,1]   [,2]
## Standard deviation     0.916 0.2679
## Proportion of Variance 0.921 0.0787
## Cumulative Proportion  0.921 1.0000</code></pre>
<pre class="r"><code>          print(VarCorr(mod_EMT_RT.lmer2 ),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups    Name        Variance
##  Stim_Type Ang_Neu     0.00000 
##  ID        Ang_Neu     0.00832 
##  ID.1      (Intercept) 0.09733 
##  Residual              0.11587</code></pre>
<pre class="r"><code>        # Likelihood ratio testing
          
          # ID
            mod_EMT_RT.lmer3 = lmer(log(RT_in_ms) ~ 
                                   Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                   (1 |ID) +
                                   (0 + Ang_Neu||Stim_Type),
                                 data = EMT_RT,
                                 control=lmerControl(calc.derivs = FALSE))
  
          # Calculate ANOVA
            anova(mod_EMT_RT.lmer2,mod_EMT_RT.lmer3)</code></pre>
<pre><code>## Data: EMT_RT
## Models:
## mod_EMT_RT.lmer3: log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
## mod_EMT_RT.lmer3:     (1 | ID) + (0 + Ang_Neu || Stim_Type)
## mod_EMT_RT.lmer2: log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
## mod_EMT_RT.lmer2:     (1 + Ang_Neu || ID) + (0 + Ang_Neu || Stim_Type)
##                  Df AIC BIC logLik deviance Chisq Chi Df
## mod_EMT_RT.lmer3  8 800 839   -392      784             
## mod_EMT_RT.lmer2  9 798 843   -390      780  3.24      1
##                  Pr(&gt;Chisq)  
## mod_EMT_RT.lmer3             
## mod_EMT_RT.lmer2      0.072 .
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>          # Stim_Type 
            mod_EMT_RT.lmer4 = lmer(log(RT_in_ms) ~ 
                                      Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                      (1 + Ang_Neu|ID) +
                                      (1|Stim_Type),
                                    data = EMT_RT,
                                    control=lmerControl(calc.derivs = FALSE))
            
          # Calculate ANOVA
            anova(mod_EMT_RT.lmer2,mod_EMT_RT.lmer4)</code></pre>
<pre><code>## Data: EMT_RT
## Models:
## mod_EMT_RT.lmer2: log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
## mod_EMT_RT.lmer2:     (1 + Ang_Neu || ID) + (0 + Ang_Neu || Stim_Type)
## mod_EMT_RT.lmer4: log(RT_in_ms) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
## mod_EMT_RT.lmer4:     (1 + Ang_Neu | ID) + (1 | Stim_Type)
##                  Df AIC BIC logLik deviance Chisq Chi Df
## mod_EMT_RT.lmer2  9 798 843   -390      780             
## mod_EMT_RT.lmer4 10 800 849   -390      780  0.99      1
##                  Pr(&gt;Chisq)
## mod_EMT_RT.lmer2           
## mod_EMT_RT.lmer4       0.32</code></pre>
<pre class="r"><code>        # Final model
          mod_EMT_RT.lmer5 = lmer(log(RT_in_ms) ~ 
                                 Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                 (1 | ID)+
                                 (1 | Stim_Type),
                               data = EMT_RT,
                               control=lmerControl(calc.derivs = FALSE))</code></pre>
<hr />
</div>
<div id="lmm_emt-homoscedasticity" class="section level6">
<h6>LMM_EMT: Homoscedasticity</h6>
<pre class="r"><code># 4) Check homoscedasticity  
          plot(fitted(mod_EMT_RT.lmer5), residuals(mod_EMT_RT.lmer5))
          abline(0, 0)         </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMT_RT_LMM_homosk-1.png" width="768" /></p>
<hr />
</div>
</div>
<div id="section-1" class="section level5">
<h5></h5>
<!-- EMT RT text -->
<p>We built another LMM to test whether children were also faster to detect emotional compared to neutral faces. The final model included participant and stimulus as random intercepts. Children were significantly faster for happy compared to neutral faces (<span class="math inline">\(\hat{β}\)</span> = -0.06, <em>p</em> &lt;0.05), but not for angry compared to neutral faces (<span class="math inline">\(\hat{β}\)</span> = -0.05, <em>p</em> = 0.06; see <strong>Figure X B</strong>). None of the covariates reached significance (age: <span class="math inline">\(\hat{β}\)</span> = -0.09, <em>p</em> = 0.14; working memory: <span class="math inline">\(\hat{β}\)</span> = 0.08, <em>p</em> = 0.18).</p>
<p><br></p>
<pre class="r"><code>labels = c(&quot;Intercept&quot;,&quot;Happy vs Neutral&quot;, &quot;Angry vs Neutral&quot;, &quot;Age&quot;,&quot;Working memory&quot;)

   tab_model(mod_EMT_Acc.glmm8, mod_EMT_RT.lmer5,
                    pred.labels=labels,
                    show.se=TRUE, show.stat=TRUE, show.ci = FALSE, string.se = &quot;SE&quot;,
                    show.re.var=FALSE, show.obs=FALSE,
                    emph.p = TRUE, dv.labels=c(&quot;Accuracy&quot;,&quot;Reaction time&quot;) , show.icc = FALSE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Accuracy
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Reaction time
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.58
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.82
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
7.85
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
125.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Happy vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.81
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.420
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.039</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Angry vs Neutral
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
2.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.50
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.61
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.106
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.87
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.061
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.28
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.184
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.51
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.130
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.50
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.614
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.171
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
59 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.033 / 0.399
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.054 / 0.483
</td>
</tr>
</table>
<p><br></p>
<p><em>Table XX: Results of GLMM and LMM for the analysis of accuracy and reaction time of the emotion matching task (EMT)</em></p>
<p><br></p>
</div>
</div>
<div id="emk-and-connection-to-erps" class="section level4">
<h4>3.3.2 EMK and connection to ERPs</h4>
<pre class="r"><code>    # Load data
      ERPs = readRDS(&quot;data/ERPs.rds&quot;, refhook = NULL)
            
    # Correlation  ERP P1/P3 with EMT 
      
      # Separate data set for neutral and angry and dalculate participant&#39;s P1/P3 mean
      
        # angry
          ERPs_ang = subset(ERPs, Condition == 3)
          ERPs_mean = data.frame(tapply(ERPs_ang$mean_ROI_P1,ERPs_ang$ID, mean))
          names(ERPs_mean)[1] = &quot;P1_ang&quot;
          ERPs_mean$P3_ang = tapply(ERPs_ang$mean_ROI_P3,ERPs_ang$ID, mean)

        # neutral  
          ERPs_neu = subset(ERPs, Condition == 2)
          ERPs_mean$P1_neu = tapply(ERPs_neu$mean_ROI_P1,ERPs_neu$ID, mean)
          ERPs_mean$P3_neu = tapply(ERPs_neu$mean_ROI_P3,ERPs_neu$ID, mean)
  
      # Calculate difference score for angry-neutral
        ERPs_mean$P1_Diff_Ang_Neu = ERPs_mean$P1_ang-ERPs_mean$P1_neu
        ERPs_mean$P3_Diff_Ang_Neu = ERPs_mean$P3_ang-ERPs_mean$P3_neu
        
      # Remove rows of de-selected participants 
        ERPs_mean = ERPs_mean[-c(4),]  
  
      # Integrate questionnare data   
        ERPs_mean$EMK_EK_P = QN_data$EMK_EK_P
        ERPs_mean$EMK_EM_P = QN_data$EMK_EM_P
        ERPs_mean$EMK_EK_Ch = QN_data$EMK_EK_Ch
        ERPs_mean$EMK_EM_Ch = QN_data$EMK_EM_Ch

      # Compute composite scores for parental/children measures of EMK
        ERPs_mean$EMK_EK = ERPs_mean$EMK_EK_P + ERPs_mean$EMK_EK_Ch
        ERPs_mean$EMK_EM = ERPs_mean$EMK_EM_Ch + ERPs_mean$EMK_EM_Ch
        
      # Select variables
        ERPs_corr = subset(ERPs_mean,select = c(P1_Diff_Ang_Neu, P3_Diff_Ang_Neu, EMK_EM,EMK_EK))
  
      # Compute single correlations
        P1_EM = cor.test(ERPs_corr$P1_Diff_Ang_Neu,ERPs_corr$EMK_EM, method = c(&quot;pearson&quot;))
        P3_EM = cor.test(ERPs_corr$P3_Diff_Ang_Neu,ERPs_corr$EMK_EM, method = c(&quot;pearson&quot;))
        P1_EK = cor.test(ERPs_corr$P1_Diff_Ang_Neu,ERPs_corr$EMK_EK, method = c(&quot;pearson&quot;))
        P3_EK = cor.test(ERPs_corr$P3_Diff_Ang_Neu,ERPs_corr$EMK_EK, method = c(&quot;pearson&quot;))
        
      # Correct for multiple comparisons 
        # options: &quot;holm&quot;, &quot;hochberg&quot;, &quot;hommel&quot;, &quot;bonferroni&quot;, &quot;BH&quot;, &quot;BY&quot;, &quot;fdr&quot;, &quot;none&quot;
        #p = c(P1_EM$p.value, P1_EK$p.value, P3_EM$p.value, P3_EK$p.value)
        #p.adjust(p, method = &quot;fdr&quot;, n = length(p))</code></pre>
<p><br></p>
<p>We also investigated the link between ERP amplitudes and emotion- and empathy-related measures. We calculated correlations between the amplitude differences of angry and neutral faces with composite scores parents’ and experimenter’s rating of children’s empathy and emotion knowledge. Empathy scores correlated positively with P1 and P3 amplitude differences (P1-Empathy: <em>r</em>(29) = 0.23, <em>p</em> = 0.22; P3-Empathy: <em>r</em>(29) = 0.11, <em>p</em> = 0.56. Emotion knowledge correlated slightly negatively with P1 and P3 amplitude differences (<em>r</em>(29) = -0.08, <em>p</em> = 0.67; <em>r</em>(29) = -0.16, <em>p</em> = 0.4). However, none of these correlations reached significance (See <strong>Figure X A-D</strong>).</p>
<pre class="r"><code>      # Plot correlation EMK_EM P1 / P3 

        # Empathy and P1 difference  
          EMT_ERP_scat1 = ggplot(ERPs_mean,aes(x = EMK_EM, y = P1_Diff_Ang_Neu))+
            geom_point(shape = 21, size = 2, color =&quot;black&quot;, fill = &quot;#8DB852&quot;)+
            geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
            labs(x = &quot;Compos. Empathy Score&quot;, y = &quot;P1 difference angry vs neutral&quot;)+
            theme_bw()
    
        # Empathy and P3 difference  
          EMT_ERP_scat2 = ggplot(ERPs_mean,aes(x= EMK_EM, y = P3_Diff_Ang_Neu))+
            geom_point(shape = 21, size = 2, color =&quot;black&quot;, fill =&quot;firebrick&quot;)+
            geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
            labs(x = &quot;Compos. Empathy Score&quot;, y = &quot;P3 difference angry vs neutral&quot;)+
            theme_bw()
          
        # EK and P1 difference  
          EMT_ERP_scat3 = ggplot(ERPs_mean,aes(x = EMK_EK, y = P1_Diff_Ang_Neu))+
            geom_point(shape = 21, size = 2, color =&quot;black&quot;, fill = &quot;darkslategray&quot;)+
            geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
            labs(x = &quot;Compos. EK Score&quot;, y = &quot;P1 difference angry vs neutral&quot;)+
            theme_bw()
    
        # EK and P3 difference  
          EMT_ERP_scat4 = ggplot(ERPs_mean,aes(x= EMK_EK, y = P3_Diff_Ang_Neu))+
            geom_point(shape = 21, size = 2, color =&quot;black&quot;, fill =&quot;#3371B8&quot;)+
            geom_smooth(method=lm, color = &quot;black&quot;, size = 1)+
            labs(x = &quot;Compos. EK Score&quot;, y = &quot;P3 difference angry vs neutral&quot;)+
            theme_bw()

          
    # Combine plots
      combine_plots(EMT_ERP_scat1, EMT_ERP_scat2, EMT_ERP_scat3, EMT_ERP_scat4,
                               ncol = 4, nrow=1,
                               labels = c(&quot;A&quot;, &quot;B&quot;,&quot;C&quot;,&quot;D&quot;),
                               caption.color = &quot;black&quot;,
                               caption.vjust = 0,
                               caption.hjust = 0.5,
                               caption.text = &quot;Figure XX: Correlations or ERP Amplitude-Difference with Empathy- and emotion-related measures&quot;)      </code></pre>
<p><img src="R_Script_4_Emotion_empathy_measures_files/figure-html/EMK_ERP_scat_plots-1.png" width="768" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4,h5",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
