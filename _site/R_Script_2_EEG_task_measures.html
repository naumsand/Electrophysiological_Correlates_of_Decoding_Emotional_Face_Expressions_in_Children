<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>EEG task measures</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 51px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h2 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h3 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h4 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h5 {
  padding-top: 56px;
  margin-top: -56px;
}
.section h6 {
  padding-top: 56px;
  margin-top: -56px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Naumann et al.</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="glyphicon glyphicon-info-sign"></span>
     
    Introduction
  </a>
</li>
<li>
  <a href="R_Script_1_Method_Section.html">
    <span class="glyphicon glyphicon-wrench"></span>
     
    Method section
  </a>
</li>
<li>
  <a href="R_Script_2_EEG_task_measures.html">
    <span class="glyphicon glyphicon-hand-up"></span>
     
    EEG task measures
  </a>
</li>
<li>
  <a href="R_Script_3_ERP_measures.html">
    <span class="glyphicon glyphicon-user"></span>
     
    ERP measures
  </a>
</li>
<li>
  <a href="R_Script_4_Emotion_empathy_measures.html">
    <span class="glyphicon glyphicon-link"></span>
     
    Emotion &amp; Empathy measures
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">EEG task measures</h1>

</div>


<!-- Set up workspace -->
<!-- Load and prepare data sets -->
<pre class="r"><code># Load and prepare datasets -----------------------------------------------

 # Load Questionnaire data -----------------------------------------------

    # Load data based on script: R_Script_1_Method_Section
      QN_data = readRDS(&quot;./data/QN_data.rds&quot;, refhook = NULL)
    
 # Concatenate EEG task data ------------------------------------

  # Get stimulus information 
    Stim_data = readWorksheetFromFile(&quot;./data/Stim_Descr.xlsx&quot;, 
                                      sheet = 1, 
                                      startCol = 1,
                                      endCol = 0) # 0 takes into account all columns starting from startCol 
    
  # List files of Accuracy/RT within a folder and get number of participants
    files_RT = list.files(path = &quot;./data/EEG_task_data&quot;, pattern=&quot;*.txt&quot;)
    nfiles = length(files_RT)
    
  # Combine single trials of participants into data frame 
    for (i in 1:nfiles) {  
      
      # Get RT file per subject  
       Indiv_RT = read.delim(file=paste(&quot;./data/EEG_task_data/&quot;,files_RT[i], sep = &quot;&quot;), header = TRUE, sep = &quot;\t&quot;, dec = &quot;.&quot;)
      
      # Add ID 
       Indiv_RT$ID = substr(files_RT [i],1,2)
      
      if (i==1) {
        EEG_behav_data = Indiv_RT # first round: create EEG_behav_data data frame
      } else {
        EEG_behav_data = rbind(EEG_behav_data,Indiv_RT) # add to EEG_behav_data data frame 
      }
      
      remove(Indiv_RT) # Clear previous participant
    }
    
    
  # Add Congruency (novel vs repeated) 
    
    # (p=prime, c=congruent [will be recoded into repeated], ic=incongruent [will be recoded into novel])
    # 1 - p_happy; 2 - p_neutral; 3 - p_angry
    # 4 - c_happy / repeated happy ; 5 - c_neutral / repeated neutral; 6 - c_angry / repeated angry
    # 7 - ic_happy / novel happy; 8 - ic_neutral / novel neutral; 9 - ic_angry / novel angry
    
    # 1 for repeated, 2 for novel 
      EEG_behav_data$Cong[EEG_behav_data$Emo_Target == 4 |EEG_behav_data$Emo_Target == 5 |EEG_behav_data$Emo_Target == 6] = 1
      EEG_behav_data$Cong[EEG_behav_data$Emo_Target == 7 |EEG_behav_data$Emo_Target == 8 |EEG_behav_data$Emo_Target == 9] = 2
      
    # Get columns of interest (and bring them in order)
      EEG_behav_data = EEG_behav_data [c(&quot;ID&quot;, &quot;Trial&quot;, &quot;Block&quot;,&quot;Response&quot;,&quot;RTs&quot;,&quot;Cong&quot;,&quot;Emo_Prime&quot;,&quot;Emo_Target&quot;)]
      names(EEG_behav_data)[names(EEG_behav_data) == &quot;Emo_Prime&quot;] = &quot;Prime&quot;
      names(EEG_behav_data)[names(EEG_behav_data) == &quot;Emo_Target&quot;] = &quot;Target&quot;
      
      
  # Change block numeration for all participants
      
    # Participant 1 and 2 have wrong coding for block numbers (show &quot;1&quot; for all 144 trials)
      xtabs(~ID+Block,EEG_behav_data)
      
    # Create blocks
      block_count = rep(1:3, times=32, each=48)
      EEG_behav_data$Block = block_count 
      
    # Re-check - OK
      xtabs(~ID+Block,EEG_behav_data)
      
    # Add trial numbers to match with EEG data        
      trial_eeg_count = rep(1:144, times=32)
      EEG_behav_data$Trial_EEG = trial_eeg_count
      
    # Check trials for EEG - OK 
      xtabs(~ID+Trial_EEG,EEG_behav_data)
      
    # Check trials - OK
      data.frame(xtabs(~ID+Trial,EEG_behav_data))
      
     # Check congruency - one trial more for novel condition compared to repeated condition 
      xtabs(~ID+Cong,EEG_behav_data)
      
    # Check prime (48 happy, 49 neutral, 47 angry)
      xtabs(~ID+Prime,EEG_behav_data)
      
    # Check target (all 24, except for c_angry: 23 and ic_angry: 25)
      xtabs(~ID+Target,EEG_behav_data)     

      
  # Add age and working memory score 
      
      # Change QN_data ID format to ID format of EEG_behav_data
        IDs = c(paste(&quot;0&quot;,c(1,2,4,6:9), sep=&quot;&quot;), paste(c(10:33), sep=&quot;&quot;))  
        QN_data$ID = IDs  
        
        EEG_behav_data$Age = QN_data$age[match(EEG_behav_data$ID,QN_data$ID,nomatch = NA)]
        EEG_behav_data$WM = QN_data$WM[match(EEG_behav_data$ID,QN_data$ID,nomatch = NA)]

        
  # Add randomization / stimulus info
      
      # Match with randomization
        EEG_behav_data$EEG_Random = QN_data$random_EEG[match(EEG_behav_data$ID,QN_data$ID,nomatch = NA)]
        
      # Subset for randomization 1 and 2
        EEG_behav_data_R1 = subset(EEG_behav_data, EEG_Random == &quot;R1&quot;)
        EEG_behav_data_R2 = subset(EEG_behav_data, EEG_Random == &quot;R2&quot;)
        
      # Subset for the randomizations
        Stim_Data_R1 = subset(Stim_data, Randomization == &quot;R1&quot;)
        Stim_Data_R2 = subset(Stim_data, Randomization == &quot;R2&quot;)
        
      # Option &quot;times&quot; refers to number of participants for each randomization
        stimuli_R1 = rep(Stim_Data_R1$Identity, times=16, each=1)
        stimuli_R2 = rep(Stim_Data_R2$Identity, times=15, each=1)
        
        EEG_behav_data_R1$Stim_Type = stimuli_R1
        EEG_behav_data_R2$Stim_Type = stimuli_R2
      
      # Bind R1 and R2 together to one column and add it to all subjects data
        EEG_behav_data = rbind(EEG_behav_data_R1,EEG_behav_data_R2)
        
      # Check randomization - OK
        xtabs(~ID+EEG_Random,EEG_behav_data)
        
      # Check stim_type - Slightly unbalanced: R2 have m10 three times, but f10 only one time
        xtabs(~ID+Stim_Type,EEG_behav_data)
        
        
  # Switch error and accuracy rate of participant 02 &amp; 04
        # Two children (02,04) mixed up the button order (&lt; 25 % accuracy).
        # We switched their error and accuracy rate. 
        # Every 0 is going to become 1 and every 1 is going to become a 0.
        
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;02&#39; &amp; EEG_behav_data$Response == 1] = 2
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;02&#39; &amp; EEG_behav_data$Response == 0] = 1
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;02&#39; &amp; EEG_behav_data$Response == 2] = 0
 
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;04&#39; &amp; EEG_behav_data$Response == 1] = 2
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;04&#39; &amp; EEG_behav_data$Response == 0] = 1
        EEG_behav_data$Response[EEG_behav_data$ID == &#39;04&#39; &amp; EEG_behav_data$Response == 2] = 0
    
 # Data inspection &amp; cleaning ----------------------------------------------
  
  # Create variables which capture RT outliers (TRUE = outlier, FALSE = kept for further analyses)
      EEG_behav_data$Exclude_smaller_250ms = FALSE
      EEG_behav_data$Exclude_larger_7s = FALSE
      EEG_behav_data$Exclude_MAD = FALSE
        
  # Clean RTs for values &lt; 250 ms
      EEG_behav_data$Exclude_smaller_250ms[EEG_behav_data$RTs &lt;=250] = TRUE
        
  # Clean RTs for values &lt; 10 s
      EEG_behav_data$Exclude_larger_7s[EEG_behav_data$RTs &gt;=7000] = TRUE
    
  # Calculate the median absolute deviation for each participant       
    
    # Define IDs
     IDs = c(paste(&quot;0&quot;,c(2,4,6:9), sep=&quot;&quot;), paste(c(10:33), sep=&quot;&quot;))
    
      MAD_cutoff = 2.5
      
      for (m in 1:length(IDs)) {
        
        EEG_behav_data_outl_ind = subset (EEG_behav_data[EEG_behav_data$Exclude_smaller_250ms==FALSE|EEG_behav_data$Exclude_larger_7s==FALSE,], ID == IDs[m]) 
        
        # Identify outliers +/- 2.5 times the MAD 
        
        MAD_ind = mad(EEG_behav_data_outl_ind$RTs)
        
        EEG_behav_data[EEG_behav_data$ID==IDs[m],]$Exclude_MAD[EEG_behav_data_outl_ind$RTs &lt; MAD_ind-MAD_cutoff*MAD_ind | EEG_behav_data_outl_ind$RTs &gt; MAD_ind+MAD_cutoff*MAD_ind] = TRUE
        
      }
      
# De-select excluded participant
    EEG_behav_data = EEG_behav_data[with(EEG_behav_data, !(EEG_behav_data$ID==&quot;05&quot;)), ] </code></pre>
<div id="eeg-task-measures" class="section level3">
<h3>3.1 EEG task measures</h3>
<p><br></p>
<div id="accuracy" class="section level4">
<h4>3.1.1 Accuracy</h4>
<hr />
<div id="assumption-checks" class="section level5 tabset tabset-pills">
<h5>Assumption checks</h5>
<div id="glmm-1-random-effect-structure" class="section level6">
<h6>GLMM 1: Random effect structure</h6>
<pre class="r"><code> # Select outlier-free data
          EEG_behav_Acc_glmm = subset(EEG_behav_data,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)

        # Factor random effects
          EEG_behav_Acc_glmm$ID = as.factor(EEG_behav_Acc_glmm$ID)
          EEG_behav_Acc_glmm$Stim_Type = as.factor(EEG_behav_Acc_glmm$Stim_Type)

        # Factor fixed factor congruency
          EEG_behav_Acc_glmm$Cong[EEG_behav_Acc_glmm$Cong==1] = &quot;repeated&quot;
          EEG_behav_Acc_glmm$Cong[EEG_behav_Acc_glmm$Cong==2] = &quot;novel&quot;
          EEG_behav_Acc_glmm$Cong = factor(EEG_behav_Acc_glmm$Cong)

        # Set effect coding contrast
          contrasts(EEG_behav_Acc_glmm$Cong) = contr.sum(2)/2

      # 1) Construct full model

        # Create contrast matrix
          mm_c =  model.matrix( ~ Cong, EEG_behav_Acc_glmm)

        # Attach to dataframe
          EEG_behav_Acc_glmm = EEG_behav_Acc_glmm
          EEG_behav_Acc_glmm[,(ncol(EEG_behav_Acc_glmm)+1):(ncol(EEG_behav_Acc_glmm)+2)] = mm_c
          names(EEG_behav_Acc_glmm)[(ncol(EEG_behav_Acc_glmm)-1):ncol(EEG_behav_Acc_glmm)] = c(&quot;Grand Mean&quot;, &quot;Repeated_Novel&quot;)

        # Build full model
          mod_Acc_EEG.glmm1 = glmer(Response ~ Repeated_Novel + scale(Age) + scale(WM) +
                                (1 + Repeated_Novel||ID) +
                                (1 + Repeated_Novel||Stim_Type),
                              data = EEG_behav_Acc_glmm,control=glmerControl(calc.derivs = FALSE),
                              family = binomial)


# 2) Check random effect structure
        # PCA to check random effect structure (whether all random terms explain variance)
        # if you do not take them out: over-parametrization of model (+ to control for type 1 error)
        # cut-off: 0.005 - 0.001 (everything below does not explain enough variance )

        # 1st: check how many zero variance terms you got in random effects
          summary(rePCA(mod_Acc_EEG.glmm1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.300 0.123
## Proportion of Variance 0.856 0.144
## Cumulative Proportion  0.856 1.000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     1.647 1.090
## Proportion of Variance 0.695 0.305
## Cumulative Proportion  0.695 1.000</code></pre>
<pre class="r"><code>        # 2nd: check which random terms explain the least variance
          print(VarCorr(mod_Acc_EEG.glmm1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name           Variance
##  Stim_Type   Repeated_Novel 0.0901  
##  Stim_Type.1 (Intercept)    0.0152  
##  ID          Repeated_Novel 2.7117  
##  ID.1        (Intercept)    1.1880</code></pre>
<pre class="r"><code>        # 3rd: Likelihood-ratio-testing
          mod_Acc_EEG.glmm2 = glmer(Response ~ Repeated_Novel + scale(Age) + scale(WM) +
                                  (1 | ID) +
                                  (1 + Repeated_Novel||Stim_Type),
                                data = EEG_behav_Acc_glmm,control=glmerControl(calc.derivs = FALSE),
                                family = binomial)

          mod_Acc_EEG.glmm3 = glmer(Response ~ Repeated_Novel + scale(Age) + scale(WM) +
                                  (1 + Repeated_Novel||ID)  +
                                  (1 |Stim_Type),
                                data = EEG_behav_Acc_glmm,control=glmerControl(calc.derivs = FALSE),
                                family = binomial)

        # Calculate ANOVAs
          anov_glmm1_glmm2 = anova(mod_Acc_EEG.glmm1,mod_Acc_EEG.glmm2)
          anov_glmm1_glmm3 = anova(mod_Acc_EEG.glmm1,mod_Acc_EEG.glmm3)


 # Final model
          mod_Acc_EEG.glmm4 = glmer(Response ~ Repeated_Novel + scale(Age) + scale(WM) +
                                      (1 + Repeated_Novel||ID) +
                                      (1 |Stim_Type),
                                    data = EEG_behav_Acc_glmm,control=glmerControl(calc.derivs = FALSE),
                                    family = binomial)</code></pre>
<hr />
</div>
<div id="glmm-1-overdispersion" class="section level6">
<h6>GLMM 1: Overdispersion</h6>
<pre class="r"><code>    # 3) Assumption check: Appropriate estimation of variance (no overdispersion)

          overdisp_fun(mod_Acc_EEG.glmm4)</code></pre>
<pre><code>##   chisq   ratio     rdf       p 
## 2725.06    0.87 3139.00    1.00</code></pre>
<p>If the p-value is &lt; 0.05, the data are overdispersed. Here p &gt; 0.05. Hence overdispersion is not a problem.</p>
<hr />
</div>
<div id="glmm-2-random-effect-structure" class="section level6">
<h6>GLMM 2: Random effect structure</h6>
<pre class="r"><code>      # Build model &amp; check assumptions -----------------------------------------

      # Get outlier-free data
        EEG_behav_Acc_targ_glmm = subset(EEG_behav_data, Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)

      # Rename variables
        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==4] = &quot;hap&quot;
        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==5] = &quot;neu&quot;
        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==6] = &quot;ang&quot;

        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==7] = &quot;hap&quot;
        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==8] = &quot;neu&quot;
        EEG_behav_Acc_targ_glmm$Target[EEG_behav_Acc_targ_glmm$Target==9] = &quot;ang&quot;

      # Create factor, get neutral as baseline
        EEG_behav_Acc_targ_glmm$Target = factor(EEG_behav_Acc_targ_glmm$Target, levels=c(&quot;neu&quot;,&quot;hap&quot;,&quot;ang&quot;))
        EEG_behav_Acc_targ_glmm$ID = as.factor(EEG_behav_Acc_targ_glmm$ID)
        EEG_behav_Acc_targ_glmm$Stim_Type = as.factor(EEG_behav_Acc_targ_glmm$Stim_Type)

      # Set treatment contrast
        contrasts(EEG_behav_Acc_targ_glmm$Target) = contr.treatment(3)

    # 1) Construct full model

      # Add contrast columns
        mm_c =  model.matrix( ~ Target, EEG_behav_Acc_targ_glmm)

      # Attach to dataframe
        EEG_behav_Acc_targ_glmm[,(ncol(EEG_behav_Acc_targ_glmm)+1):(ncol(EEG_behav_Acc_targ_glmm)+3)] = mm_c
        names(EEG_behav_Acc_targ_glmm)[(ncol(EEG_behav_Acc_targ_glmm)-2):ncol(EEG_behav_Acc_targ_glmm)] = c(&quot;Mean&quot;,&quot;Neu_Hap&quot;, &quot;Neu_Ang&quot;)

      # Build full model
        mod_Acc_targ.glmm1 = glmer(Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM)
                              + (1 + Neu_Hap + Neu_Ang||ID)
                              + (1 + Neu_Hap + Neu_Ang||Stim_Type),
                              data = EEG_behav_Acc_targ_glmm,
                              control=glmerControl(calc.derivs = FALSE),
                              family = binomial)

    # 2) Check random effect structure

      # PCA to check random effect structure (whether all random terms explain variance)
      # if you do not take them out: over-parametrization of model (+ to control for type 1 error)
      # cut-off: 0.005 - 0.001 (everything below does not explain enough variance )

      # 1st: check how many zero variance terms you got in random effects
        summary(rePCA(mod_Acc_targ.glmm1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]  [,2]    [,3]
## Standard deviation     0.354 0.334 0.00114
## Proportion of Variance 0.530 0.470 0.00001
## Cumulative Proportion  0.530 1.000 1.00000
## 
## $ID
## Importance of components:
##                         [,1]   [,2]     [,3]
## Standard deviation     1.057 0.1395 0.000656
## Proportion of Variance 0.983 0.0171 0.000000
## Cumulative Proportion  0.983 1.0000 1.000000</code></pre>
<pre class="r"><code>      # 2nd: check which random terms explain the least variance
        print(VarCorr(mod_Acc_targ.glmm1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance  
##  Stim_Type   Neu_Ang     0.11129620
##  Stim_Type.1 Neu_Hap     0.12546092
##  Stim_Type.2 (Intercept) 0.00000130
##  ID          Neu_Ang     0.01945516
##  ID.1        Neu_Hap     0.00000043
##  ID.2        (Intercept) 1.11740863</code></pre>
<pre class="r"><code>      # Re-build model
        mod_Acc_targ.glmm2 = glmer(Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM)
                            + (1 + Neu_Ang||ID)
                            + (0 + Neu_Hap + Neu_Ang||Stim_Type),
                            data = EEG_behav_Acc_targ_glmm,
                            control=glmerControl(calc.derivs = FALSE),
                            family = binomial)

      # Re-check random structure
        summary(rePCA(mod_Acc_targ.glmm2))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.354 0.334
## Proportion of Variance 0.530 0.470
## Cumulative Proportion  0.530 1.000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     1.057 0.139
## Proportion of Variance 0.983 0.017
## Cumulative Proportion  0.983 1.000</code></pre>
<pre class="r"><code>        print(VarCorr(mod_Acc_targ.glmm2),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance
##  Stim_Type   Neu_Ang     0.1113  
##  Stim_Type.1 Neu_Hap     0.1254  
##  ID          Neu_Ang     0.0194  
##  ID.1        (Intercept) 1.1170</code></pre>
<pre class="r"><code>    # 3) Likelihood-ratio testing

        mod_Acc_targ.glmm3 = glmer(Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM)
                            + (1 |ID)
                            + (0 + Neu_Hap + Neu_Ang||Stim_Type),
                            data = EEG_behav_Acc_targ_glmm,
                            control=glmerControl(calc.derivs = FALSE),
                            family = binomial)

        mod_Acc_targ.glmm4 = glmer(Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM)
                            + (1 + Neu_Ang||ID)
                            + (1|Stim_Type),
                            data = EEG_behav_Acc_targ_glmm,
                            control=glmerControl(calc.derivs = FALSE),
                            family = binomial)

      # Calculate ANOVAs
        anov_glmm2_glmm3 = anova(mod_Acc_targ.glmm2,mod_Acc_targ.glmm3)
        anov_glmm2_glmm4 = anova(mod_Acc_targ.glmm2,mod_Acc_targ.glmm4)

      # Final model
        mod_Acc_targ.glmm5 = glmer(Response ~ Neu_Hap + Neu_Ang + scale(Age) + scale(WM)
                              + (1 |ID)
                              + (0 + Neu_Hap + Neu_Ang||Stim_Type),
                              data = EEG_behav_Acc_targ_glmm,
                              control=glmerControl(calc.derivs = FALSE),
                              family = binomial)</code></pre>
<hr />
</div>
<div id="glmm-2-overdispersion" class="section level6">
<h6>GLMM 2: Overdispersion</h6>
<pre class="r"><code>      # 3) Assumption check: Appropriate estimation of variance (no overdispersion)
          overdisp_fun(mod_Acc_targ.glmm5)</code></pre>
<pre><code>##  chisq  ratio    rdf      p 
## 2813.2    0.9 3138.0    1.0</code></pre>
<p>If the p-value is &lt; 0.05, the data are overdispersed. Here p &gt; 0.05. Hence overdispersion is not a problem.</p>
<hr />
</div>
</div>
<div id="section" class="section level5">
<h5></h5>
<!-- Accuracy result text -->
<p>We evaluated whether children were more accurate in detecting an emotion they had seen emotion before (See <strong>Figure X A</strong>). We constructed a GLMM with novelty as fixed effect factor and chronological age and working memory as covariates. The model with the best fit included an intercept for participant with a random slope for novelty and a random intercept for stimulus. Model results indicated that participants were equally accurate in trials with repeated in comparison to a novel emotion at “face 2” (<span class="math inline">\(\hat{β}\)</span> = &lt;0.001 , <em>p</em> = 1.00, <em>OR</em> = 1.00 [95% CI: -0.64, 2.64]).</p>
<pre class="r"><code>      # Select outlier-free data and correct trials
        EEG_behav_Acc_plot = subset(EEG_behav_data,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)
        EEG_behav_Acc_plot = subset(EEG_behav_Acc_plot,Response == 1)

      # Recode variable
        EEG_behav_Acc_plot$Cong[EEG_behav_Acc_plot$Cong==1] = &quot;repeated&quot;
        EEG_behav_Acc_plot$Cong[EEG_behav_Acc_plot$Cong==2] = &quot;novel&quot;

      # Get accuracy for novel and repeated condition
        acc_all = data.frame(xtabs(~ID+Cong, EEG_behav_Acc_plot))

      # Recode to accuracy in percent
        # 72 novel trials, 72 repeated trials
        acc_all$Freq = (acc_all$Freq/72)*100

      # Factor condition
        acc_all$Cong = as.factor(acc_all$Cong)

      # Calculate descriptives on accuracy
        stats_acc_all = summarySE(acc_all, measurevar=&quot;Freq&quot;, groupvars=c(&quot;Cong&quot;))

      # Plot accuracy
        EEG_acc_plot=ggplot(stats_acc_all, aes(x=Cong, y=Freq, fill = Cong)) +
          geom_bar(position=position_dodge(), stat=&quot;identity&quot;,colour=&quot;black&quot;, size=1,width=0.9) +
          geom_errorbar(aes(ymin=Freq-se, ymax=Freq+se), size=1, width=0.2, position=position_dodge(.9)) +
          labs (x= &quot;&quot;, y = &quot;Accuracy [%]&quot;) +
          ylim(0, 80) +
          scale_fill_manual(values=c(&quot;gray32&quot;,&quot;#6AC2FF&quot;))+
          theme_minimal()+
          theme(axis.title.y = element_text(size = 20, margin = margin(t = 0, r = 20, b = 0, l = 0)),
                text=element_text(size = 20, family = &quot;Segoe UI&quot;),
                legend.position = &quot;none&quot;)


# Plot separated by emotions

 # Select outlier-free data and correct trials
        EEG_behav_Acc_targ_plot = subset(EEG_behav_data, Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)
        EEG_behav_Acc_targ_plot = subset(EEG_behav_Acc_targ_plot,Response == 1)

      # Recode variable
        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==4] = &quot;happy&quot;
        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==5] = &quot;neutral&quot;
        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==6] = &quot;angry&quot;

        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==7] = &quot;happy&quot;
        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==8] = &quot;neutral&quot;
        EEG_behav_Acc_targ_plot$Target[EEG_behav_Acc_targ_plot$Target==9] = &quot;angry&quot;

        EEG_behav_Acc_targ_plot$Target = factor(EEG_behav_Acc_targ_plot$Target, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))

      # Get accuracy for novel and repeated condition
        acc_emo = data.frame(xtabs(~ID+Target, EEG_behav_Acc_targ_plot))

      # Recode to accuracy in percent
        # 48 happy trials, 49 neutral trials, 47 angry trials
        acc_emo$Freq[acc_emo$Target== &quot;happy&quot;] = (acc_emo$Freq[acc_emo$Target== &quot;happy&quot;]/48)*100
        acc_emo$Freq[acc_emo$Target== &quot;neutral&quot;] = (acc_emo$Freq[acc_emo$Target== &quot;neutral&quot;]/49)*100
        acc_emo$Freq[acc_emo$Target== &quot;angry&quot;] = (acc_emo$Freq[acc_emo$Target== &quot;angry&quot;]/47)*100

      # Factor condition
        acc_emo$Target = as.factor(acc_emo$Target)

      # Calculate descriptives on accuracy
        stats_acc_emo = summarySE(acc_emo, measurevar=&quot;Freq&quot;, groupvars=c(&quot;Target&quot;))

      # Plot accuracy
        EEG_acc_emo_plot=ggplot(stats_acc_emo, aes(x=Target, y=Freq, fill = Target)) +
            geom_bar(position=position_dodge(), stat=&quot;identity&quot;,colour=&quot;black&quot;, size=1,width=0.9) +
            geom_errorbar(aes(ymin=Freq-se, ymax=Freq+se), size=1, width=0.2, position=position_dodge(.9)) +
            labs (x= &quot;&quot;, y = &quot;Accuracy [%]&quot;) +
            ylim(0, 65) +
            scale_fill_manual(values= c(&quot;#276CB3&quot;,&quot;gray20&quot;,&quot;#FF5B4F&quot;))+
            theme_minimal()+
            theme(axis.title.y = element_text(size = 20, margin = margin(t = 0, r = 20, b = 0, l = 0)),
                  text=element_text(size = 20, family = &quot;Segoe UI&quot;),
                  legend.position = &quot;none&quot;)


# Combine plots
      combine_plots(EEG_acc_plot, EEG_acc_emo_plot,
                               ncol = 2, nrow=1,
                               labels = c(&quot;A&quot;, &quot;B&quot;),
                               caption.color = &quot;black&quot;,
                               caption.vjust = 0,
                               caption.hjust = 1.3,
                               caption.text = &quot;Figure XX: Accuracy of EEG task &quot;)</code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_Acc_plots-1.png" width="768" /></p>
<p><br></p>
<p>We built an additional GLMM separated by emotions of “face 2” to identify potential matching differences elicited by emotion. We averaged across trials with repeated and novel emotions for “face 2”. As a fixed factor, we used emotion (happy vs neutral and angry vs neutral).The final model was comprised of a random intercept for participant and a random slope for emotion, with no random intercept for stimulus. Descriptively, participants showed the highest accuracy when happy faces were presented as “face 2” (See <strong>Figure X B</strong>). This difference, however, is not significant in comparison to neutral faces (<span class="math inline">\(\hat{β}\)</span> = 0.16 , <em>p</em> = 0.17, <em>OR</em> = 1.17 [95% CI: -0.76, 1.17]; see <strong>Table X</strong>). Similarly, there was no significant difference between angry and neutral faces presented as “face 2” (<span class="math inline">\(\hat{β}\)</span> = 0.03 , <em>p</em> = 0.82, <em>OR</em> = 1.03 [95% CI: -0.66, 1.03).</p>
<p><br></p>
<pre class="r"><code>       # Create labels
          labels = c(&quot;Intercept&quot;,&quot;Novel vs Repeated&quot;,&quot;Age&quot;,&quot;Working memory&quot;, &quot;Neutral vs Happy&quot;, &quot;Neutral vs Angry&quot;)

       # Create table
          tab_model(mod_Acc_EEG.glmm4, mod_Acc_targ.glmm5,
                    pred.labels=labels, show.ci = FALSE,
                    show.se=TRUE, show.stat=TRUE, string.se = &quot;SE&quot;,
                    show.re.var=FALSE, show.obs=FALSE,
                    emph.p = TRUE, dv.labels=c(&quot;Accuracy&quot;,&quot;&quot;) , show.icc = FALSE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Accuracy
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Odds Ratios
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
4.37
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
6.88
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
3.80
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
6.18
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.33
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.00
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.000
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.913
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.98
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.925
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.79
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.22
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-1.10
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.271
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.78
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.21
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-1.16
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.246
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.17
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.12
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.168
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.11
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
0.23
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.815
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.015 / 0.186
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.015 / 0.270
</td>
</tr>
</table>
<p><br></p>
<p><em>Table XX: Results of GLMMs for accuracy of the EEG task</em></p>
<p><br></p>
<p><br></p>
</div>
</div>
<div id="reaction-time" class="section level4">
<h4>3.1.2 Reaction time</h4>
<hr />
<div id="assumption-checks-1" class="section level5 tabset tabset-pills">
<h5>Assumption checks</h5>
<div id="lmm1-normality-of-residuals" class="section level6">
<h6>LMM1: Normality of residuals</h6>
<pre class="r"><code>    # LMM X: Novel trials &gt; Repeated trials ------------------------------------------------------
      # Build model &amp; check assumptions -------------------------------------------------------
    
        # Choose outlier-free data and correct answers    
         EEG_behav_RT_lmm = subset(EEG_behav_data,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
         EEG_behav_RT_lmm = subset(EEG_behav_RT_lmm, Response == 1)
         
        # Recode for repeated and novel trials
         EEG_behav_RT_lmm$Cong[EEG_behav_RT_lmm$Cong==1] = &quot;repeated&quot;
         EEG_behav_RT_lmm$Cong[EEG_behav_RT_lmm$Cong==2] = &quot;novel&quot;
         
        # Prepare fixed factors 
          EEG_behav_RT_lmm$Cong = factor(EEG_behav_RT_lmm$Cong)
      
        # Factor ID and stimulus type 
          EEG_behav_RT_lmm$Stim_Type = factor(EEG_behav_RT_lmm$Stim_Type)
          EEG_behav_RT_lmm$ID = factor(EEG_behav_RT_lmm$ID)
    
        # Define effect coding contrast for novelty 
          contrasts(EEG_behav_RT_lmm$Cong) = contr.sum(2)/2
          # interpretation: intercept = grand average across both conditions, slope = correct-incorrect
    
      # 1) Check properties of DV / residuals 
  
        # Visualize normality assumption of residuals (without log transform)
          mod_RT_lmm_no_log = lm(RTs ~ Cong, data=EEG_behav_RT_lmm)
          res.mod_RT_lmm_no_log = residuals(mod_RT_lmm_no_log)
          
          par(mfrow=c(1,2))
          qqpl_RT_lmm_no_log = qqPlot(res.mod_RT_lmm_no_log, main=&quot;QQplot before transformation&quot;)    
          norm_RT_lmm_no_log = plot(density(res.mod_RT_lmm_no_log), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_res-1.png" width="768" /></p>
<pre class="r"><code>          par(mfrow=c(1,1))
          
        # Check which transformation of DV is suitable
        
        # Calculate box-cox plot
          mod_RT_targ = lm(RTs ~ Cong, data=EEG_behav_RT_lmm)
          boxcox(mod_RT_targ)   </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_res-2.png" width="768" /></p>
<pre class="r"><code>        # In that case: Decision to log transform!
          
        # Visualize normality assumption of residuals (with log transform)
          mod_RT_lmm_log = lm(log(RTs) ~ Cong, data=EEG_behav_RT_lmm)
          res.mod_RT_lmm_log = residuals(mod_RT_lmm_log)
          
          par(mfrow=c(1,2))
          qqpl_RT_lmm_log = qqPlot(res.mod_RT_lmm_log, main=&quot;QQplot after transformation&quot;)    
          norm_RT_lmm_log = plot(density(res.mod_RT_lmm_log), main=&quot;Density plot after transformation&quot;)  </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_res-3.png" width="768" /></p>
<pre class="r"><code>          par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm1-random-effect-structure" class="section level6">
<h6>LMM1: Random effect structure</h6>
<pre class="r"><code>    # 3) Construct full model 

      # First: add covariate structure
        # Add contrast as numerical covariate via model matrix in order to enter contrasts individually in model 
        # Use || to not calculate correlations between slopes / intercepts (not important to generalise) 
    
      # Create contrast matrix 
        mm_c =  model.matrix( ~ Cong, EEG_behav_RT_lmm) 
    
      # Attach to dataframe
        EEG_behav_RT_lmm[,(ncol(EEG_behav_RT_lmm)+1):(ncol(EEG_behav_RT_lmm)+2)] = mm_c
        names(EEG_behav_RT_lmm)[(ncol(EEG_behav_RT_lmm)-1):ncol(EEG_behav_RT_lmm)] = c(&quot;Grand Mean&quot;, &quot;Repeated_Novel&quot;)            
    
    
      # Build full model with new names                
        mod_RT_EEG.lmer1 = lmer(log(RTs) ~ Repeated_Novel + scale(Age) + scale(WM) + 
                                  (1 + Repeated_Novel ||ID) + 
                                  (1 + Repeated_Novel ||Stim_Type),                   
                                data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
      # PCA to check random effect structure (whether all random terms explain variance)
        # If you do not remove them: over-parametrization of model (+ to control for type 1 error)
        # Cut-off: 0.005 - 0.001 (everything below threshold does not explain enough variance )
      
      # 1st: check how many zero variance terms you got in random effects
        summary(rePCA(mod_RT_EEG.lmer1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]     [,2]
## Standard deviation     0.106 0.000193
## Proportion of Variance 1.000 0.000000
## Cumulative Proportion  1.000 1.000000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.552 0.194
## Proportion of Variance 0.890 0.110
## Cumulative Proportion  0.890 1.000</code></pre>
<pre class="r"><code>      # 2nd: check which random terms explain the least variance
        print(VarCorr(mod_RT_EEG.lmer1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name           Variance    
##  Stim_Type   Repeated_Novel 0.0000000135
##  Stim_Type.1 (Intercept)    0.0040530156
##  ID          Repeated_Novel 0.0136555446
##  ID.1        (Intercept)    0.1106881645
##  Residual                   0.3628280265</code></pre>
<pre class="r"><code>      # 3rd: remove all terms with zero variance --&gt; comprises final model 
        mod_RT_EEG.lmer2 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                (1 + Repeated_Novel||ID) + 
                                (1 + Repeated_Novel||Stim_Type),                   
                              data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
      # 4th: re-check the model PCA / variance of random factors
        summary(rePCA(mod_RT_EEG.lmer2))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]     [,2]
## Standard deviation     0.106 0.000193
## Proportion of Variance 1.000 0.000000
## Cumulative Proportion  1.000 1.000000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.552 0.194
## Proportion of Variance 0.890 0.110
## Cumulative Proportion  0.890 1.000</code></pre>
<pre class="r"><code>        print(VarCorr(mod_RT_EEG.lmer2),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name           Variance    
##  Stim_Type   Repeated_Novel 0.0000000135
##  Stim_Type.1 (Intercept)    0.0040530156
##  ID          Repeated_Novel 0.0136555446
##  ID.1        (Intercept)    0.1106881645
##  Residual                   0.3628280265</code></pre>
<pre class="r"><code>      # 5th: Do Likelihood Ratio Test (LRT) - to check whether all random slopes improve the model
        
        # LRT without random slope Repeated_Novel for ID
          mod_RT_EEG.lmer2 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                    (1 + Repeated_Novel||ID) + 
                                    (1 + Repeated_Novel||Stim_Type),                   
                                  data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
      
          mod_RT_EEG.lmer3 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                    (1 |ID) + 
                                    (1 + Repeated_Novel||Stim_Type),                   
                                  data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
      
        # Calculate ANOVA
          anova(mod_RT_EEG.lmer2,mod_RT_EEG.lmer3)</code></pre>
<pre><code>## Data: EEG_behav_RT_lmm
## Models:
## mod_RT_EEG.lmer3: log(RTs) ~ Repeated_Novel + scale(Age) + scale(WM) + (1 | ID) + 
## mod_RT_EEG.lmer3:     (1 + Repeated_Novel || Stim_Type)
## mod_RT_EEG.lmer2: log(RTs) ~ Repeated_Novel + scale(Age) + scale(WM) + (1 + Repeated_Novel || 
## mod_RT_EEG.lmer2:     ID) + (1 + Repeated_Novel || Stim_Type)
##                  Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_RT_EEG.lmer3  8 4458 4504  -2221     4442             
## mod_RT_EEG.lmer2  9 4454 4506  -2218     4436  6.17      1
##                  Pr(&gt;Chisq)  
## mod_RT_EEG.lmer3             
## mod_RT_EEG.lmer2      0.013 *
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>        # LRT without random slope Repeated_Novel for Stim_Type
          mod_RT_EEG.lmer2 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                (1 + Repeated_Novel||ID) + 
                                (1 + Repeated_Novel||Stim_Type),                   
                              data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
      
          mod_RT_EEG.lmer4 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                (1 + Repeated_Novel||ID) + 
                                (1 |Stim_Type),                   
                              data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
        # Calculate ANOVA
          anova(mod_RT_EEG.lmer2,mod_RT_EEG.lmer4)</code></pre>
<pre><code>## Data: EEG_behav_RT_lmm
## Models:
## mod_RT_EEG.lmer4: log(RTs) ~ Repeated_Novel + scale(Age) + scale(WM) + (1 + Repeated_Novel || 
## mod_RT_EEG.lmer4:     ID) + (1 | Stim_Type)
## mod_RT_EEG.lmer2: log(RTs) ~ Repeated_Novel + scale(Age) + scale(WM) + (1 + Repeated_Novel || 
## mod_RT_EEG.lmer2:     ID) + (1 + Repeated_Novel || Stim_Type)
##                  Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_RT_EEG.lmer4  8 4452 4498  -2218     4436             
## mod_RT_EEG.lmer2  9 4454 4506  -2218     4436     0      1
##                  Pr(&gt;Chisq)
## mod_RT_EEG.lmer4           
## mod_RT_EEG.lmer2          1</code></pre>
<pre class="r"><code>      # 6th: remove random slopes which did not improve the model 
          mod_RT_EEG.lmer5 = lmer(log(RTs) ~ Repeated_Novel  + scale(Age) + scale(WM) + 
                                    (1 + Repeated_Novel||ID) + 
                                    (1 |Stim_Type),                   
                                  data = EEG_behav_RT_lmm,control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
      # 7th: re-check the model PCA / variance of random factors
          summary(rePCA(mod_RT_EEG.lmer5))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]
## Standard deviation     0.106
## Proportion of Variance 1.000
## Cumulative Proportion  1.000
## 
## $ID
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.552 0.194
## Proportion of Variance 0.890 0.110
## Cumulative Proportion  0.890 1.000</code></pre>
<pre class="r"><code>          print(VarCorr(mod_RT_EEG.lmer5),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups    Name           Variance
##  Stim_Type (Intercept)    0.00405 
##  ID        Repeated_Novel 0.01365 
##  ID.1      (Intercept)    0.11064 
##  Residual                 0.36283</code></pre>
<hr />
</div>
<div id="lmm1-homoscedasticity" class="section level6">
<h6>LMM1: Homoscedasticity</h6>
<pre class="r"><code>    # 4) Check homoscedasticity (Are residuals equally distributed along regression line?)
      
      plot(fitted(mod_RT_EEG.lmer5), residuals(mod_RT_EEG.lmer5))
      abline(0, 0) </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM1_homosk-1.png" width="768" /></p>
<hr />
</div>
<div id="lmm2-normality-of-residuals" class="section level6">
<h6>LMM2: Normality of residuals</h6>
<pre class="r"><code> # LMM X: Happy face 2 trials &lt; neutral or angry face 2 trials --------
      # Build model &amp; check assumptions -----------------------------------------

      # Choose outlier-free data and correct answers          
        EEG_behav_RT_targ_lmm = subset(EEG_behav_data, Response == 1)
        EEG_behav_RT_targ_lmm = subset(EEG_behav_RT_targ_lmm,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  

      # Rename variables 
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==4] = &quot;hap&quot;
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==5] = &quot;neu&quot;
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==6] = &quot;ang&quot;
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==7] = &quot;hap&quot;
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==8] = &quot;neu&quot;
        EEG_behav_RT_targ_lmm$Target[EEG_behav_RT_targ_lmm$Target==9] = &quot;ang&quot;
        
      # Create factors, get neutral as baseline
        EEG_behav_RT_targ_lmm$Target = factor(EEG_behav_RT_targ_lmm$Target, levels=c(&quot;neu&quot;,&quot;hap&quot;,&quot;ang&quot;))
        EEG_behav_RT_targ_lmm$ID = as.factor(EEG_behav_RT_targ_lmm$ID)
        EEG_behav_RT_targ_lmm$Stim_Type = as.factor(EEG_behav_RT_targ_lmm$Stim_Type)
        
      # Create contrast for emotion
        (contrasts(EEG_behav_RT_targ_lmm$Target) = contr.treatment(3, base = 1))
    
    # 1) Check properties of DV / residuals 
        
      # Visualize normality assumption of residuals (without log transform)
        mod_RT_lmm_no_log = lm(RTs ~ Target, data=EEG_behav_RT_lmm)
        res.mod_RT_lmm_no_log = residuals(mod_RT_lmm_no_log)
        
        par(mfrow=c(1,2))
        qqpl_RT_lmm_no_log = qqPlot(res.mod_RT_lmm_no_log, main=&quot;QQplot before transformation&quot;)    
        norm_RT_lmm_no_log = plot(density(res.mod_RT_lmm_no_log), main=&quot;Density plot before transformation&quot;)  </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_res-1.png" width="768" /></p>
<pre class="r"><code>        par(mfrow=c(1,1))

      # Check which transformation of DV is suitable 
          
        # Calculate box-cox plot
          mod_resp = lm(RTs ~ Target, data=EEG_behav_RT_targ_lmm)
          boxcox(mod_resp)   </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_res-2.png" width="768" /></p>
<pre class="r"><code>        # In that case: Decision to log transform!
          
        # Visualize normality assumption of residuals (with log transform)
          mod_RT_lmm_log = lm(log(RTs) ~ Target, data=EEG_behav_RT_targ_lmm)
          res.mod_RT_lmm_log = residuals(mod_RT_lmm_log)
          
          par(mfrow=c(1,2))
          qqpl_RT_lmm_log = qqPlot(res.mod_RT_lmm_log,main=&quot;QQplot after transformation&quot;)    
          norm_RT_lmm_log = plot(density(res.mod_RT_lmm_log), main=&quot;Density plot after transformation&quot;)</code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_res-3.png" width="768" /></p>
<pre class="r"><code>          par(mfrow=c(1,1))</code></pre>
<hr />
</div>
<div id="lmm2-random-effect-structure" class="section level6">
<h6>LMM2: Random effect structure</h6>
<pre class="r"><code>    # 3) Construct full model    
    
      # Add contrast columns
        mm_c =  model.matrix( ~ Target, EEG_behav_RT_targ_lmm) 
      
      # Attach to dataframe
        EEG_behav_RT_targ_lmm[,(ncol(EEG_behav_RT_targ_lmm)+1):(ncol(EEG_behav_RT_targ_lmm)+3)] = mm_c
      
        names(EEG_behav_RT_targ_lmm)[(ncol(EEG_behav_RT_targ_lmm)-2):ncol(EEG_behav_RT_targ_lmm)] = c(&quot;Mean&quot;,&quot;Hap_Neu&quot;, &quot;Ang_Neu&quot;)    
      
      # Get model 
        mod_RT_targ.lmer1 = lmer(log(RTs) ~ 
                                Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                (1 + Hap_Neu + Ang_Neu||ID) +
                                (1 + Hap_Neu + Ang_Neu||Stim_Type),
                                data = EEG_behav_RT_targ_lmm,
                                control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
      # 1st: check how many zero variance terms you got in random effects
        summary(rePCA(mod_RT_targ.lmer1))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]  [,2]     [,3]
## Standard deviation     0.173 0.110 0.000563
## Proportion of Variance 0.712 0.288 0.000010
## Cumulative Proportion  0.712 1.000 1.000000
## 
## $ID
## Importance of components:
##                         [,1]   [,2]      [,3]
## Standard deviation     0.552 0.0566 0.0000628
## Proportion of Variance 0.990 0.0104 0.0000000
## Cumulative Proportion  0.990 1.0000 1.0000000</code></pre>
<pre class="r"><code>      # 2nd: check which random terms explain the least variance
        print(VarCorr(mod_RT_targ.lmer1),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance     
##  Stim_Type   Ang_Neu     0.00000011479
##  Stim_Type.1 Hap_Neu     0.01079300451
##  Stim_Type.2 (Intercept) 0.00437426230
##  ID          Ang_Neu     0.00115791218
##  ID.1        Hap_Neu     0.00000000142
##  ID.2        (Intercept) 0.11019319118
##  Residual                0.36163994091</code></pre>
<pre class="r"><code>      # 3rd: remove all terms with zero variance --&gt; comprises final model
        mod_RT_targ.lmer2 = lmer(log(RTs) ~ 
                                Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                                (1 |ID) +
                                (0 + Hap_Neu + Ang_Neu||Stim_Type),
                              data = EEG_behav_RT_targ_lmm,
                              control=lmerControl(calc.derivs = FALSE), REML = FALSE)
        
      # 4th: re-check the model PCA / variance of random factors
        summary(rePCA(mod_RT_targ.lmer2))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]  [,2]
## Standard deviation     0.183 0.127
## Proportion of Variance 0.673 0.327
## Cumulative Proportion  0.673 1.000
## 
## $ID
## Importance of components:
##                         [,1]
## Standard deviation     0.551
## Proportion of Variance 1.000
## Cumulative Proportion  1.000</code></pre>
<pre class="r"><code>        print(VarCorr(mod_RT_targ.lmer2),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups      Name        Variance
##  Stim_Type   Ang_Neu     0.0059  
##  Stim_Type.1 Hap_Neu     0.0121  
##  ID          (Intercept) 0.1105  
##  Residual                0.3636</code></pre>
<pre class="r"><code>     # 5th: Likelihood-ratio-testing
        mod_RT_targ.lmer2 = lmer(log(RTs) ~ 
                              Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                              (1 |ID) +
                              (0 + Hap_Neu + Ang_Neu||Stim_Type),
                            data = EEG_behav_RT_targ_lmm,
                            control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
        mod_RT_targ.lmer3 = lmer(log(RTs) ~ 
                              Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + 
                              (1 |ID) +
                              (1 |Stim_Type),
                            data = EEG_behav_RT_targ_lmm,
                            control=lmerControl(calc.derivs = FALSE), REML = FALSE)
    
      # Calculate ANOVA  
        anova(mod_RT_targ.lmer2,mod_RT_targ.lmer3)</code></pre>
<pre><code>## Data: EEG_behav_RT_targ_lmm
## Models:
## mod_RT_targ.lmer3: log(RTs) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | 
## mod_RT_targ.lmer3:     ID) + (1 | Stim_Type)
## mod_RT_targ.lmer2: log(RTs) ~ Hap_Neu + Ang_Neu + scale(Age) + scale(WM) + (1 | 
## mod_RT_targ.lmer2:     ID) + (0 + Hap_Neu + Ang_Neu || Stim_Type)
##                   Df  AIC  BIC logLik deviance Chisq Chi Df
## mod_RT_targ.lmer3  8 4452 4498  -2218     4436             
## mod_RT_targ.lmer2  9 4454 4506  -2218     4436     0      1
##                   Pr(&gt;Chisq)
## mod_RT_targ.lmer3           
## mod_RT_targ.lmer2          1</code></pre>
<pre class="r"><code>      # Re-check the model PCA / variance of random factors
        summary(rePCA(mod_RT_targ.lmer3))</code></pre>
<pre><code>## $Stim_Type
## Importance of components:
##                         [,1]
## Standard deviation     0.115
## Proportion of Variance 1.000
## Cumulative Proportion  1.000
## 
## $ID
## Importance of components:
##                        [,1]
## Standard deviation     0.55
## Proportion of Variance 1.00
## Cumulative Proportion  1.00</code></pre>
<pre class="r"><code>        print(VarCorr(mod_RT_targ.lmer3),comp = &quot;Variance&quot;)</code></pre>
<pre><code>##  Groups    Name        Variance
##  Stim_Type (Intercept) 0.00479 
##  ID        (Intercept) 0.11052 
##  Residual              0.36484</code></pre>
<hr />
</div>
<div id="lmm2-homoscedasticity" class="section level6">
<h6>LMM2: Homoscedasticity</h6>
<pre class="r"><code>   # 4) Check homoscedasticity (equal disttribution of residulas along regression line)
        plot(fitted(mod_RT_targ.lmer2), residuals(mod_RT_targ.lmer3))
        abline(0, 0)    </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_LMM2_homosk-1.png" width="768" /></p>
<hr />
</div>
</div>
</div>
<div id="section-1" class="section level4">
<h4></h4>
<!-- RT result text -->
<p>We tested whether children detected a match of two identical emotions at “face 2” faster than a mismatch. We only used correct answers within this model. We built an LMM with novelty as fixed effect factor and chronological age and working memory as covariates. The best fitted model included a random intercept for participant and random slope for novelty with no random intercept for stimulus. Contrary to our hypothesis, we did not find a significant main effect of novelty (<span class="math inline">\(\hat{β}\)</span> = 0.04, <em>p</em> = 0.29). Children seemed to be equally fast in detecting novel and repeated facial expression. None of the covariates reached significance (age: <span class="math inline">\(\hat{β}\)</span> = -0.05, <em>p</em> = 0.46; working memory: <span class="math inline">\(\hat{β}\)</span> = 0.09, <em>p</em> = 0.18; see <strong>Figure X A</strong> and <strong>Table XX</strong>).</p>
<pre class="r"><code># PLOT 1

  # Choose outlier-free and correct trial data
        EEG_behav_RT_plot = subset(EEG_behav_data,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
        EEG_behav_RT_plot = subset(EEG_behav_RT_plot, Response == 1)
      
      # Rename values for repeated and novel trials 
        EEG_behav_RT_plot$Cong[EEG_behav_RT_plot$Cong==1] = &quot;repeated&quot;
        EEG_behav_RT_plot$Cong[EEG_behav_RT_plot$Cong==2] = &quot;novel&quot;
      
      # Draw violin plot
       EEG_RT_plot = ggplot(EEG_behav_RT_plot, aes(y = RTs, x = Cong, color = Cong, fill = Cong)) + 
          geom_violin(trim=FALSE, lwd = 0.5,adjust=1.5) +
          geom_boxplot(width=0.13, lwd = 1, fill=&#39;white&#39;) +
          theme_minimal() +
          scale_color_manual(values=c(&quot;gray32&quot;,&quot;#276CB3&quot;))+
          scale_fill_manual(values=c(&quot;gray87&quot;, &quot;#6AC2FF&quot;))+
          theme(legend.position=&quot;none&quot;)+
          xlab(&quot;&quot;)+
          ylab(&quot;Reaction time [ms]&quot;)+
          theme(axis.title.y = element_text(margin = margin(t = 0, r = 20, b = 0, l = 0)),
                text=element_text(family = &quot;Arial&quot;, size = 20))
       
# PLOT 2
       
        # Choose outlier-free and correct trial data
        EEG_behav_RT_targ_plot = subset(EEG_behav_data,Exclude_smaller_250ms == FALSE &amp; Exclude_larger_7s == FALSE &amp; Exclude_MAD == FALSE)  
        EEG_behav_RT_targ_plot = subset(EEG_behav_RT_targ_plot, Response == 1)        
            
      # Choose EEG task data with correct trials           
        EEG_behav_RT_targ_plot = subset(EEG_behav_RT_targ_plot, Response == 1)
              
      # Rename variables 
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==4] = &quot;happy&quot;
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==5] = &quot;neutral&quot;
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==6] = &quot;angry&quot;
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==7] = &quot;happy&quot;
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==8] = &quot;neutral&quot;
        EEG_behav_RT_targ_plot$Target[EEG_behav_RT_targ_plot$Target==9] = &quot;angry&quot;
        
      # Set target as factor / Recode target
        EEG_behav_RT_targ_plot$Target = factor(EEG_behav_RT_targ_plot$Target, levels=c(&quot;neutral&quot;,&quot;happy&quot;,&quot;angry&quot;))
        
      # Subset happy        
        EEG_behav_RT_targ_plot_hap = subset(EEG_behav_RT_targ_plot, Target == &quot;happy&quot;)
       
      # Subset neutral  
        EEG_behav_RT_targ_plot_neu = subset(EEG_behav_RT_targ_plot, Target == &quot;neutral&quot;)
        
      # Subset angry 
        EEG_behav_RT_targ_plot_ang = subset(EEG_behav_RT_targ_plot, Target == &quot;angry&quot;)
        
      # Get mean reaction time for novel and repeated condition
        RT_hap = data.frame(tapply(EEG_behav_RT_targ_plot_hap$RT,EEG_behav_RT_targ_plot_hap$ID,mean))
        RT_hap$emo = &quot;happy&quot;
        names(RT_hap)[1] = &quot;RT&quot;
        
        RT_ang = data.frame(tapply(EEG_behav_RT_targ_plot_ang$RT,EEG_behav_RT_targ_plot_ang$ID,mean))
        RT_ang$emo = &quot;angry&quot;
        names(RT_ang)[1] = &quot;RT&quot;
        
        RT_neu = data.frame(tapply(EEG_behav_RT_targ_plot_neu$RT,EEG_behav_RT_targ_plot_neu$ID,mean))
        RT_neu$emo = &quot;neutral&quot;
        names(RT_neu)[1] = &quot;RT&quot;

      # Combine dataframes
        RT_emo = rbind(RT_hap, RT_neu, RT_ang)

      # Factor condition
        RT_emo$emo = as.factor(RT_emo$emo)
        
      # Calculate descriptives on accuracy
        stats_RT_emo = summarySE(RT_emo, measurevar=&quot;RT&quot;, groupvars=c(&quot;emo&quot;))
        
      # Plot accuracy
        EEG_RT_emo_plot = ggplot(stats_RT_emo, aes(x=emo, y=RT, fill = emo)) + 
          geom_bar(position=position_dodge(), stat=&quot;identity&quot;, colour=&quot;black&quot;, size=1,width=0.9) +
          geom_errorbar(aes(ymin=RT-se, ymax=RT+se), size=1, width=0.2, position=position_dodge(.9)) +
          labs (x= &quot;&quot;, y = &quot;Reaction time [ms]&quot;)+
          scale_fill_manual(values= c(&quot;#FF5B4F&quot;,&quot;gray20&quot;,&quot;#276CB3&quot;))+
          theme_minimal()+
          theme(axis.title.y = element_text(size = 20, margin = margin(t = 0, r = 20, b = 0, l = 0)),
                text=element_text(size = 20, family = &quot;Arial&quot;),
                legend.position = &quot;none&quot;)
        
        
# Combine plots
      combine_plots(EEG_RT_plot, EEG_RT_emo_plot,
                               ncol = 2, nrow=1,
                               labels = c(&quot;A&quot;, &quot;B&quot;),
                               caption.color = &quot;black&quot;,
                               caption.vjust = 0,
                               caption.hjust = 1.3,
                               caption.text = &quot;Figure XX: RT results of EEG task&quot;)        </code></pre>
<p><img src="R_Script_2_EEG_task_measures_files/figure-html/EEG_RT_plots-1.png" width="768" /></p>
<p><br></p>
<p>We built an additional LMM to identify potential matching differences for different emotions for “face 2” (contrast: happy vs neutral, angry vs neutral). The model with the best fit included random intercepts for participant and stimulus. Trials in which the emotion happy was presented as “face 2” were significantly detected faster compared to neutral faces (<span class="math inline">\(\hat{β}\)</span> = -0.08, <em>p</em> &lt;0.01; see <strong>Figure X B</strong>). No difference between angry and neutral as “face 2” could be found (<span class="math inline">\(\hat{β}\)</span> = -0.03, <em>p</em> = 0.36). None of the covariates reached significance (age: <span class="math inline">\(\hat{β}\)</span> = -0.05, <em>p</em> = 0.46; working memory: <span class="math inline">\(\hat{β}\)</span> = 0.09, <em>p</em> = 0.17).</p>
<pre class="r"><code>       # Create table
          tab_model(mod_RT_EEG.lmer5, mod_RT_targ.lmer3,
                    pred.labels=labels,
                    show.se=TRUE, show.stat=TRUE, show.ci = FALSE, string.se = &quot;SE&quot;,
                    show.re.var=FALSE, show.obs=FALSE,
                    emph.p = TRUE, dv.labels=c(&quot;Reaction time&quot;,&quot;&quot;) , show.icc = FALSE)</code></pre>
<table style="border-collapse:collapse; border:none;">
<tr>
<th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; ">
 
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
Reaction time
</th>
<th colspan="4" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; ">
</th>
</tr>
<tr>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; ">
Predictors
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
p
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  ">
Estimates
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col7">
SE
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col8">
Statistic
</td>
<td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  col9">
p
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Intercept
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
6.97
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
107.62
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
<strong>&lt;0.001
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
7.01
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
104.25
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>&lt;0.001
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Novel vs Repeated
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.04
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.284
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Age
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.452
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.05
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.07
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.76
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.450
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Working memory
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
1.38
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.169
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
0.09
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.06
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
1.39
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.164
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Happy
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.08
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-2.75
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
<strong>0.006</strong>
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; ">
Neutral vs Angry
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  ">
-0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col7">
0.03
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col8">
-0.91
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  col9">
0.363
</td>
</tr>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
N
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
28 <sub>ID</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;">
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="4">
72 <sub>Stim_Type</sub>
</td>
<tr>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;">
Marginal R<sup>2</sup> / Conditional R<sup>2</sup>
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.022 / 0.041
</td>
<td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="4">
0.019 / 0.254
</td>
</tr>
</table>
<p><br></p>
<p><em>Table XX: Results of LMMs for reaction times of the EEG task</em></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3,h4",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
